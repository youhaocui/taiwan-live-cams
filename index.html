<!DOCTYPE html>
<html lang="zh-TW" id="htmlLang">
<head>
  <meta charset="utf-8" />
  <title id="pageTitle">å°ç£å³æ™‚ç›´æ’­å¤šåˆ†å‰²ç›£çœ‹</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* ---------------------------------------------------------------------- */
    /* CSS æ¨£å¼ (ä¿æŒä¸è®Š) */
    /* ---------------------------------------------------------------------- */
    html,body{
      height:100%;
      margin:0; padding:0; background:#000;
      font-family: system-ui, sans-serif; color:#fff; overflow:hidden;
    }

    /* åº•éƒ¨æ§åˆ¶åˆ— */
    .controls{
      position:fixed;
      bottom:0; left:0; width:100%; height:78px;
      background:rgba(12,12,12,0.95); color:#fff; padding:8px 12px;
      box-sizing:border-box; display:flex; flex-direction:row; align-items:center;
      gap:10px; z-index:3000; overflow:hidden;
    }
    .controls button{
      background-color:#222; color:#fff; border:1px solid #444;
      padding:8px 12px; font-size:13px; cursor:pointer;
      border-radius:6px;
      height:40px; flex-shrink:0; white-space:nowrap; text-align:center;
    }
    .controls button.active{ background-color:#0078d7; border-color:#0078d7; }
    .divider{ width:1px; height:60%;
      background:#333; flex-shrink:0; margin:0;
    }

    /* ç¸£å¸‚ / æ™¯é»å®¹å™¨ï¼ˆå¯å·¦å³æ»¾å‹•ï¼‰ */
    #regionButtons{
      display:flex;
      flex-grow:1; min-width:0; gap:6px;
      overflow-x:auto; padding-bottom:6px; height:100%; align-items:center;
    }
    #regionButtons::-webkit-scrollbar{ height:6px; background-color:rgba(255,255,255,0.06); }
    #regionButtons::-webkit-scrollbar-thumb{ background-color:#444;
      border-radius:3px;
    }
    .region-label{ color:#fff; margin:0 8px 0 4px; font-weight:600; flex-shrink:0; user-select:none;
    }
    /* é€šç”¨åŸå¸‚/æ™¯é»æŒ‰éˆ•æ¨£å¼ */
    #regionButtons .city-btn, #regionButtons .stream-btn, #regionButtons .back-btn{
      background-color:#111;
      color:#fff; border:1px solid #555;
      padding:6px 10px; margin:0;
      border-radius:6px; cursor:pointer;
      height:36px; flex-shrink:0; font-size:13px;
    }
    #regionButtons .city-btn:hover, #regionButtons .stream-btn:hover, #regionButtons .back-btn:hover{
        background-color:#1a1a1a; border-color:#666;
    }
    /* æ™¯é»æŒ‰éˆ•å¾®èª¿æ¨£å¼ */
    #regionButtons .stream-btn{
        background-color: #222;
        border-color: #444;
    }
    /* è¿”å›æŒ‰éˆ•æ¨£å¼ + é»åœ¨å·¦å´å›ºå®š */
    #regionButtons .back-btn{
        background-color: #555;
        border-color: #777;
        position: sticky;
        left: 0;
        z-index: 2;
    }
    /* ç•¶å‰é¸ä¸­çš„åŸå¸‚æŒ‰éˆ•ï¼Œç”¨æ–¼åŸå¸‚/æ™¯é»åˆ‡æ›ç‹€æ…‹æ¨™è¨˜ */
    #regionButtons .city-btn.active-city{
        background-color: #0078d7;
        border-color: #0078d7;
    }


    /* å½±ç‰‡èˆå°å››æ ¼ */
    .stage-wrap{
      position:fixed; top:0;
      left:0; width:100vw;
      height:calc(100vh - 78px);
      display:grid; 
      gap:0; z-index:1;
    }
    
    /* é è¨­ 2x2 ä½ˆå±€æ¨£å¼ */
    .stage-wrap.grid-2x2{
      grid-template-columns:1fr 1fr;
      grid-template-rows:1fr 1fr;
    }
    /* 1x1 ä½ˆå±€æ¨£å¼ */
    .stage-wrap.grid-1x1{
      grid-template-columns:1fr;
      grid-template-rows:1fr;
    }
    /* 3x3 ä½ˆå±€æ¨£å¼ */
    .stage-wrap.grid-3x3{
      grid-template-columns:repeat(3, 1fr);
      grid-template-rows:repeat(3, 1fr);
    }
    
    .cell{ position:relative; width:100%; height:100%;
      overflow:hidden; background:#000;
    }
    
    /* æ’­æ”¾å™¨å®¹å™¨åŠ iframe - é‡æ–°å¥—ç”¨ç¸®æ”¾ä»¥ä½¿ 16:9 ç•«é¢å¡«æ»¿è±¡é™ä¸¦éš±è—æ¨™é¡Œ */
    .player-container, .player-container iframe{
      position:absolute;
      inset:0; width:100%; height:100%; border:0; display:block;
      object-fit:cover; object-position:center;
      background:black;
      /* é è¨­ 2x2 ç¸®æ”¾ */
      transform: scale(1.65) translateY(-6%);
    }
    
    /* é‡å°ä¸åŒç¶²æ ¼å¤§å°èª¿æ•´ç¸®æ”¾ä»¥ä¿æŒç•«é¢å¡«æ»¿ä¸”éš±è—æ¨™é¡Œ */
    .stage-wrap.grid-1x1 .player-container, .stage-wrap.grid-1x1 .player-container iframe{
        transform: scale(1.05) translateY(-2%);
        /* 1x1 ç•¥å¾®æ”¾å¤§ */
    }
    .stage-wrap.grid-3x3 .player-container, .stage-wrap.grid-3x3 .player-container iframe{
        transform: scale(2.4) translateY(-8%);
        /* 3x3 æ›´å¤§æ”¾å¤§ */
    }


    /* å¼·åŒ–é®ç½©ä»¥é˜»æ“‹ YouTube UI/Logo/æ¨è–¦ */
    .interaction-shield{
      position:absolute;
      inset:0; z-index:9999; background:transparent;
      pointer-events:auto; cursor:default;
    }
    .label{
      position:absolute; left:8px; right:8px; bottom:8px; display:flex;
      flex-direction:column; align-items:flex-start; padding:6px 8px;
      font-size:14px; color:#fff; background:rgba(0,0,0,0.6); border-radius:6px;
      pointer-events:none; z-index:10000;
    }
    .source-on-screen{ font-size:11px; color:#ccc; margin-top:4px; line-height:1.1;
    }

    /* é¡¯ç¤ºæ§åˆ¶ */
    .hide-labels .label{ display:none;
    }
    .fullscreen-active .controls{ display:none;
    }
    .fullscreen-active .stage-wrap{ height:100vh; }

    /* ç•«é¢é¸æ“‡æŒ‰éˆ•æ§åˆ¶ */
    .hide-cam-select #camSelectButtons {
        display: none;
    }
    
    @media (max-width:640px){
      .controls{ padding:6px 8px;
        height:80px;
      }
      .controls button{ padding:6px 8px; font-size:12px; height:36px;
      }
      #regionButtons .city-btn, #regionButtons .stream-btn, #regionButtons .back-btn{
        padding:6px 8px;
        font-size:12px; height:34px;
      }
    }
    
    /* ---------------------------------------------------------------------- */
    /* CSS æ¨£å¼ï¼šéŸ³æ¨‚æ§åˆ¶å€å¡Š (ä¿æŒä¸è®Š) */
    /* ---------------------------------------------------------------------- */

    .music-controls-container {
        display: none;
        flex-shrink: 0;
        height: 100%;
        align-items: center;
    }
    .music-controls {
        display: flex;
        gap: 5px;
    }
    .music-controls button {
        background-color: #222;
        color: #fff;
        border: 1px solid #444;
        border-radius: 6px;
        cursor: pointer;
        height: 40px; 
        width: 40px;
        padding: 0;
        font-size: 16px;
        line-height: 1;
        flex-shrink: 0;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    /* å½ˆçª—å…§æ»¾å‹•æ¨£å¼ */
    .modal-list { max-height: 320px;
      overflow-y: auto; padding-right: 6px; }
    .queue-item { display:flex; align-items:center; gap:8px; padding:6px 4px; border-radius:4px;
    }
    .queue-item .title { flex:1; font-size:13px; color:#fff; word-break:break-word; }
    .queue-item .meta { font-size:12px; color:#888;
      margin-left:8px; }
    
    /* å½ˆçª—é€šç”¨æ¨£å¼ */
    .modal-backdrop{
        display:none;
        position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999;
        justify-content:center; align-items:center;
    }
    .modal-content{
        background:#222; padding:20px;
        border-radius:10px; box-shadow:0 0 20px rgba(0,0,0,0.5); 
        width:350px; max-width:90%;
    }
    .modal-content h3{
        margin-top:0;
        color:#fff; text-align:center;
    }
    .modal-content button.close-btn{
        background-color:#444; border:1px solid #666; color:#fff;
        margin-top:15px;
        padding:8px 12px; border-radius:6px; cursor:pointer;
    }
    .modal-content button.mode-btn, .modal-content button.grid-btn, .modal-content button.lang-btn{
        background-color:#0078d7;
        border:1px solid #0078d7; color:#fff;
        padding:10px 15px; border-radius:6px; cursor:pointer; flex:1;
        font-size: 13px;
    }
    .modal-content button.mode-btn.active, .modal-content button.grid-btn.active, .modal-content button.lang-btn.active {
        background-color: #0056a3;
        border-color: #0056a3;
    }
    .modal-content button.stop-btn{
        background-color:#d70000; border:1px solid #d70000; color:#fff;
        margin-top:20px;
        padding:10px 15px; border-radius:6px; cursor:pointer; width:100%;
    }
    
  </style>
</head>
<body class="hide-cam-select" id="pageBody">
  <div class="controls" id="controls">
    <div id="camSelectButtons">
      <button id="select-cam-0" class="active" onclick="selectCam(0)">å·¦ä¸Š</button>
      <button id="select-cam-1" onclick="selectCam(1)">å³ä¸Š</button>
      <button id="select-cam-2" onclick="selectCam(2)">å·¦ä¸‹</button>
      <button id="select-cam-3" onclick="selectCam(3)">å³ä¸‹</button>
    </div>

    <div class="divider"></div>

    <div id="regionButtons" aria-label="ç¸£å¸‚èˆ‡æ™¯é»é¸å–®" role="toolbar"></div>

    <div class="divider"></div>
    <button id="fullscreenBtn" onclick="toggleFullscreen()">å…¨è¢å¹•</button>

    <div class="divider"></div>
    <button id="settingsBtn" onclick="openMainSettingsModal()" title="ç•«é¢åˆ†å‰²ã€èªè¨€èˆ‡æ¨™ç±¤è¨­å®š">âš™ï¸ è¨­å®š</button>

    <div class="divider"></div>
    <button id="muteBtn" onclick="toggleMute()">è§£é™¤éœéŸ³</button>

    <div class="divider"></div>
    <button id="requestBtn" onclick="requestSong()" title="è¼¸å…¥ç¶²å€/IDé»æ­Œæˆ–æ’­æ”¾æ¸…å–®">ğŸ¶ é»æ­Œ/æ¸…å–®</button>

    <div id="musicControlsContainer" class="music-controls-container">
      <div class="music-controls">
        <button id="prevSongBtn" onclick="skipToPreviousSong()" title="ä¸Šä¸€é¦–">â®ï¸</button>
        <button id="playPauseBtn" onclick="playPauseSong()" title="æ’­æ”¾/æš«åœ">â¸ï¸</button>
        <button id="nextSongBtn" onclick="skipToNextSong()" title="ä¸‹ä¸€é¦–">â­ï¸</button>
        <button id="modeBtn" onclick="openMusicSettingsModal()" title="æ¨¡å¼è¨­å®š">ğŸ”„</button>
        <button id="playlistQueueBtn" onclick="showMusicQueueStatusModal()" title="æŸ¥çœ‹æ’­æ”¾åˆ—è¡¨ç‹€æ…‹">ğŸµ</button>
      </div>
    </div>
  </div>

  <div class="stage-wrap grid-2x2" id="stageWrap">
    <div class="cell" data-index="0">
      <div id="player0" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label0">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="1">
      <div id="player1" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label1">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="2">
      <div id="player2" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label2">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="3">
      <div id="player3" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label3">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="4" style="display:none;">
      <div id="player4" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label4">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="5" style="display:none;">
      <div id="player5" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label5">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="6" style="display:none;">
      <div id="player6" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label6">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="7" style="display:none;">
      <div id="player7" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label7">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="8" style="display:none;">
      <div id="player8" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label8">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
  </div>
    
  <script>
    // ç¢ºä¿æ‰€æœ‰ 9 å€‹ player ID å’Œ label ID éƒ½å­˜åœ¨æ–¼é™£åˆ—ä¸­
    const PLAYER_IDS = ['player0', 'player1', 'player2', 'player3', 'player4', 'player5', 'player6', 'player7', 'player8'];
    const LABEL_IDS = ['label0', 'label1', 'label2', 'label3', 'label4', 'label5', 'label6', 'label7', 'label8'];
    const CELLS = document.querySelectorAll('.stage-wrap .cell');
  </script>


  <div id="player_music_container" style="position:fixed;
    top:-100px; left:-100px; width:1px; height:1px;
    overflow:hidden;">
    <div id="player_music"></div>
  </div>

  <div id="mainSettingsModal" class="modal-backdrop">
    <div class="modal-content" style="width:400px; max-width:90%;">
        <h3 id="settingsTitle">âš™ï¸ ç¨‹å¼è¨­å®š</h3>
        
        <div style="margin-top:20px; padding:10px; border:1px solid #444; border-radius:6px;">
            <p id="gridSizeLabel" style="color:#fff; font-weight:bold; margin:0 0 10px;">ç•«é¢åˆ†å‰²æ¨¡å¼ï¼š</p>
            <div style="display:flex; justify-content:space-around; gap:10px;">
                <button id="grid1x1Btn" class="grid-btn" onclick="setGridSize('1x1')">1x1 (å–®ç•«é¢)</button>
                <button id="grid2x2Btn" class="grid-btn active" onclick="setGridSize('2x2')">2x2 (å››åˆ†å‰²)</button>
                <button id="grid3x3Btn" class="grid-btn" onclick="setGridSize('3x3')">3x3 (ä¹åˆ†å‰²)</button>
            </div>
            <p style="font-size:12px;
              color:#888; margin:10px 0 0;" id="gridSizeHint">æ›´æ”¹åˆ†å‰²æ¨¡å¼å°‡é‡è¨­æ‰€æœ‰ç•«é¢ã€‚</p>
        </div>

        <div style="margin-top:20px;
          padding:10px; border:1px solid #444; border-radius:6px;">
            <p id="languageLabel" style="color:#fff; font-weight:bold;
              margin:0 0 10px;">èªè¨€é¸æ“‡ï¼š</p>
            <div style="display:flex; justify-content:space-around;
              gap:10px;">
                <button id="langZhTwBtn" class="lang-btn" onclick="setLanguage('zh-TW')">æ­£é«”ä¸­æ–‡</button>
                <button id="langEnUsBtn" class="lang-btn" onclick="setLanguage('en-US')">English</button>
            </div>
        </div>

        <div style="margin-top:20px;
          padding:10px; border:1px solid #444; border-radius:6px; display:flex; justify-content:space-between; align-items:center;">
            <p id="labelsToggleLabel" style="color:#fff;
              font-weight:bold; margin:0;">ç•«é¢æ¨™ç±¤é¡¯ç¤ºï¼š</p>
            <button id="labelsToggleInModalBtn" onclick="toggleLabels()">æ¨™ç±¤éš±è—</button>
        </div>

        <button onclick="closeMainSettingsModal()" class="close-btn" style="width:100%;">é—œé–‰è¨­å®š</button>
    </div>
  </div>


  <div id="musicSettingsModal" class="modal-backdrop">
    <div class="modal-content" style="width:300px;
      max-width:90%;
      text-align:center;">
      <h3 id="musicModeTitle" style="margin-top:0; color:#fff;">éŸ³æ¨‚æ’­æ”¾æ¨¡å¼</h3>
      <p id="musicModeHint" style="font-size:12px;
        color:#aaa;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æ’­æ”¾æ¨¡å¼ï¼š</p>
      <div style="display:flex; justify-content:space-around; gap:10px;
        margin-top:15px;">
        <button id="modeListLoop" class="mode-btn" onclick="setPlaybackMode('listLoop')">ğŸ”„ åˆ—è¡¨å¾ªç’°</button>
        <button id="modeShuffle" class="mode-btn" onclick="setPlaybackMode('shuffle')">ğŸ”€ éš¨æ©Ÿæ’­æ”¾</button>
      </div>
      <button id="modeStopBtn" onclick="stopAndCloseModal()" class="stop-btn">â¹ï¸ åœæ­¢ä¸¦çµæŸæ’­æ”¾</button>
      <button id="musicModeCloseBtn" onclick="closeMusicSettingsModal()" class="close-btn">é—œé–‰</button>
    </div>
  </div>

  <div id="musicQueueModal" class="modal-backdrop">
    <div class="modal-content" style="width:350px;
      max-width:90%;">
      <h3 id="queueTitle" style="margin-top:0; color:#fff; text-align:center;">ğŸ¶ æ’­æ”¾åˆ—è¡¨ç‹€æ…‹</h3>
      <div id="queueListContent" style="margin-bottom:15px;
        padding-right:5px;"></div>
      <button id="queueCloseBtn" onclick="closeMusicQueueModal()" style="margin-top:10px;">é—œé–‰</button>
    </div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    /* ===== ç›´æ’­ä¾†æº (ä¿æŒä¸è®Š) ===== */
    const ALL_STREAMS = {
      "å°åŒ—-è±¡å±±çœ‹101": {"id":"z_fY1pj1VBw","label":"å°åŒ—è±¡å±±","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-å¤§ç¨»åŸ•": {"id":"Ndo_8RuefH4","label":"å¤§ç¨»åŸ•","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-ç¢§å±±å·–": {"id":"uvwfYzwY8tg","label":"ç¢§å±±å·–","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-å¾®é¢¨å¹³å°": {"id":"34h_Cy_n0Ok","label":"å¾®é¢¨å¹³å°","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-è²“ç©ºæŒ‡å—å®®": {"id":"215ahZ_0rTg","label":"è²“ç©ºæŒ‡å—å®®","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-æ“å¤©å²¡è‰åŸ": {"id":"yF2LAyOvq0Q","label":"æ“å¤©å²¡è‰åŸ","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-é™½æ˜æ›¸å±‹": {"id":"RttyIGHbN_w","label":"é™½æ˜æ›¸å±‹","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-é çœºä¸ƒæ˜Ÿå±±": {"id":"PvJr2efA6n0","label":"é çœºä¸ƒæ˜Ÿå±±","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-äºŒåªå­åœè»Šå ´": {"id":"d9KuXrPCWYU","label":"äºŒåªå­åœè»Šå ´","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-å¤§å±¯è‡ªç„¶å…¬åœ’": {"id":"6ghffcNt3Nw","label":"å¤§å±¯è‡ªç„¶å…¬åœ’","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-å°æ²¹å‘åœè»Šå ´": {"id":"kKD-ZBLs8-4","label":"å°æ²¹å‘åœè»Šå ´","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-å†·æ°´å‘åœè»Šå ´": {"id":"GB64WeZZQPQ","label":"å†·æ°´å‘åœè»Šå ´","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "æ–°åŒ—-æ¼äººç¢¼é ­": {"id":"xwAWSh35uuw","label":"æ–°åŒ—æ·¡æ°´","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-é¼»é ­æœå‹™å€": {"id":"4Bm3IKcGkQY","label":"æ–°åŒ—é¼»é ­","source":"necoast nsa"},
      "æ–°åŒ—-ä¸­è§’ç£": {"id":"mmM9NOZLLKY","label":"ä¸­è§’ç£","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "æ–°åŒ—-ååˆ†ç€‘å¸ƒå…¬åœ’": {"id":"HirBQsQEUeA","label":"ååˆ†ç€‘å¸ƒå…¬åœ’","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-ä¹ä»½": {"id":"XSD5ptYisw8","label":"æ–°åŒ—ä¹ä»½","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-å…§æ´åœ‹å®¶æ£®æ—éŠæ¨‚å€": {"id":"lX2MYEFomK0","label":"å…§æ´åœ‹å®¶æ£®æ—éŠæ¨‚å€","source":"åœ‹å®¶æ£®æ—éŠæ¨‚å€å³æ™‚å½±åƒ"},
      "æ–°åŒ—-ä¸‰å³½è€è¡—åŒ—æ®µ": {"id":"M24SZJU-uoo","label":"ä¸‰å³½è€è¡—åŒ—æ®µ","source":"ä¸‰å³½æ°‘æ¬Šè€è¡—å•†åœˆ"},
      "æ–°åŒ—-ä¸‰å³½è€è¡—å—æ®µ": {"id":"R_5jhoux3nY","label":"ä¸‰å³½è€è¡—å—æ®µ","source":"ä¸‰å³½æ°‘æ¬Šè€è¡—å•†åœˆ"},
      "æ–°åŒ—-çƒä¾†åŠæ©‹": {"id":"jGoYvmTxLyU","label":"çƒä¾†åŠæ©‹","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "æ–°åŒ—-å“¡å±±å­": {"id":"JkGKqXOt9Ls","label":"å“¡å±±å­","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "æ–°åŒ—-æ–‡å±±è¾²å ´å¤§è‰çš®": {"id":"_LRkfObNP_U","label":"æ–‡å±±è¾²å ´å¤§è‰çš®","source":"æ–°åŒ—å¸‚è¾²æœƒæ–‡å±±è¾²å ´"},
      "åŸºéš†-å¤–æœ¨å±±": {"id":"LInNQYAbAwQ","label":"å¤–æœ¨å±±","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "æ–°ç«¹-æˆåŠŸæ¹–": {"id":"Y6xJKj8k2ys","label":"æˆåŠŸæ¹–","source":"åœ‹ç«‹æ¸…è¯å¤§å­¸è¨ˆé€šä¸­å¿ƒå­¸ç§‘çµ„"},
      "æ–°ç«¹-å¤§è‰åª": {"id":"x_FuMf2ke1o","label":"å¤§è‰åª","source":"åœ‹ç«‹æ¸…è¯å¤§å­¸è¨ˆé€šä¸­å¿ƒå­¸ç§‘çµ„"},
      "æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´": {"id":"91PfFoqvuUk","label":"æ¡ƒåœ’æ©Ÿå ´","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´å—è·‘é“": {"id":"y3_x8el5ZJY","label":"TPE å—è·‘é“","source":"Taoyuan Airport"},
      "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´åŒ—è·‘é“": {"id":"wWEnxWA7nnY","label":"TPE åŒ—è·‘é“","source":"Taoyuan Airport"},
      "æ¡ƒåœ’-æ°¸å®‰æ¼æ¸¯": {"id":"tD_a03trUvE","label":"æ°¸å®‰æ¼æ¸¯","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ": {"id":"YkIUZjVlhv4","label":"æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è™é ­å±±ç’°ä¿å…¬åœ’": {"id":"tu_gsIkNt-w","label":"è™é ­å±±ç’°ä¿å…¬åœ’","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å°çƒä¾†å¤©ç©ºæ­¥é“": {"id":"neaiCec1kec","label":"å°çƒä¾†å¤©ç©ºæ­¥é“","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±æ€è¦ªäº­": {"id":"3Za9y4z_Lzc","label":"è§’æ¿å±±æ€è¦ªäº­","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°": {"id":"5YDXZ1aiR5Y","label":"ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å¤§æºªæ©‹": {"id":"oFJ6gCaBb_Q","label":"å¤§æºªæ©‹","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è™é ­å±±å¥§çˆ¾æ£®æ—å­¸å ‚": {"id":"yQSmajHyMhU","label":"å¥§çˆ¾æ£®æ—å­¸å ‚","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±æ¢…åœ’": {"id":"-xT1bZhWLuU","label":"è§’æ¿å±±æ¢…åœ’","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±ç”Ÿæ…‹æ± ": {"id":"XEbo8NzMTbQ","label":"è§’æ¿å±±ç”Ÿæ…‹æ± ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å¤§æºªè€è¡—": {"id":"XUWjAsajKXg","label":"å¤§æºªè€è¡—","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-çŸ³é–€æ°´åº«": {"id":"GUCaVR88ZFU","label":"çŸ³é–€æ°´åº«","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ…ˆæ¹–æ°´å²¸å»£å ´": {"id":"pSQ0e-ZTZ5g","label":"æ…ˆæ¹–æ°´å²¸å»£å ´","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-é˜¿å§†åªè–‘æ¯å³¶": {"id":"EUOp2LchPQM","label":"è–‘æ¯å³¶","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-ä¸Šå·´é™µ": {"id":"nV-DKquUjFs","label":"ä¸Šå·´é™µ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ¡ƒåœ’åœ‹éš›æ©Ÿå ´å‡±æ‚…é…’åº—": {"id":"68GFgzQxrXs","label":"æ©Ÿå ´å‡±æ‚…","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å°çƒä¾†å¯°å®‡å¹³å°": {"id":"PJWye36lEj4","label":"å¯°å®‡å¹³å°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è¨±åæ¸¯æ¿•åœ°": {"id":"44JArbF682k","label":"è¨±åæ¸¯æ¿•åœ°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "å®œè˜­-å¤–æ¾³æ²™ç˜": {"id":"UgoT-QTbYvo","label":"å®œè˜­å¤–æ¾³","source":"necoast nsa"},
      "å®œè˜­-ç¦éš†æµ·æ°´æµ´å ´": {"id":"mMG7v_fET5A","label":"å®œè˜­ç¦éš†","source":"necoast nsa"}, 
      "å®œè˜­-çŸ³åŸæ¼æ¸¯": {"id":"X76Dkt_fPG0","label":"çŸ³åŸæ¼æ¸¯","source":"necoast nsa"}, 
      "å®œè˜­-ç„¡å°¾æ¸¯": {"id":"Bux0vT_5MBw","label":"ç„¡å°¾æ¸¯","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
      "å®œè˜­-çŸ³åŸæ¼æ¸¯": {"id":"ozZVLl0h--A","label":"çŸ³åŸæ¼æ¸¯1","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
      "å®œè˜­-ç¤æºªå¯’æ²é…’åº—": {"id":"cPh2vzrtG_w","label":"ç¤æºªå¯’æ²é…’åº—","source":"ç¤æºªå¯’æ²é…’åº—MU JIAO XI HOTEL"}, 
      "è‹—æ —-æ±¶æ°´éŠå®¢ä¸­å¿ƒ(é›ªéœ¸)": {"id":"VgmWVBUsfGo","label":"æ±¶æ°´éŠå®¢ä¸­å¿ƒ","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "è‹—æ —-è§€éœ§éŠæ†©å€(é›ªéœ¸)": {"id":"Isp6RQiuxNo","label":"è§€éœ§éŠæ†©å€","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "è‹—æ —-é›ªè¦‹éŠæ†©å€(é›ªéœ¸)": {"id":"2KDE860OW_A","label":"é›ªè¦‹éŠæ†©å€","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "å°ä¸­-é«˜ç¾æ¿•åœ°": {"id":"fjhg3gAnMFg","label":"å°ä¸­é«˜ç¾","source":"å¤§ç©å°ä¸­-è‡ºä¸­è§€å…‰æ—…éŠå±€"},
      "å°ä¸­-æœ›é«˜å¯®": {"id":"lhXXhDyjFtI","label":"æœ›é«˜å¯®","source":"å¤§ç©å°ä¸­-è‡ºä¸­è§€å…‰æ—…éŠå±€"},
      "å½°åŒ–-ç‹åŠŸæ¼æ¸¯": {"id":"hUG2XK08W5Q","label":"å½°åŒ–ç‹åŠŸ","source":"æ„›ç©å½°åŒ– Changhua Travels"},
      "å—æŠ•-åˆæ­¡å±±æ­¦å¶ºäº­": {"id":"2lVMTs_Fj0M","label":"æ­¦å¶ºäº­","source":"å°ç£å³æ™‚å½±åƒç›£è¦–å™¨"},
      "å˜‰ç¾©-å¥®èµ·æ¹–": {"id":"B6eki-0-w0g","label":"å˜‰ç¾©å¥®èµ·æ¹–","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-äºŒå»¶å¹³æ­¥é“": {"id":"j2L_559nCjc","label":"äºŒå»¶å¹³æ­¥é“","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-å¤ªå¹³é›²æ¢¯": {"id":"dY2cRNr5Buw","label":"å¤ªå¹³é›²æ¢¯","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-è§¸å£éŠå®¢ä¸­å¿ƒ": {"id":"8KnqJBf_dow","label":"è§¸å£éŠå®¢ä¸­å¿ƒ","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-æ„›æƒ…å¤§è‰åŸ": {"id":"hMYs60qtkK8","label":"æ„›æƒ…å¤§è‰åŸ","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-ç”ŸåŠ›è¾²å ´": {"id":"agEzlv9n9Eg","label":"ç”ŸåŠ›è¾²å ´","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-é‡Œä½³è³‡è¨Šç«™": {"id":"zDt8FBPozZQ","label":"é‡Œä½³è³‡è¨Šç«™","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°å—-ä¸ƒè‚¡è³é³¥å°": {"id":"5KJe2gCTngA","label":"å°å—ä¸ƒè‚¡","source":"å°æ±Ÿåœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å°å—-åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€": {"id":"FES0gWTFUHQ","label":"åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€","source":"å°æ±Ÿåœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å°å—-æ›¾æ–‡æ°´åº«": {"id":"EH4V8IwFIp4","label":"æ›¾æ–‡æ°´åº«","source":"è¥¿æ‹‰é›…åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°å—-ç«å±±ç¢§é›²å¯º": {"id":"zkX6X9p-6iA","label":"ç«å±±ç¢§é›²å¯º","source":"è¥¿æ‹‰é›…åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
      "é«˜é›„-æ¥ æ¢“è–èˆˆæ©‹": {"id":"1vVCtk5OXVk","label":"æ¥ æ¢“è–èˆˆæ©‹","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "é«˜é›„-èšµå¯®åœ‹å°": {"id":"sKrqs-5Auqo","label":"èšµå¯®åœ‹å°","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "é«˜é›„-æ——æ´¥æµ·æ°´æµ´å ´": {"id":"ka7FV0sCvxQ","label":"æ——æ´¥æµ·æ°´æµ´å ´","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-å£½å±±è§€æ™¯å°": {"id":"C03Itx8iSC0","label":"å£½å±±è§€æ™¯å°","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-è“®æ± æ½­": {"id":"BnPoNatG-HE","label":"è“®æ± æ½­","source":"é«˜é›„æ—…éŠç¶²"}, 
      "é«˜é›„-æ——æ´¥ç‡ˆå¡”": {"id":"N_tB5fU2d5I","label":"æ——æ´¥ç‡ˆå¡”","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-æ„›æ²³": {"id":"92nFhF3-E8A","label":"æ„›æ²³","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-è¥¿å­ç£": {"id":"9J-uO5F-2eE","label":"è¥¿å­ç£","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-è¡›æ­¦ç‡Ÿéƒ½æœƒå…¬åœ’": {"id":"W5cI_PjV928","label":"è¡›æ­¦ç‡Ÿéƒ½æœƒå…¬åœ’","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-é§äºŒ": {"id":"L6gL2xT8NfQ","label":"é§äºŒ","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-é«˜é›„æµè¡ŒéŸ³æ¨‚ä¸­å¿ƒ": {"id":"h0Bq7P96WqE","label":"é«˜é›„æµè¡ŒéŸ³æ¨‚ä¸­å¿ƒ","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-é«˜é›„å±•è¦½é¤¨": {"id":"sT81k3yWzKk","label":"é«˜é›„å±•è¦½é¤¨","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-ä¸­å¤®å…¬åœ’": {"id":"1VlMh8VjVlY","label":"ä¸­å¤®å…¬åœ’","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-é«˜é›„è»Šç«™": {"id":"c-T3z95R9c0","label":"é«˜é›„è»Šç«™","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-æ¥ æ¢“é‹å‹•å ´": {"id":"0sQ7Kj-gWj0","label":"æ¥ æ¢“é‹å‹•å ´","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-é«˜é›„åœ‹éš›æ©Ÿå ´": {"id":"6M3P0E3NnI4","label":"é«˜é›„åœ‹éš›æ©Ÿå ´","source":"é«˜é›„æ—…éŠç¶²"},
      "å±æ±-å¢¾ä¸å—ç£": {"id":"xG13F0sM95s","label":"å¢¾ä¸å—ç£","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-å¤§éµ¬ç£": {"id":"8f91W2k7Gjs","label":"å¤§éµ¬ç£","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¤§éµ¬ç£åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å±æ±-é—œå±±": {"id":"9V6L5wN9D2g","label":"é—œå±±","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-è²“é¼»é ­": {"id":"D1Q2x9jL8pQ","label":"è²“é¼»é ­","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-ç¤¾é ‚å…¬åœ’": {"id":"G0x1bN4P8qA","label":"ç¤¾é ‚å…¬åœ’","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-éµé‘¾é¼»": {"id":"4X6yM7N1v5E","label":"éµé‘¾é¼»","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-ç™½æ²™ç£": {"id":"R1e3vL9oT7c","label":"ç™½æ²™ç£","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-å°ç£": {"id":"L8aN5oQ2r3s","label":"å°ç£","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-å¾Œå£æ¹–": {"id":"V9m8N3sC2tQ","label":"å¾Œå£æ¹–","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-æ²™å³¶": {"id":"T4u1qP0vR8w","label":"æ²™å³¶","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å±æ±-æ±æ¸¯å¤§æ©‹": {"id":"c6h9rP2sL7w","label":"æ±æ¸¯å¤§æ©‹","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "èŠ±è“®-ä¸ƒæ˜Ÿæ½­": {"id":"i-iO09uL8sQ","label":"ä¸ƒæ˜Ÿæ½­","source":"èŠ±è“®ç¸£æ”¿åºœè§€å…‰è™•"},
      "èŠ±è“®-é¯‰é­šæ½­": {"id":"j7k4L1m3n9o","label":"é¯‰é­šæ½­","source":"èŠ±è“®ç¸£æ”¿åºœè§€å…‰è™•"},
      "èŠ±è“®-å…­åçŸ³å±±": {"id":"k0l5m8N6p2q","label":"å…­åçŸ³å±±","source":"èŠ±è“®ç¸£æ”¿åºœè§€å…‰è™•"},
      "èŠ±è“®-é›²å±±æ°´": {"id":"m1n3o5P7q9r","label":"é›²å±±æ°´","source":"èŠ±è“®ç¸£æ”¿åºœè§€å…‰è™•"},
      "å°æ±-ä¸‰ä»™å°": {"id":"n2o4p6Q8r0s","label":"ä¸‰ä»™å°","source":"äº¤é€šéƒ¨è§€å…‰ç½²æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶ç‡ˆå¡”": {"id":"o3p5q7R9s1t","label":"ç¶ å³¶ç‡ˆå¡”","source":"äº¤é€šéƒ¨è§€å…‰ç½²æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-è˜­å¶¼": {"id":"p4q6r8S0t2u","label":"è˜­å¶¼","source":"å°æ±ç¸£æ”¿åºœè§€å…‰è™•"},
      "å°æ±-ä¼½è·¯è˜­": {"id":"q5r7s9T1u3v","label":"ä¼½è·¯è˜­","source":"äº¤é€šéƒ¨è§€å…‰ç½²æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "æ¾æ¹–-è·¨æµ·å¤§æ©‹": {"id":"r6s8t0U2v4w","label":"è·¨æµ·å¤§æ©‹","source":"äº¤é€šéƒ¨è§€å…‰ç½²æ¾æ¹–åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "æ¾æ¹–-ä¸ƒç¾é›™å¿ƒçŸ³æ»¬": {"id":"s7t9u1V3w5x","label":"ä¸ƒç¾é›™å¿ƒçŸ³æ»¬","source":"äº¤é€šéƒ¨è§€å…‰ç½²æ¾æ¹–åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "é‡‘é–€-å¤å¯§é ­": {"id":"t8u0v2W4x6y","label":"å¤å¯§é ­","source":"é‡‘é–€åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "é‡‘é–€-æ…ˆæ¹–": {"id":"u9v1w3X5y7z","label":"æ…ˆæ¹–","source":"é‡‘é–€åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "é¦¬ç¥–-æ±å¼•ç‡ˆå¡”": {"id":"v0w2x4Y6z8a","label":"æ±å¼•ç‡ˆå¡”","source":"äº¤é€šéƒ¨è§€å…‰ç½²é¦¬ç¥–åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "é¦¬ç¥–-å—ç«¿": {"id":"w1x3y5Z7a9b","label":"å—ç«¿","source":"äº¤é€šéƒ¨è§€å…‰ç½²é¦¬ç¥–åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å…¶ä»–-é˜¿é‡Œå±±": {"id":"jJ2t7v7t1K0","label":"é˜¿é‡Œå±±","source":"è¾²æ¥­éƒ¨æ—æ¥­åŠè‡ªç„¶ä¿è‚²ç½²é˜¿é‡Œå±±åœ‹å®¶æ£®æ—éŠæ¨‚å€"},
      "å…¶ä»–-ç‰å±±å¡”å¡”åŠ ": {"id":"hQ8iGz6qK5c","label":"ç‰å±±å¡”å¡”åŠ ","source":"ç‰å±±åœ‹å®¶å…¬åœ’"},
      "å…¶ä»–-é›ªéœ¸": {"id":"H6Qk8N2c3gU","label":"é›ªéœ¸","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "å…¶ä»–-å¢¾ä¸": {"id":"o1P9q2R5s8T","label":"å¢¾ä¸","source":"äº¤é€šéƒ¨è§€å…‰ç½²å¢¾ä¸åœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å…¶ä»–-æ—¥æœˆæ½­": {"id":"l9K4m7N0o3P","label":"æ—¥æœˆæ½­","source":"äº¤é€šéƒ¨è§€å…‰ç½²æ—¥æœˆæ½­åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å…¶ä»–-å¤ªé­¯é–£": {"id":"q2R5s8T1u4V","label":"å¤ªé­¯é–£","source":"å¤ªé­¯é–£åœ‹å®¶å…¬åœ’"},
      "å…¶ä»–-é€£æ±Ÿç¸£è­°æœƒ": {"id":"j-1jXm7gY4A","label":"é€£æ±Ÿç¸£è­°æœƒ","source":"é€£æ±Ÿç¸£è­°æœƒ"},
    };

    /* ===== è®Šæ•¸å®šç¾© (ä¿æŒä¸è®Š) ===== */
    const MAX_PLAYERS = 9; // æœ€å¤§æ’­æ”¾å™¨æ•¸é‡ (å°æ‡‰ 3x3)
    const DEFAULT_VIDEO_ID = "dQw4w9WgXcQ"; // é è¨­çš„å½±ç‰‡ ID (Rickroll, ä½œç‚ºç„¡æ•ˆæˆ–è¼‰å…¥ä¸­çš„é è¨­)
    let players = new Array(MAX_PLAYERS).fill(null);
    let streamState = new Array(MAX_PLAYERS).fill(null); // å„²å­˜æ¯å€‹ç•«é¢çš„ç‹€æ…‹ {key, id, label, source}
    let selectedCamIndex = 0; // ç•¶å‰æ“ä½œçš„ç•«é¢ç´¢å¼• (0åˆ°8)
    let isMuted = localStorage.getItem('isMuted') === 'true' || false; // æ•´é«”éœéŸ³ç‹€æ…‹
    let isLabelsVisible = localStorage.getItem('isLabelsVisible') !== 'false'; // æ¨™ç±¤é¡¯ç¤ºç‹€æ…‹
    let currentCity = localStorage.getItem('currentCity') || null; // ç•¶å‰é¸ä¸­çš„åŸå¸‚ï¼Œç”¨æ–¼åŸå¸‚/æ™¯é»åˆ‡æ›
    let currentGridSize = localStorage.getItem('gridSize') || '2x2'; // ç•«é¢åˆ†å‰²æ¨¡å¼
    let currentLang = localStorage.getItem('language') || 'zh-TW'; // èªè¨€è¨­å®š

    // éŸ³æ¨‚æ’­æ”¾å™¨ç›¸é—œè®Šæ•¸
    let musicPlayer = null;
    let musicQueue = [];
    let currentMusicIndex = -1;
    let pendingPlaylistId = null;
    let playbackMode = localStorage.getItem('playbackMode') || 'listLoop';
    let isPlaying = false;
    let isMusicReady = false;
    let currentPlaylistId = null;

    let lastReloadAt = Array(MAX_PLAYERS).fill(0);
    let isReloading = Array(MAX_PLAYERS).fill(false);
    const RELOAD_COOLDOWN_MS = 60000;

    // YouTube Data API key (è«‹æ³¨æ„ï¼šæ­¤ç‚ºå…¬é–‹æ¸¬è©¦ç”¨ Keyï¼Œæ­£å¼ç’°å¢ƒè«‹ä½¿ç”¨æ‚¨è‡ªå·±çš„ Key)
    const YT_DATA_API_KEY = 'AIzaSyCwW3oAnY8rqIgL-kK9yGCxb7pNsvbvIz4';

    // åŸå¸‚åˆ†çµ„
    const GROUPED_STREAMS = {};
    Object.keys(ALL_STREAMS).forEach(key => {
      const city = key.split('-')[0];
      if (!GROUPED_STREAMS[city]) GROUPED_STREAMS[city] = [];
      GROUPED_STREAMS[city].push({ key: key, ...ALL_STREAMS[key] });
    });

    const REGION_GROUPS = {
      'åŒ—éƒ¨': ['å°åŒ—', 'æ–°åŒ—', 'åŸºéš†', 'æ¡ƒåœ’', 'å®œè˜­', 'æ–°ç«¹'],
      'ä¸­éƒ¨': ['è‹—æ —', 'å°ä¸­', 'å½°åŒ–', 'å—æŠ•', 'é›²æ—'],
      'å—éƒ¨': ['å˜‰ç¾©', 'å°å—', 'é«˜é›„', 'å±æ±', 'æ¾æ¹–'],
      'æ±éƒ¨': ['èŠ±è“®', 'å°æ±'],
      'é›¢å³¶': ['é‡‘é–€', 'é¦¬ç¥–'],
      'å…¶ä»–': ['å…¶ä»–']
    };

    /* ===== èªè¨€åŒ… (Localization) - ä¿®æ­£ cam_name é †åº ===== */
    const LANGUAGES = {
      'zh-TW': {
        'title': 'å°ç£å³æ™‚ç›´æ’­å¤šåˆ†å‰²ç›£çœ‹',
        'cam_name': (index) => {
          const names = ['å·¦ä¸Š', 'å³ä¸Š', 'å·¦ä¸‹', 'å³ä¸‹'];
          const names3x3 = ['å·¦ä¸Š', 'ä¸­ä¸Š', 'å³ä¸Š', 'å·¦ä¸­', 'æ­£ä¸­', 'å³ä¸­', 'å·¦ä¸‹', 'ä¸­ä¸‹', 'å³ä¸‹'];
          const numCams = getGridDimension() * getGridDimension();
          if (numCams === 9) {
            return names3x3[index] || `ç•«é¢ ${index + 1}`;
          } else if (numCams === 4) {
            return names[index] || `ç•«é¢ ${index + 1}`;
          } else {
            return `ç•«é¢ ${index + 1}`;
          }
        },
        'fullscreen_btn': 'å…¨è¢å¹•',
        'settings_btn': 'âš™ï¸ è¨­å®š',
        'mute_btn_unmuted': 'è§£é™¤éœéŸ³',
        'mute_btn_muted': 'éœéŸ³',
        'request_btn': 'ğŸ¶ é»æ­Œ/æ¸…å–®',
        'back_btn': 'ğŸ  è¿”å›åœ°å€',
        'loading': 'è¼‰å…¥ä¸­...',
        'source_prefix': 'ä¾†æºï¼š',
        // Settings Modal
        'settings_title': 'âš™ï¸ ç¨‹å¼è¨­å®š',
        'grid_size_label': 'ç•«é¢åˆ†å‰²æ¨¡å¼ï¼š',
        'grid_1x1': '1x1 (å–®ç•«é¢)',
        'grid_2x2': '2x2 (å››åˆ†å‰²)',
        'grid_3x3': '3x3 (ä¹åˆ†å‰²)',
        'grid_hint': 'æ›´æ”¹åˆ†å‰²æ¨¡å¼å°‡é‡è¨­æ‰€æœ‰ç•«é¢ã€‚',
        'language_label': 'èªè¨€é¸æ“‡ï¼š',
        'lang_zh_tw': 'æ­£é«”ä¸­æ–‡',
        'lang_en_us': 'English',
        'labels_toggle_label': 'ç•«é¢æ¨™ç±¤é¡¯ç¤ºï¼š',
        'labels_toggle_hide': 'æ¨™ç±¤éš±è—',
        'labels_toggle_show': 'æ¨™ç±¤é¡¯ç¤º',
        'settings_close_btn': 'é—œé–‰è¨­å®š',
        // Music Modal
        'music_mode_title': 'éŸ³æ¨‚æ’­æ”¾æ¨¡å¼',
        'music_mode_hint': 'é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æ’­æ”¾æ¨¡å¼ï¼š',
        'mode_list_loop': 'ğŸ”„ åˆ—è¡¨å¾ªç’°',
        'mode_shuffle': 'ğŸ”€ éš¨æ©Ÿæ’­æ”¾',
        'mode_stop_btn': 'â¹ï¸ åœæ­¢ä¸¦çµæŸæ’­æ”¾',
        'music_mode_close_btn': 'é—œé–‰',
        // Queue Modal
        'queue_title': 'ğŸ¶ æ’­æ”¾åˆ—è¡¨ç‹€æ…‹',
        'queue_current': 'ç•¶å‰æ’­æ”¾ï¼š',
        'queue_playlist_info': (id) => `æ­£åœ¨æ’­æ”¾æ’­æ”¾æ¸…å–® (ID: ${id})`,
        'queue_total': (total, current, mode) => `æ¸…å–®ç¸½æ•¸: ${total} é¦– | ç›®å‰: ${current} / ${total} | æ¨¡å¼: ${mode}`,
        'queue_next_video': 'ä¸‹ä¸€é¦–ï¼š',
        'queue_list_empty': 'æ²’æœ‰å¾…æ’­æ¸…å–®ã€‚',
        'queue_empty_queue': 'å¾…æ’­æ¸…å–®ç‚ºç©ºã€‚',
        'queue_mode_index': (index) => `æ’­æ”¾ #${index + 1}`,
        'queue_playlist_pending': (id) => `æ­£åœ¨ç²å–æ’­æ”¾æ¸…å–®å½±ç‰‡è³‡è¨Š (ID: ${id})...`,
        // Alerts
        'alert_invalid_playlist': 'ç„¡æ•ˆçš„æ’­æ”¾æ¸…å–® ID æˆ– URLã€‚',
        'alert_playlist_playing': 'æ­¤æ’­æ”¾æ¸…å–®å·²åœ¨æ’­æ”¾ä¸­ã€‚',
        'alert_fetching_playlist': 'æ­£åœ¨ç²å–æ’­æ”¾æ¸…å–®å…§å®¹ï¼Œè«‹ç¨å€™...',
        'alert_no_playlist_found': 'æ‰¾ä¸åˆ°æ­¤æ’­æ”¾æ¸…å–®ã€‚',
        'alert_play_index_error': 'æ’­æ”¾ç´¢å¼•éŒ¯èª¤ã€‚',
      },
      'en-US': {
        'title': 'Taiwan Live Stream Multi-View Monitor',
        'cam_name': (index) => {
          const names = ['Top Left', 'Top Right', 'Bottom Left', 'Bottom Right'];
          const names3x3 = ['Top Left', 'Top Center', 'Top Right', 'Middle Left', 'Center', 'Middle Right', 'Bottom Left', 'Bottom Center', 'Bottom Right'];
          const numCams = getGridDimension() * getGridDimension();
          if (numCams === 9) {
            return names3x3[index] || `Cam ${index + 1}`;
          } else if (numCams === 4) {
            return names[index] || `Cam ${index + 1}`;
          } else {
            return `Cam ${index + 1}`;
          }
        },
        'fullscreen_btn': 'Fullscreen',
        'settings_btn': 'âš™ï¸ Settings',
        'mute_btn_unmuted': 'Unmute',
        'mute_btn_muted': 'Mute',
        'request_btn': 'ğŸ¶ Song/Playlist',
        'back_btn': 'ğŸ  Back to Regions',
        'loading': 'Loading...',
        'source_prefix': 'Source:',
        // Settings Modal
        'settings_title': 'âš™ï¸ Program Settings',
        'grid_size_label': 'Screen Grid Layout:',
        'grid_1x1': '1x1 (Single View)',
        'grid_2x2': '2x2 (Quad View)',
        'grid_3x3': '3x3 (Nine View)',
        'grid_hint': 'Changing the grid will reset all views.',
        'language_label': 'Language Selection:',
        'lang_zh_tw': 'Traditional Chinese',
        'lang_en_us': 'English',
        'labels_toggle_label': 'Screen Labels Display:',
        'labels_toggle_hide': 'Hide Labels',
        'labels_toggle_show': 'Show Labels',
        'settings_close_btn': 'Close Settings',
        // Music Modal
        'music_mode_title': 'Music Playback Mode',
        'music_mode_hint': 'Click a button below to select playback mode:',
        'mode_list_loop': 'ğŸ”„ List Loop',
        'mode_shuffle': 'ğŸ”€ Shuffle',
        'mode_stop_btn': 'â¹ï¸ Stop Playback',
        'music_mode_close_btn': 'Close',
        // Queue Modal
        'queue_title': 'ğŸ¶ Playlist Status',
        'queue_current': 'Currently Playing:',
        'queue_playlist_info': (id) => `Playing YouTube Playlist (ID: ${id})`,
        'queue_total': (total, current, mode) => `Total: ${total} tracks | Current: ${current} / ${total} | Mode: ${mode}`,
        'queue_next_video': 'Next Up:',
        'queue_list_empty': 'No pending songs in the queue.',
        'queue_empty_queue': 'The song queue is empty.',
        'queue_mode_index': (index) => `Play #${index + 1}`,
        'queue_playlist_pending': (id) => `Fetching playlist videos (ID: ${id})...`,
        // Alerts
        'alert_invalid_playlist': 'Invalid Playlist ID or URL.',
        'alert_playlist_playing': 'This playlist is already playing.',
        'alert_fetching_playlist': 'Fetching playlist content, please wait...',
        'alert_no_playlist_found': 'Could not find this playlist.',
        'alert_play_index_error': 'Playback index error.',
      }
    };

    /* ===== Helper å‡½å¼ (ä¿æŒä¸è®Š) ===== */

    function getTranslation(key, ...args) {
      const langPack = LANGUAGES[currentLang] || LANGUAGES['zh-TW'];
      let text = langPack[key];
      if (typeof text === 'function') {
        return text(...args);
      }
      return text || LANGUAGES['zh-TW'][key] || key; // Fallback to zh-TW or key itself
    }

    function getGridDimension() {
      return parseInt(currentGridSize.charAt(0), 10);
    }

    function escapeHtml(unsafe) {
      if (typeof unsafe !== 'string') return unsafe;
      return unsafe.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
    }

    function setLanguage(lang) {
      if (LANGUAGES[lang]) {
        currentLang = lang;
        localStorage.setItem('language', lang);
        updateUIForLanguage();
      }
    }

    function updateUIForLanguage() {
      document.getElementById('htmlLang').lang = currentLang;
      document.getElementById('pageTitle').innerText = getTranslation('title');

      // Control buttons
      const camButtonsContainer = document.getElementById('camSelectButtons');
      if (camButtonsContainer) {
        updateCamSelectButtons(getGridDimension() * getGridDimension());
      }
      document.getElementById('fullscreenBtn').innerText = getTranslation('fullscreen_btn');
      document.getElementById('settingsBtn').innerText = getTranslation('settings_btn');
      document.getElementById('settingsBtn').title = getTranslation('settings_title');
      document.getElementById('requestBtn').innerText = getTranslation('request_btn');
      document.getElementById('requestBtn').title = getTranslation('request_btn');
      
      // Modal Text
      document.getElementById('settingsTitle').innerText = getTranslation('settings_title');
      document.getElementById('gridSizeLabel').innerText = getTranslation('grid_size_label');
      document.getElementById('grid1x1Btn').innerText = getTranslation('grid_1x1');
      document.getElementById('grid2x2Btn').innerText = getTranslation('grid_2x2');
      document.getElementById('grid3x3Btn').innerText = getTranslation('grid_3x3');
      document.getElementById('gridSizeHint').innerText = getTranslation('grid_hint');
      document.getElementById('languageLabel').innerText = getTranslation('language_label');
      document.getElementById('langZhTwBtn').innerText = getTranslation('lang_zh_tw');
      document.getElementById('langEnUsBtn').innerText = getTranslation('lang_en_us');
      document.getElementById('labelsToggleLabel').innerText = getTranslation('labels_toggle_label');
      document.getElementById('labelsToggleInModalBtn').innerText = isLabelsVisible ? getTranslation('labels_toggle_show') : getTranslation('labels_toggle_hide');

      document.getElementById('musicModeTitle').innerText = getTranslation('music_mode_title');
      document.getElementById('musicModeHint').innerText = getTranslation('music_mode_hint');
      document.getElementById('modeListLoop').innerText = getTranslation('mode_list_loop');
      document.getElementById('modeShuffle').innerText = getTranslation('mode_shuffle');
      document.getElementById('modeStopBtn').innerText = getTranslation('mode_stop_btn');
      document.getElementById('musicModeCloseBtn').innerText = getTranslation('music_mode_close_btn');

      // Update mute button and all visible labels
      refreshMuteButtonLabel();
      for (let i = 0; i < MAX_PLAYERS; i++) {
        updateLabel(i);
      }
      // Re-render region buttons to update labels like 'Back to Regions'
      if (document.getElementById('regionButtons').querySelector('.back-btn')) {
        showCityStreams(currentCity);
      } else {
        renderRegionButtons();
      }
    }


    /* ===== æ ¸å¿ƒç¨‹å¼ç¢¼ (ä¿æŒä¸è®Š) ===== */

    // YouTube Iframe API è¼‰å…¥å®Œæˆæ™‚å‘¼å«
    function onYouTubeIframeAPIReady() {
      setLanguage(currentLang); // åˆå§‹åŒ–èªè¨€è¨­å®š
      initializeGridSettings(); // ç¢ºä¿ç¶²æ ¼å¤§å°è¨­å®šæ­£ç¢º
      initializeLabelSettings(); // ç¢ºä¿æ¨™ç±¤é¡¯ç¤ºè¨­å®šæ­£ç¢º
      renderRegionButtons(); // æ¸²æŸ“åŸå¸‚æŒ‰éˆ•
      initPlayers(); // åˆå§‹åŒ–ç›´æ’­æ’­æ”¾å™¨
      initMusicPlayer(); // åˆå§‹åŒ–éŸ³æ¨‚æ’­æ”¾å™¨
      refreshMuteButtonLabel(); // åˆ·æ–°éœéŸ³æŒ‰éˆ•æ¨™ç±¤

      // è¨­ç½®å®šæ™‚é‡è¼‰ï¼šæ¯ 10 åˆ†é˜å˜—è©¦é‡æ–°è¼‰å…¥æ‰€æœ‰æ’­æ”¾å™¨
      setInterval(() => {
        const numCams = getGridDimension() * getGridDimension();
        for (let i = 0; i < numCams; i++) {
          const now = Date.now();
          // å¦‚æœè¶…é 10 åˆ†é˜æ²’æœ‰é‡è¼‰ï¼Œä¸”æ’­æ”¾å™¨ä¸æ˜¯æ­£åœ¨é‡è¼‰ä¸­ï¼Œå‰‡åŸ·è¡Œ
          if (now - lastReloadAt[i] > RELOAD_COOLDOWN_MS && !isReloading[i]) {
            console.log(`Cam ${i} scheduled reload after 10 mins.`);
            reloadPlayer(i);
          }
        }
      }, RELOAD_COOLDOWN_MS);
    }

    function getInitialDefaultStream(index) {
      const cities = Object.keys(GROUPED_STREAMS);
      const defaultCity = cities[index % cities.length];
      if (GROUPED_STREAMS[defaultCity] && GROUPED_STREAMS[defaultCity].length > 0) {
        return GROUPED_STREAMS[defaultCity][0].key;
      }
      return null;
    }

    function setGridSize(size, reset = true) {
      if (currentGridSize === size && !reset) return;

      currentGridSize = size;
      localStorage.setItem('gridSize', size);

      const stageWrap = document.getElementById('stageWrap');
      stageWrap.className = `stage-wrap grid-${size}`;

      const numCams = getGridDimension() * getGridDimension();
      updateCamSelectButtons(numCams);

      // é¡¯ç¤º/éš±è— cell å…ƒç´ 
      for (let i = 0; i < MAX_PLAYERS; i++) {
        const cell = CELLS[i];
        if (cell) {
          cell.style.display = i < numCams ? 'block' : 'none';
        }
      }

      // æ›´æ–°æŒ‰éˆ• active ç‹€æ…‹
      document.getElementById('grid1x1Btn').classList.toggle('active', size === '1x1');
      document.getElementById('grid2x2Btn').classList.toggle('active', size === '2x2');
      document.getElementById('grid3x3Btn').classList.toggle('active', size === '3x3');

      // å¦‚æœéœ€è¦é‡è¨­ï¼Œå‰‡é‡æ–°åˆå§‹åŒ–æ’­æ”¾å™¨
      if (reset) {
        // é‡è¨­ selectedCamIndex åˆ°ç¬¬ä¸€å€‹ç•«é¢ (0)ï¼Œå¦‚æœå®ƒè¶…å‡ºäº†æ–°ç¶²æ ¼ç¯„åœ
        if (selectedCamIndex >= numCams) {
            selectedCamIndex = 0;
        }
        document.getElementById('pageBody').classList.toggle('hide-cam-select', numCams === 1);
        initPlayers();
      }
    }

    function initializeGridSettings() {
      // ç¢ºä¿ currentGridSize æ­£ç¢ºè®€å–
      currentGridSize = localStorage.getItem('gridSize') || '2x2';
      setGridSize(currentGridSize, false);
      // ç¢ºä¿ currentGridSize å’Œ body class è¨­ç½®æ­£ç¢º
      // é€™è£¡ä¸å†éœ€è¦é‡è¤‡æ›´æ–°æŒ‰éˆ• active ç‹€æ…‹ï¼Œå› ç‚º setGridSize å·²ç¶“è™•ç†ã€‚
    }

    function initializeLabelSettings() {
      const body = document.body;
      if (!isLabelsVisible) {
        body.classList.add('hide-labels');
      } else {
        body.classList.remove('hide-labels');
      }
    }

    function onPlayerReady(event) {
      // å¼·åŒ–ï¼šç¢ºä¿æ’­æ”¾å™¨è¼‰å…¥æˆåŠŸå¾Œï¼Œå¼·åˆ¶é–‹å§‹æ’­æ”¾ä¸¦éœéŸ³
      try {
        event.target.mute();
        event.target.setVolume(100);
        event.target.playVideo();
      } catch (e) {
        console.warn("Player ready failed to play or mute:", e);
      }
    }

    function onMusicPlayerReady() {
      isMusicReady = true;
      updateMediaSession();
    }

    /* ===== æ ¸å¿ƒä¿®æ­£ï¼šé»æ­Œé‚è¼¯ä¿®æ­£èˆ‡æ’­æ”¾å™¨ç‹€æ…‹è™•ç†å¼·åŒ– (ä¿æŒä¸è®Š) ===== */
    function onMusicPlayerStateChange(event) {
      if (!isPlaying) return;

      if (event.data == YT.PlayerState.PLAYING) {
        updatePlayPauseButton(true);
      } else if (event.data == YT.PlayerState.PAUSED) {
        updatePlayPauseButton(false);
      } else if (event.data == YT.PlayerState.ENDED) {
        updatePlayPauseButton(false);
        // æ ¸å¿ƒä¿®æ­£ 1: æ’­æ”¾å®Œç•¢å¾Œï¼Œæª¢æŸ¥æ˜¯å¦æœ‰å¾…æ’­æ¸…å–®
        if (currentPlaylistId) {
          // å¦‚æœæ˜¯æ’­æ”¾æ¸…å–®ï¼ŒYouTube æ’­æ”¾å™¨æœƒè‡ªå‹•æ’­æ”¾ä¸‹ä¸€é¦–ï¼Œé€™è£¡ä¸éœ€è¦é¡å¤–è™•ç†
          // ä½†éœ€è¦æ›´æ–°åª’é«”è³‡è¨Š
          const currentIdx = musicPlayer.getPlaylistIndex();
          if (currentIdx !== -1) {
            updateMediaSession(musicPlayer.getVideoData().title);
          }
        } else if (musicQueue.length > 0 && playbackMode !== 'listLoop') {
          // æ’­æ”¾å–®æ›²ä¸”æœ‰åˆ—è¡¨ï¼Œæ ¹æ“šæ¨¡å¼è·³åˆ°ä¸‹ä¸€é¦–
          skipToNextSong();
        } else if (musicQueue.length > 0 && playbackMode === 'listLoop') {
          // æ’­æ”¾æ¸…å–®å¾ªç’° (åªæœ‰ä¸€é¦–æ­Œæ™‚ï¼Œå–®æ›²æœƒçµæŸ)
          // ä¿®æ­£ï¼šç•¶åªæœ‰ä¸€é¦–æ­Œä¸”æ˜¯ listLoop æ™‚ï¼Œé‡æ–°æ’­æ”¾è©²æ›²
          currentMusicIndex = (currentMusicIndex + 1) % musicQueue.length;
          loadAndPlayCurrentSong();
        } else {
          stopMusic();
        }
      }
    }

    function handleStateChange(event, index) {
      const player = players[index];
      const state = streamState[index];
      if (!player || !state) return;

      if (event.data === YT.PlayerState.PLAYING) {
        // ç¢ºä¿æ’­æ”¾å™¨ç¶­æŒåœ¨ç•¶å‰é¸æ“‡çš„éœéŸ³/è§£é™¤éœéŸ³ç‹€æ…‹
        if (index !== selectedCamIndex) {
          try {
            player.mute();
          } catch (e) {}
        } else {
          try {
            isMuted ? player.mute() : player.unMute();
          } catch (e) {}
        }
      } else if (event.data === YT.PlayerState.ENDED || event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.BUFFERING) {
        // å¼·åŒ–é‡è¼‰é‚è¼¯ï¼šç•¶ç›´æ’­çµæŸ (ENDED)ã€æš«åœ (PAUSED)ã€æˆ–é•·æ™‚é–“ç·©è¡ (BUFFERING) æ™‚
        const now = Date.now();
        if (now - lastReloadAt[index] < RELOAD_COOLDOWN_MS) {
          if (event.data === YT.PlayerState.ENDED || event.data === YT.PlayerState.PAUSED) {
            // å˜—è©¦ç°¡å–®æ’­æ”¾ã€‚
            try {
              player.playVideo();
            } catch (e) {}
          }
          return;
        }

        // åŸ·è¡Œå¼·åˆ¶é‡è¼‰
        isReloading[index] = true;
        lastReloadAt[index] = now;
        try {
          // ä½¿ç”¨ loadVideoById é€²è¡Œé‡è¼‰ï¼Œç¢ºä¿å¾é ­é–‹å§‹
          player.loadVideoById(state.id, 0);
          player.playVideo(); // ç«‹å³å˜—è©¦æ’­æ”¾
          console.log(`Cam ${index} state ${event.data} detected. Forced reload and play for ID: ${state.id}`);

          // é‡æ–°æ‡‰ç”¨éœéŸ³ç‹€æ…‹
          if (index !== selectedCamIndex) {
            player.mute();
          } else {
            isMuted ? player.mute() : player.unMute();
          }
        } catch (e) {
          console.error(`Error forcing reload on Cam ${index}:`, e);
        }
        isReloading[index] = false;
      }
    }


    /* ===== æ’­æ”¾å™¨æ§åˆ¶èˆ‡ç‹€æ…‹æ›´æ–° (ä¿æŒä¸è®Š) ===== */
    function updateCamSelectButtons(numCams) {
      const camButtonsContainer = document.getElementById('camSelectButtons');
      camButtonsContainer.innerHTML = '';
      for (let i = 0; i < numCams; i++) {
        const btn = document.createElement('button');
        btn.id = `select-cam-${i}`;
        btn.className = (i === selectedCamIndex) ? 'active' : '';
        btn.setAttribute('onclick', `selectCam(${i})`);
        btn.innerText = getTranslation('cam_name', i);
        camButtonsContainer.appendChild(btn);
      }
    }

    function selectCam(index) {
      const numCams = getGridDimension() * getGridDimension();
      if (index >= numCams) return;

      selectedCamIndex = index;

      // æ›´æ–°æŒ‰éˆ•æ¨£å¼ (å¦‚æœæŒ‰éˆ•é¡¯ç¤ºçš„è©±)
      const camButtonsContainer = document.getElementById('camSelectButtons');
      if (!document.getElementById('pageBody').classList.contains('hide-cam-select')) {
        for (let i = 0; i < numCams; i++) {
          const btn = document.getElementById(`select-cam-${i}`);
          if (btn) {
            if (i === selectedCamIndex) {
              btn.classList.add('active');
            } else {
              btn.classList.remove('active');
            }
          }
        }
      }

      // åˆ·æ–°éœéŸ³æŒ‰éˆ•ç‹€æ…‹
      refreshMuteButtonLabel();

      // éœéŸ³æ‰€æœ‰éé¸ä¸­çš„ç•«é¢
      for (let i = 0; i < numCams; i++) {
        if (players[i]) {
          try {
            if (i === selectedCamIndex) {
              isMuted ?
                players[i].mute() : players[i].unMute();
            } else {
              players[i].mute();
            }
          } catch (e) {}
        }
      }
    }

    function toggleFullscreen() {
      const doc = document.documentElement;
      const controls = document.getElementById('controls');
      if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && !document.msFullscreenElement) {
        // é€²å…¥å…¨è¢å¹•
        if (doc.requestFullscreen) {
          doc.requestFullscreen();
        } else if (doc.mozRequestFullScreen) { // Firefox
          doc.mozRequestFullScreen();
        } else if (doc.webkitRequestFullscreen) { // Chrome, Safari and Opera
          doc.webkitRequestFullscreen();
        } else if (doc.msRequestFullscreen) { // IE/Edge
          doc.msRequestFullscreen();
        }
        document.body.classList.add('fullscreen-active');
      } else {
        // é›¢é–‹å…¨è¢å¹•
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.mozCancelFullScreen) {
          document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
          document.msExitFullscreen();
        }
        document.body.classList.remove('fullscreen-active');
      }
    }

    function toggleLabels() {
      isLabelsVisible = !isLabelsVisible;
      localStorage.setItem('isLabelsVisible', isLabelsVisible);
      document.body.classList.toggle('hide-labels', !isLabelsVisible);
      
      const labelsToggleInModalBtn = document.getElementById('labelsToggleInModalBtn');
      if (labelsToggleInModalBtn) {
        labelsToggleInModalBtn.innerText = isLabelsVisible ? getTranslation('labels_toggle_hide') : getTranslation('labels_toggle_show');
      }
    }

    function toggleMute() {
      isMuted = !isMuted;
      localStorage.setItem('isMuted', isMuted);
      refreshMuteButtonLabel();
      // åƒ…åˆ‡æ›ç•¶å‰é¸ä¸­çš„ç•«é¢
      if (players[selectedCamIndex]) {
        try {
          isMuted ? players[selectedCamIndex].mute() : players[selectedCamIndex].unMute();
        } catch (e) {}
      }
    }

    function refreshMuteButtonLabel() {
      const muteBtn = document.getElementById('muteBtn');
      if (muteBtn) {
        muteBtn.innerText = isMuted ? getTranslation('mute_btn_muted') : getTranslation('mute_btn_unmuted');
      }
    }

    function updateLabel(index) {
      const labelElement = document.getElementById(LABEL_IDS[index]);
      if (labelElement) {
        const state = streamState[index];
        if (state) {
          labelElement.querySelector('.source-on-screen').innerText = `${getTranslation('source_prefix')} ${escapeHtml(state.source)}`;
          labelElement.childNodes[0].nodeValue = `${escapeHtml(state.label)}`;
        } else {
          labelElement.childNodes[0].nodeValue = getTranslation('loading');
          labelElement.querySelector('.source-on-screen').innerText = '';
        }
      }
    }

    function initPlayers() {
      const numCams = getGridDimension() * getGridDimension();
      for (let i = 0; i < numCams; i++) {
        const defaultKey = getInitialDefaultStream(i);
        let initialVideoId = DEFAULT_VIDEO_ID;
        
        // è¼‰å…¥ streamState ä¸­å„²å­˜çš„é è¨­ä¸²æµ ID
        if (streamState[i] && streamState[i].id) {
          initialVideoId = streamState[i].id;
        } else {
          // å¦å‰‡ä½¿ç”¨è¼ªæµçš„é è¨­åŸå¸‚
          initialVideoId = (defaultKey && ALL_STREAMS[defaultKey]) ? ALL_STREAMS[defaultKey].id : DEFAULT_VIDEO_ID;
        }

        if (!players[i]) {
          // å¦‚æœæ’­æ”¾å™¨å°šæœªåˆå§‹åŒ–ï¼Œå‰‡é€²è¡Œåˆå§‹åŒ–
          players[i] = new YT.Player(PLAYER_IDS[i], {
            videoId: initialVideoId,
            playerVars: {
              autoplay: 1,
              controls: 0,
              modestbranding: 1,
              rel: 0,
              showinfo: 0,
              fs: 0,
              disablekb: 1,
              loop: 1,
              mute: 1,
              playsinline: 1,
              start: 0
            },
            events: {
              onReady: onPlayerReady,
              onStateChange: (event) => handleStateChange(event, i)
            }
          });
        } else {
          // å¦‚æœå·²ç¶“å­˜åœ¨ï¼Œç›´æ¥è¼‰å…¥é è¨­å½±ç‰‡
          try {
            players[i].loadVideoById(initialVideoId, 0);
            players[i].mute();
          } catch(e) { /* silent fail */ }
        }
        
        // ä¿®æ­£: ç¢ºä¿ streamState[i] æ­£ç¢ºåˆå§‹åŒ–
        const streamKey = Object.keys(ALL_STREAMS).find(key => ALL_STREAMS[key].id === initialVideoId);
        streamState[i] = { 
            key: streamKey || defaultKey, 
            id: initialVideoId,
            label: ALL_STREAMS[streamKey]?.label || getTranslation('loading'),
            source: ALL_STREAMS[streamKey]?.source || ''
        };
        updateLabel(i);
      }

      // è™•ç†å¤šé¤˜çš„æ’­æ”¾å™¨ (åœæ­¢ä¸¦ç§»é™¤ç‹€æ…‹)
      for (let i = numCams; i < MAX_PLAYERS; i++) {
        if (players[i]) {
          try {
            players[i].stopVideo();
          } catch(e) {}
          streamState[i] = null;
          updateLabel(i);
        }
      }

      // é‡æ–°é¸ä¸­ç•«é¢ (ç¢ºä¿éœéŸ³ç‹€æ…‹æ­£ç¢º)
      selectCam(selectedCamIndex);
    }

    function reloadPlayer(index) {
      const state = streamState[index];
      if (!players[index] || !state) return;

      isReloading[index] = true;
      lastReloadAt[index] = Date.now();
      
      try {
        // å¼·åˆ¶é‡è¼‰ä¸¦å¾é ­é–‹å§‹
        players[index].loadVideoById(state.id, 0);
        players[index].playVideo(); 
        console.log(`Cam ${index} forced scheduled reload for ID: ${state.id}`);
        
        // é‡æ–°æ‡‰ç”¨éœéŸ³ç‹€æ…‹
        if (index !== selectedCamIndex) {
          players[index].mute();
        } else {
          isMuted ? players[index].mute() : players[index].unMute();
        }
      } catch (e) {
        console.error(`Error reloading Cam ${index}:`, e);
      }
      isReloading[index] = false;
    }

    // é–‹å•Ÿä¸»è¦è¨­å®šå½ˆçª—
    function openMainSettingsModal() {
      document.getElementById('mainSettingsModal').style.display = 'flex';
      document.getElementById('labelsToggleInModalBtn').innerText = document.body.classList.contains('hide-labels') ? getTranslation('labels_toggle_show') : getTranslation('labels_toggle_hide');
    }
    // é—œé–‰ä¸»è¦è¨­å®šå½ˆçª—
    function closeMainSettingsModal() {
      document.getElementById('mainSettingsModal').style.display = 'none';
    }


    /* ===== é¸æ“‡æ™¯é»ç›¸é—œå‡½å¼ (ä¿æŒä¸è®Š) ===== */
    function switchStream(streamKey) {
      const stream = ALL_STREAMS[streamKey];
      if (!stream) return;

      const index = selectedCamIndex;
      const player = players[index];
      streamState[index] = { key: streamKey, ...stream };
      updateLabel(index);
      lastReloadAt[index] = 0; // é‡è¨­é‡è¼‰è¨ˆæ™‚å™¨

      if (!player) return;

      try {
        player.loadVideoById(stream.id, 0);
        player.playVideo();
        if (index !== selectedCamIndex) {
          player.mute();
        } else {
          isMuted ? player.mute() : player.unMute();
        }
      } catch (e) {
        console.error(`Error loading video for index ${index}:`, e);
        // å¦‚æœè¼‰å…¥å¤±æ•—ï¼Œæ¸…ç©ºç‹€æ…‹
        streamState[index] = null;
        updateLabel(index);
      }
    }

    // ä¿®æ­£: ç¢ºä¿ç¸£å¸‚åˆ—è¡¨èƒ½å¤ æ­£ç¢ºæ¸²æŸ“
    function renderRegionButtons() {
      const container = document.getElementById('regionButtons');
      container.innerHTML = '';
      currentCity = null;
      localStorage.removeItem('currentCity'); // æ¸…é™¤åŸå¸‚ç‹€æ…‹

      Object.keys(REGION_GROUPS).forEach(region => {
        const cities = REGION_GROUPS[region].filter(city => GROUPED_STREAMS[city] && GROUPED_STREAMS[city].length > 0);
        if (cities.length === 0) return;

        const regionLabel = document.createElement('span');
        regionLabel.className = 'region-label';
        regionLabel.textContent = region + 'ï¼š';
        container.appendChild(regionLabel);

        cities.forEach(city => {
          const streams = GROUPED_STREAMS[city];
          if (streams.length > 0) {
            const cityBtn = document.createElement('button');
            cityBtn.className = 'city-btn';
            cityBtn.textContent = city;
            cityBtn.title = `åˆ‡æ›é¡¯ç¤º ${city} çš„ç›´æ’­åˆ—è¡¨`;
            if (currentCity === city) {
              cityBtn.classList.add('active-city');
            }
            cityBtn.onclick = () => showCityStreams(city);
            container.appendChild(cityBtn);
          }
        });
      });
    }

    function showCityStreams(city) {
      const streams = GROUPED_STREAMS[city];
      if (!streams || streams.length === 0) return;

      currentCity = city;
      localStorage.setItem('currentCity', city);

      const container = document.getElementById('regionButtons');
      container.innerHTML = '';

      const backBtn = document.createElement('button');
      backBtn.className = 'back-btn';
      backBtn.textContent = getTranslation('back_btn');
      backBtn.title = getTranslation('back_btn');
      backBtn.onclick = renderRegionButtons;
      container.appendChild(backBtn);
      
      const regionLabel = document.createElement('span');
      regionLabel.className = 'region-label';
      regionLabel.textContent = `${city}ï¼š`;
      container.appendChild(regionLabel);


      streams.forEach(stream => {
        const streamBtn = document.createElement('button');
        streamBtn.className = 'stream-btn';
        streamBtn.textContent = stream.label;
        streamBtn.title = stream.source;
        streamBtn.onclick = () => switchStream(stream.key);
        container.appendChild(streamBtn);
      });
    }

    /* ===== éŸ³æ¨‚æ’­æ”¾å™¨ç›¸é—œå‡½å¼ (ä¿æŒä¸è®Š) ===== */

    function initMusicPlayer() {
      musicPlayer = new YT.Player('player_music', {
        videoId: DEFAULT_VIDEO_ID,
        playerVars: {
          autoplay: 0,
          controls: 0,
          modestbranding: 1,
          rel: 0,
          showinfo: 0,
          fs: 0,
          disablekb: 1,
          playsinline: 1,
        },
        events: {
          onReady: onMusicPlayerReady,
          onStateChange: onMusicPlayerStateChange
        }
      });
    }

    function stopMusic() {
      if (musicPlayer && isMusicReady) {
        try {
          musicPlayer.stopVideo();
        } catch (e) {
          console.error("Error stopping music:", e);
        }
      }
      document.getElementById('musicControlsContainer').style.display = 'none';
      musicQueue = [];
      currentMusicIndex = -1;
      currentPlaylistId = null;
      pendingPlaylistId = null;
      isPlaying = false;
      updatePlayPauseButton(false);
      updateMediaSession(); // æ¸…é™¤åª’é«”è³‡è¨Š
    }

    function stopAndCloseModal() {
      stopMusic();
      closeMusicSettingsModal();
    }

    function updateMediaSession(title) {
      if ('mediaSession' in navigator) {
        if (!title) {
          navigator.mediaSession.metadata = null;
          return;
        }
        navigator.mediaSession.metadata = new MediaMetadata({
          title: title,
          artist: 'YouTube Music Player'
        });
        navigator.mediaSession.setActionHandler('play', () => {
          playPauseSong(true);
        });
        navigator.mediaSession.setActionHandler('pause', () => {
          playPauseSong(false);
        });
        navigator.mediaSession.setActionHandler('previoustrack', skipToPreviousSong);
        navigator.mediaSession.setActionHandler('nexttrack', skipToNextSong);
      }
    }

    function updatePlayPauseButton(playing) {
      const btn = document.getElementById('playPauseBtn');
      if (btn) {
        btn.innerText = playing ? 'â¸ï¸' : 'â–¶ï¸';
        btn.title = playing ? 'æš«åœ' : 'æ’­æ”¾';
      }
    }

    function playPauseSong(forcePlay) {
      if (!isMusicReady) return;

      if (musicPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
        if (forcePlay === false) {
          musicPlayer.pauseVideo();
        } else if (forcePlay === true) {
          // Already playing
        } else {
          musicPlayer.pauseVideo();
        }
      } else {
        if (musicQueue.length > 0 && currentMusicIndex === -1) {
          currentMusicIndex = 0;
          // å¦‚æœæ¸…å–®æœ‰æ­Œä½†ç´¢å¼•æ²’è¨­å®šï¼Œå¾é ­é–‹å§‹
        }
        if (currentMusicIndex !== -1 || currentPlaylistId) {
          musicPlayer.playVideo();
          isPlaying = true;
        } else {
          // å¦‚æœæ²’æœ‰æ­Œï¼Œå½ˆå‡ºé»æ­Œè¦–çª—
          requestSong();
        }
      }
    }

    function skipToNextSong() {
      if (!isMusicReady || !isPlaying) return;

      if (currentPlaylistId) {
        musicPlayer.nextVideo();
      } else if (musicQueue.length > 0) {
        let nextIndex = currentMusicIndex;

        if (playbackMode === 'shuffle') {
          do {
            nextIndex = Math.floor(Math.random() * musicQueue.length);
          } while (nextIndex === currentMusicIndex && musicQueue.length > 1); // ç¢ºä¿ä¸é‡è¤‡ï¼Œé™¤éåªæœ‰ä¸€é¦–æ­Œ
          currentMusicIndex = nextIndex;
        } else {
          currentMusicIndex = (currentMusicIndex + 1) % musicQueue.length;
        }
        loadAndPlayCurrentSong();
      }
    }

    function skipToPreviousSong() {
      if (!isMusicReady || !isPlaying) return;

      if (currentPlaylistId) {
        musicPlayer.previousVideo();
      } else if (musicQueue.length > 0) {
        if (playbackMode === 'shuffle') {
          // éš¨æ©Ÿæ¨¡å¼ä¸‹ï¼Œä¸Šä¸€é¦–å°±æ˜¯éš¨æ©Ÿè·³è½‰ï¼Œé€™è£¡ç°¡åŒ–ç‚ºå†éš¨æ©Ÿä¸€æ¬¡
          let prevIndex = currentMusicIndex;
          do {
            prevIndex = Math.floor(Math.random() * musicQueue.length);
          } while (prevIndex === currentMusicIndex && musicQueue.length > 1);
          currentMusicIndex = prevIndex;
        } else {
          currentMusicIndex = (currentMusicIndex - 1 + musicQueue.length) % musicQueue.length;
        }
        loadAndPlayCurrentSong();
      }
    }

    function setPlaybackMode(mode) {
      playbackMode = mode;
      localStorage.setItem('playbackMode', mode);
      document.getElementById('modeListLoop').classList.toggle('active', mode === 'listLoop');
      document.getElementById('modeShuffle').classList.toggle('active', mode === 'shuffle');
      if (currentPlaylistId) {
        // æ’­æ”¾æ¸…å–®æ¨¡å¼ä¸‹ï¼Œæ’­æ”¾å™¨è‡ªå·±è™•ç†å¾ªç’°/éš¨æ©Ÿ
        try {
          if (mode === 'shuffle') {
            musicPlayer.setShuffle(true);
            musicPlayer.setLoop(true);
          } else {
            musicPlayer.setShuffle(false);
            musicPlayer.setLoop(true);
          }
        } catch (e) { console.error("Error setting YT playlist mode:", e); }
      }
    }

    function openMusicSettingsModal() {
      document.getElementById('musicSettingsModal').style.display = 'flex';
      setPlaybackMode(playbackMode); // æ›´æ–°æŒ‰éˆ•æ¨£å¼
    }

    function closeMusicSettingsModal() {
      document.getElementById('musicSettingsModal').style.display = 'none';
    }

    function extractVideoId(urlOrId) {
      const regex = /(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?feature=player_embedded&v=|playlist\?list=))([a-zA-Z0-9_-]{11})/;
      const match = urlOrId.match(regex);
      return match ? match[1] : (urlOrId.length === 11 && /^[a-zA-Z0-9_-]{11}$/.test(urlOrId) ? urlOrId : null);
    }

    async function fetchPlaylistVideos(playlistId) {
      let videos = [];
      let nextPageToken = null;
      let count = 0;
      const MAX_VIDEOS = 50; // é™åˆ¶æœ€å¤šæŠ“ 50 é¦–æ­Œ

      while (count < MAX_VIDEOS) {
        let url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${playlistId}&key=${YT_DATA_API_KEY}`;
        if (nextPageToken) {
          url += `&pageToken=${nextPageToken}`;
        }

        try {
          const response = await fetch(url);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          const data = await response.json();

          if (data.items) {
            data.items.forEach(item => {
              if (item.snippet && item.snippet.resourceId && item.snippet.resourceId.videoId && count < MAX_VIDEOS) {
                videos.push({
                  id: item.snippet.resourceId.videoId,
                  title: item.snippet.title.replace(/<.*?>/g, ''), // ç§»é™¤å¯èƒ½çš„ HTML æ¨™ç±¤
                  source: 'YouTube Playlist'
                });
                count++;
              }
            });
          }

          nextPageToken = data.nextPageToken;
          if (!nextPageToken || count >= MAX_VIDEOS) break;

        } catch (error) {
          console.error("Error fetching playlist:", error);
          return null;
        }
      }
      return videos.length > 0 ? videos : null;
    }

    function loadAndPlayCurrentSong() {
      if (currentMusicIndex < 0 || currentMusicIndex >= musicQueue.length) {
        console.error(getTranslation('alert_play_index_error'));
        stopMusic();
        return;
      }
      const currentSong = musicQueue[currentMusicIndex];
      currentPlaylistId = null;
      pendingPlaylistId = null;
      musicPlayer.loadVideoById(currentSong.id, 0);
      document.getElementById('musicControlsContainer').style.display = 'flex';
      isPlaying = true;
      updatePlayPauseButton(true);
      updateMediaSession(currentSong.title);
    }

    /* ===== æ ¸å¿ƒä¿®æ­£ï¼šé»æ­Œé‚è¼¯ä¿®æ­£ `requestSong` å‡½å¼ (ä¿æŒä¸è®Š) ===== */
    async function requestSong() {
      const input = prompt(getTranslation('request_btn') + "\n" + getTranslation('music_mode_hint', 'ï¼ˆä¾‹å¦‚ï¼šå½±ç‰‡ID: dQw4w9WgXcQï¼Œæˆ–æ’­æ”¾æ¸…å–®ç¶²å€ï¼Œæˆ–é—œéµå­—ï¼‰'));
      if (!input) return;

      const isPlaylistRequest = input.includes('list=');
      let possibleId = extractVideoId(input);

      if (isPlaylistRequest) {
        let listId = null;
        try {
          const params = new URLSearchParams(input.split('?')[1] || '');
          listId = params.get('list') || possibleId;
          // æœ‰æ™‚ ID æœƒèª¤åˆ¤ç‚ºå½±ç‰‡ IDï¼Œä½†æ¸…å–®å„ªå…ˆ
        } catch (e) {
          listId = possibleId;
        }

        if (!listId) {
          alert(getTranslation('alert_invalid_playlist'));
          return;
        }
        if (currentPlaylistId === listId) {
          alert(getTranslation('alert_playlist_playing'));
          return;
        }

        // æª¢æŸ¥æ’­æ”¾å™¨æ˜¯å¦æ­£åœ¨å¿™ç¢Œ (æ­£åœ¨æ’­æ”¾å–®æ›²æˆ–æ¸…å–®)
        const isPlayerBusy = isPlaying && (musicPlayer.getPlayerState() === YT.PlayerState.PLAYING || musicPlayer.getPlayerState() === YT.PlayerState.PAUSED);

        if (isPlayerBusy) {
            // å¦‚æœæ’­æ”¾å™¨å¿™ç¢Œï¼Œå‰‡å°‡æ’­æ”¾æ¸…å–®è¦–ç‚ºç­‰å¾…æ¸…å–®
            pendingPlaylistId = listId;
            alert(getTranslation('alert_fetching_playlist'));
            showMusicQueueStatusModal();
            return;
        }


        // æ’­æ”¾æ¸…å–®æ¨¡å¼
        alert(getTranslation('alert_fetching_playlist'));
        pendingPlaylistId = listId;
        showMusicQueueStatusModal(); // é¡¯ç¤ºè¼‰å…¥ä¸­çš„ç‹€æ…‹

        // æª¢æŸ¥æ¸…å–®æ˜¯å¦å­˜åœ¨ (ä½¿ç”¨ search API æª¢æŸ¥) - è¼ƒè€—è²» API é…é¡ï¼Œæ•…çœç•¥ï¼Œç›´æ¥å˜—è©¦è¼‰å…¥æ’­æ”¾å™¨
        
        try {
            musicPlayer.loadPlaylist({
                list: listId,
                listType: 'playlist',
                index: 0,
                startSeconds: 0
            });
            // ç”±æ–¼ YouTube API çš„é™åˆ¶ï¼Œç„¡æ³•ç›´æ¥å¾ loadPlaylist å–å¾—å½±ç‰‡æ¨™é¡Œï¼Œæ‰€ä»¥æˆ‘å€‘éœ€è¦å¾ŒçºŒ API å‘¼å«
            currentPlaylistId = listId;
            currentMusicIndex = -1;
            musicQueue = [];
            document.getElementById('musicControlsContainer').style.display = 'flex';
            isPlaying = true;
            updatePlayPauseButton(true);
            
            // è¨­ç½®æ’­æ”¾æ¨¡å¼
            setPlaybackMode(playbackMode);

            // å˜—è©¦ç²å–æ¸…å–®æ¨™é¡Œ (éåŒæ­¥)
            await fetchPlaylistVideosAndSetQueue(listId);
        } catch (error) {
            console.error("Error loading playlist:", error);
            alert(getTranslation('alert_no_playlist_found'));
            stopMusic();
        }
        pendingPlaylistId = null;
        showMusicQueueStatusModal(); // æ›´æ–°æˆ–é—œé–‰
      } else {
        // å–®æ›²æ¨¡å¼
        let videoId = possibleId;
        if (!videoId) {
          alert(getTranslation('alert_invalid_playlist'));
          return;
        }

        // å˜—è©¦ç²å–å–®æ›²è³‡è¨Š (éåŒæ­¥)
        try {
          const response = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${videoId}&key=${YT_DATA_API_KEY}`);
          const data = await response.json();
          if (data.items.length === 0) {
            alert(getTranslation('alert_invalid_playlist'));
            return;
          }
          const videoTitle = data.items[0].snippet.title.replace(/<.*?>/g, '');

          // å°‡å–®æ›²åŠ å…¥æ’­æ”¾åˆ—è¡¨
          const newSong = { id: videoId, title: videoTitle, source: 'Single Request' };
          musicQueue.push(newSong);
          
          if (!isPlaying) {
            currentMusicIndex = musicQueue.length - 1;
            loadAndPlayCurrentSong();
          } else if (currentPlaylistId) {
            // å¦‚æœæ­£åœ¨æ’­æ”¾æ’­æ”¾æ¸…å–®ï¼Œå‰‡åœæ­¢æ¸…å–®ï¼Œæ’­æ”¾å–®æ›²
            currentMusicIndex = musicQueue.length - 1;
            loadAndPlayCurrentSong();
          } else {
            alert(`å·²å°‡ã€Œ${videoTitle}ã€åŠ å…¥å¾…æ’­æ¸…å–®ã€‚`);
          }
          showMusicQueueStatusModal(); // æ›´æ–°æˆ–é—œé–‰
        } catch (error) {
          console.error("Error fetching single video info:", error);
          alert(getTranslation('alert_invalid_playlist'));
        }
      }
    }
    
    // ç²å–æ¸…å–®æ‰€æœ‰å½±ç‰‡çš„è³‡è¨Š
    async function fetchPlaylistVideosAndSetQueue(playlistId) {
        const videos = await fetchPlaylistVideos(playlistId);
        if (videos) {
            musicQueue = videos;
            // æ›´æ–°åª’é«”è³‡è¨Šï¼Œä½¿ç”¨æ¸…å–®ä¸­çš„ç¬¬ä¸€é¦–æ­Œ
            if (musicQueue.length > 0) {
                updateMediaSession(musicQueue[0].title);
            }
        }
        pendingPlaylistId = null;
        showMusicQueueStatusModal(); // å†æ¬¡å‘¼å«ä»¥æ›´æ–°ç‹€æ…‹
    }


    function showMusicQueueStatusModal() {
        const queueContentDiv = document.getElementById('queueListContent');
        let content = '';
        
        if (currentPlaylistId) {
            // æ’­æ”¾æ¸…å–®æ¨¡å¼
            const modeText = playbackMode === 'shuffle' ? getTranslation('mode_shuffle') : getTranslation('mode_list_loop');
            let idx = -1;
            try {
                idx = musicPlayer.getPlaylistIndex();
            } catch (e) {}

            content += `<h4 style="color:#0078d7; margin-bottom:5px;">${getTranslation('queue_playlist_info', currentPlaylistId)}</h4>`;
            
            if (musicQueue.length > 0) {
                content += `<p style="color:#fff; font-size:13px; margin:8px 0 6px;">
                    ${getTranslation('queue_total', musicQueue.length, idx !== -1 ? idx + 1 : 'N/A', modeText)}
                </p>`;
                
                content += `<ul class="modal-list" style="list-style:none; padding:0; margin:0;">`;
                musicQueue.forEach((item, index) => {
                    const isActive = index === idx;
                    content += `
                    <li class="queue-item" style="background:${isActive ? 'rgba(0,120,215,0.2)' : 'transparent'};">
                        <button style="background-color:#444; color:#fff; border:0; padding:4px 8px; border-radius:4px; cursor:pointer;" onclick="playPlaylistAtIndex(${index})">
                            ${getTranslation('queue_mode_index', index)}
                        </button>
                        <div class="title">${(item && item.title) ? escapeHtml(item.title) : item.id}</div>
                        <div class="meta">ID:${item.id}</div>
                    </li>`;
                });
                content += '</ul>';
            } else if (pendingPlaylistId) {
                content += `<p style="color:#d70000; font-size:13px; margin-top:10px; padding:8px; border:1px dashed #d70000; border-radius:4px; text-align:center;">
                    ${getTranslation('queue_playlist_pending', pendingPlaylistId)}
                </p>`;
            } else {
                content += `<p style="color:#aaa; font-size:13px; text-align:center;">${getTranslation('alert_fetching_playlist')}</p>`;
            }

        } else if (musicQueue.length > 0) {
            // å–®æ›²æ¸…å–®æ¨¡å¼
            const modeText = playbackMode === 'shuffle' ? getTranslation('mode_shuffle') : getTranslation('mode_list_loop');
            const idx = currentMusicIndex;

            content += `<h4 style="color:#0078d7; margin-bottom:5px;">${getTranslation('queue_current')}</h4>`;
            content += `<ul class="modal-list" style="list-style:none; padding:0; margin:0;">`;
            musicQueue.forEach((item, index) => {
                const isActive = index === idx;
                content += `
                <li class="queue-item" style="background:${isActive ? 'rgba(0,120,215,0.2)' : 'transparent'};">
                    <button style="background-color:#444; color:#fff; border:0; padding:4px 8px; border-radius:4px; cursor:pointer;" onclick="playQueueAtIndex(${index})">
                        ${getTranslation('queue_mode_index', index)}
                    </button>
                    <div class="title">${(item && item.title) ? escapeHtml(item.title) : item.id}</div>
                    <div class="meta">ID:${item.id}</div>
                </li>`;
            });
            content += '</ul>';
        } else {
            if (pendingPlaylistId) {
                content += `<p style="color:#d70000; font-size:13px; margin-top:10px; padding:8px; border:1px dashed #d70000; border-radius:4px; text-align:center;">
                    ${getTranslation('queue_playlist_pending', pendingPlaylistId)}
                </p>`;
            }
            content += `<p style="color:#aaa; font-size:14px; text-align:center;">${getTranslation('queue_empty_queue')}</p>`;
        }
        
        queueContentDiv.innerHTML = content;
        document.getElementById('musicQueueModal').style.display = 'flex';
    }

    function closeMusicQueueModal() {
      document.getElementById('musicQueueModal').style.display = 'none';
    }

    function playPlaylistAtIndex(index) {
      if (!currentPlaylistId) return;
      try {
        musicPlayer.playVideoAt(index);
      } catch (e) {
        musicPlayer.playVideo();
      }
    }

    function playQueueAtIndex(index) {
      if (currentPlaylistId) return;
      if (index >= 0 && index < musicQueue.length) {
        currentMusicIndex = index;
        loadAndPlayCurrentSong();
      }
    }

  </script>
</body>
</html>
