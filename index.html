
<!DOCTYPE html>
<html lang="zh-TW" id="htmlLang">
<head>
  <meta charset="utf-8" />
  <title id="pageTitle">å°ç£å³æ™‚ç›´æ’­å¤šåˆ†å‰²ç›£çœ‹</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* ---------------------------------------------------------------------- */
    /* CSS æ¨£å¼ */
    /* ---------------------------------------------------------------------- */
    html,body{
      height:100%;
      margin:0; padding:0; background:#000;
      font-family: system-ui, sans-serif; color:#fff; overflow:hidden;
    }

    /* åº•éƒ¨æ§åˆ¶åˆ— */
    .controls{
      position:fixed;
      bottom:0; left:0; width:100%; height:78px;
      background:rgba(12,12,12,0.95); color:#fff; padding:8px 12px;
      box-sizing:border-box; display:flex; flex-direction:row; align-items:center;
      gap:10px; z-index:3000;
    }
    
    /* ä¿®æ­£ï¼šæ§åˆ¶æŒ‰éˆ•å®¹å™¨ - ç¢ºä¿ 3x3 æŒ‰éˆ•å…¨éƒ¨å¯è¦‹ä¸”åœ¨æœ€ä¸Šå±¤ */
    #camSelectButtons {
      display: flex;
      flex-wrap: nowrap; /* ç¦æ­¢æ›è¡Œ */
      overflow-x: auto;
      gap: 5px;
      flex-shrink: 0;
      min-width: 0;
      z-index: 5000;
      position: relative;
      background-color: rgba(12,12,12,1);
      box-shadow: 2px 0 5px rgba(0,0,0,0.5);
      align-items: center;
      padding-right: 5px;
      scrollbar-width: none;
    }
    #camSelectButtons::-webkit-scrollbar { display: none; }

    .controls button{
      background-color:#222; color:#fff; border:1px solid #444;
      padding:8px 12px; font-size:13px; cursor:pointer;
      border-radius:6px;
      height:40px; flex-shrink:0; white-space:nowrap; text-align:center;
    }
    .controls button.active{ background-color:#0078d7; border-color:#0078d7; }
    
    .divider{ width:1px; height:60%;
      background:#333; flex-shrink:0; margin:0;
    }

    /* ç¸£å¸‚ / æ™¯é»å®¹å™¨ï¼ˆå¯å·¦å³æ»¾å‹•ï¼‰ */
    #regionButtons{
      display:flex;
      flex-grow:2;
      min-width:0; gap:6px;
      overflow-x:auto; padding-bottom:6px; height:100%; align-items:center;
    }
    #regionButtons::-webkit-scrollbar{ height:6px; background-color:rgba(255,255,255,0.06); }
    #regionButtons::-webkit-scrollbar-thumb{ background-color:#444; border-radius:3px; }
    
    .region-label{ color:#fff; margin:0 8px 0 4px; font-weight:600; flex-shrink:0; user-select:none; }
    
    /* é€šç”¨åŸå¸‚/æ™¯é»æŒ‰éˆ•æ¨£å¼ */
    #regionButtons .city-btn, #regionButtons .stream-btn, #regionButtons .back-btn{
      background-color:#111;
      color:#fff; border:1px solid #555;
      padding:6px 10px; margin:0;
      border-radius:6px; cursor:pointer;
      height:36px; flex-shrink:0; font-size:13px;
    }
    #regionButtons .city-btn:hover, #regionButtons .stream-btn:hover, #regionButtons .back-btn:hover{
        background-color:#1a1a1a; border-color:#666;
    }
    /* æ™¯é»æŒ‰éˆ•å¾®èª¿æ¨£å¼ */
    #regionButtons .stream-btn{ background-color: #222; border-color: #444; }
    /* è¿”å›æŒ‰éˆ•æ¨£å¼ + é»åœ¨å·¦å´å›ºå®š */
    #regionButtons .back-btn{
        background-color: #555; border-color: #777;
        position: sticky; left: 0; z-index: 2;
    }
    /* ç•¶å‰é¸ä¸­çš„åŸå¸‚æŒ‰éˆ•ï¼Œç”¨æ–¼åŸå¸‚/æ™¯é»åˆ‡æ›ç‹€æ…‹æ¨™è¨˜ */
    #regionButtons .city-btn.active-city{ background-color: #0078d7; border-color: #0078d7; }


    /* å½±ç‰‡èˆå°å››æ ¼ */
    .stage-wrap{
      position:fixed; top:0;
      left:0; width:100vw;
      height:calc(100vh - 78px);
      display:grid; 
      gap:0; z-index:1;
    }
    
    /* é è¨­ 2x2 ä½ˆå±€æ¨£å¼ */
    .stage-wrap.grid-2x2{ grid-template-columns:1fr 1fr; grid-template-rows:1fr 1fr; }
    /* 1x1 ä½ˆå±€æ¨£å¼ */
    .stage-wrap.grid-1x1{ grid-template-columns:1fr; grid-template-rows:1fr; }
    /* 3x3 ä½ˆå±€æ¨£å¼ */
    .stage-wrap.grid-3x3{ grid-template-columns:repeat(3, 1fr); grid-template-rows:repeat(3, 1fr); }
    
    .cell{ position:relative; width:100%; height:100%; overflow:hidden; background:#000; }
    
    /* æ’­æ”¾å™¨å®¹å™¨åŠ iframe */
    .player-container, .player-container iframe{
      position:absolute;
      inset:0; width:100%; height:100%; border:0; display:block;
      object-fit:cover; object-position:center;
      background:black;
      transform: scale(1.65) translateY(-6%);
      pointer-events: none; /* ç¦æ­¢æ»‘é¼ èˆ‡ YouTube iframe äº’å‹• */
    }
    
    .stage-wrap.grid-1x1 .player-container, .stage-wrap.grid-1x1 .player-container iframe{
        transform: scale(1.55) translateY(0%);
    }
    .stage-wrap.grid-3x3 .player-container, .stage-wrap.grid-3x3 .player-container iframe{
        transform: scale(2.6) translateY(-10%);
    }

    /* å¼·åŒ–é®ç½©ä»¥é˜»æ“‹ YouTube UI/Logo/æ¨è–¦ */
    .interaction-shield{
      position:absolute;
      inset:0; z-index:9999; background:transparent;
      pointer-events:auto; cursor:default;
    }
    
    /* éš±è— YouTube Logoã€æ¨è–¦å½±ç‰‡å’Œæ¨™é¡Œ */
    .player-container iframe {
      position: relative;
    }
    
    .player-container iframe::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      z-index: 10000;
      pointer-events: none;
    }
    
    /* ä½¿ç”¨CSSé®ç½©éš±è—YouTube UIå…ƒç´  */
    .player-container {
      overflow: hidden;
    }
    
    /* éš±è—YouTubeæ’­æ”¾å™¨ä¸­çš„å“ç‰Œæ¨™è­˜å’Œæ¨è–¦å…§å®¹ */
    .player-container iframe {
      filter: contrast(1.1) brightness(1.05);
    }
    .label{
      position:absolute; left:8px; right:8px; bottom:8px; display:flex;
      flex-direction:column; align-items:flex-start; padding:6px 8px;
      font-size:14px; color:#fff; background:rgba(0,0,0,0.6); border-radius:6px;
      pointer-events:none; z-index:10000;
    }
    .source-on-screen{ font-size:11px; color:#ccc; margin-top:4px; line-height:1.1; }

    /* é¡¯ç¤ºæ§åˆ¶ */
    .hide-labels .label{ display:none; }
    .fullscreen-active .controls{ display:none; }
    .fullscreen-active .stage-wrap{ height:100vh; }
    .hide-cam-select #camSelectButtons { display: none; }
    
    @media (max-width:640px){
      .controls{ padding:6px 8px; height:80px; }
      .controls button{ padding:6px 8px; font-size:12px; height:36px; }
      #regionButtons .city-btn, #regionButtons .stream-btn, #regionButtons .back-btn{
        padding:6px 8px; font-size:12px; height:34px;
      }
    }
    
    /* éŸ³æ¨‚æ§åˆ¶å€å¡Š */
    .music-controls-container { display: none; flex-shrink: 0; height: 100%; align-items: center; }
    .music-controls { display: flex; gap: 5px; }
    .music-controls button {
        background-color: #222; color: #fff; border: 1px solid #444;
        border-radius: 6px; cursor: pointer; height: 40px; width: 40px;
        padding: 0; font-size: 16px; line-height: 1; flex-shrink: 0;
        display: flex; align-items: center; justify-content: center;
    }
    
    /* å½ˆçª—æ¨£å¼ */
    .modal-list { max-height: 320px; overflow-y: auto; padding-right: 6px; }
    .queue-item { display:flex; align-items:center; gap:8px; padding:6px 4px; border-radius:4px; }
    .queue-item .title { flex:1; font-size:13px; color:#fff; word-break:break-word; }
    .queue-item .meta { font-size:12px; color:#888; margin-left:8px; }
    
    .modal-backdrop{
        display:none;
        position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999;
        justify-content:center; align-items:center;
    }
    .modal-content{
        background:#222; padding:20px;
        border-radius:10px; box-shadow:0 0 20px rgba(0,0,0,0.5); 
        width:350px; max-width:90%;
    }
    .modal-content h3{ margin-top:0; color:#fff; text-align:center; }
    .modal-content button.close-btn{
        background-color:#444; border:1px solid #666; color:#fff; margin-top:15px;
        padding:8px 12px; border-radius:6px; cursor:pointer;
    }
    .modal-content button.mode-btn, .modal-content button.grid-btn, .modal-content button.lang-btn{
        background-color:#0078d7; border:1px solid #0078d7; color:#fff;
        padding:10px 15px; border-radius:6px; cursor:pointer; flex:1; font-size: 13px;
    }
    .modal-content button.mode-btn.active, .modal-content button.grid-btn.active, .modal-content button.lang-btn.active {
        background-color: #0056a3; border-color: #0056a3;
    }
    .modal-content button.stop-btn{
        background-color:#d70000; border:1px solid #d70000; color:#fff; margin-top:20px;
        padding:10px 15px; border-radius:6px; cursor:pointer; width:100%;
    }

    /* ========================================= */
    /* æ–°å¢ï¼šè¿·ä½ åœ°åœ–æ¨£å¼ */
    /* ========================================= */
    .mini-map-overlay {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 60px; /* åœ°åœ–å¯¬åº¦ï¼Œå¯ä¾éœ€æ±‚èª¿æ•´ */
        height: 90px; /* åœ°åœ–é«˜åº¦ï¼Œé…åˆå°ç£ç‹¹é•·æ¯”ä¾‹ */
        z-index: 200; /* åœ¨å½±ç‰‡ä¹‹ä¸Šï¼Œä½†åœ¨æ§åˆ¶é …ä¹‹ä¸‹ */
        opacity: 0.8;
        pointer-events: none; /* è®“æ»‘é¼ ç©¿é€ï¼Œä¸å½±éŸ¿é»æ“Šå½±ç‰‡ */
        transition: opacity 0.3s;
    }
    
    .mini-map-bg {
        width: 100%;
        height: 100%;
        /* ä½¿ç”¨ Wiki æä¾›çš„ SVG ä½œç‚ºèƒŒæ™¯ */
        background-image: url('https://upload.wikimedia.org/wikipedia/commons/b/bc/Blank_Taiwan_map.svg');
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.8)); /* å¢åŠ é™°å½±è®“è¼ªå»“æ˜é¡¯ */
    }

    .mini-map-dot {
        position: absolute;
        width: 6px;
        height: 6px;
        background-color: #ff0000;
        border: 1px solid #fff;
        border-radius: 50%;
        transform: translate(-50%, -50%); /* è®“å®šä½é»åœ¨åœ“å¿ƒ */
        box-shadow: 0 0 4px #ff0000;
        transition: top 0.5s, left 0.5s; /* é»ç§»å‹•æ™‚æœ‰å‹•ç•«æ•ˆæœ */
    }

    /* éš±è—åœ°åœ–çš„ class */
    .hide-mini-maps .mini-map-overlay {
        display: none;
    }
    
    /* ========================================= */
    /* æµ®å‹•æ­Œè©é¡¯ç¤ºæ¨£å¼ */
    /* ========================================= */
    #lyricsContainer {
        position: fixed;
        bottom: 100px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.85);
        color: #fff;
        padding: 20px 30px;
        border-radius: 15px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        min-width: 300px;
        max-width: 600px;
        z-index: 10000;
        display: none;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(10px);
        cursor: move;
        user-select: none;
    }
    
    #lyricsContainer.show {
        display: block;
    }
    
    #lyricsHeader {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    #lyricsTitle {
        font-size: 14px;
        font-weight: bold;
        color: #ccc;
        flex: 1;
    }
    
    #lyricsControls {
        display: flex;
        gap: 5px;
    }
    
    #lyricsControls button {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        width: 28px;
        height: 28px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0;
    }
    
    #lyricsControls button:hover {
        background: rgba(255, 255, 255, 0.2);
    }
    
    #lyricsContent {
        font-size: 18px;
        line-height: 1.6;
        text-align: center;
        min-height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        word-break: break-word;
        white-space: pre-wrap;
    }
    
    #lyricsContent.empty {
        color: #888;
        font-style: italic;
    }
    
    #lyricsInputModal {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.8);
        z-index: 20000;
        justify-content: center;
        align-items: center;
    }
    
    #lyricsInputContent {
        background: #222;
        padding: 20px;
        border-radius: 10px;
        width: 500px;
        max-width: 90%;
        max-height: 80vh;
        overflow-y: auto;
    }
    
    #lyricsInputContent h3 {
        margin-top: 0;
        color: #fff;
    }
    
    #lyricsTextarea {
        width: 100%;
        min-height: 200px;
        background: #333;
        color: #fff;
        border: 1px solid #555;
        border-radius: 6px;
        padding: 10px;
        font-size: 14px;
        font-family: inherit;
        resize: vertical;
        box-sizing: border-box;
    }
    
    #lyricsInputContent .button-group {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }
    
    #lyricsInputContent button {
        flex: 1;
        padding: 10px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
    }
    
    .hide-lyrics #lyricsContainer {
        display: none !important;
    }
    
  </style>
</head>
<body class="hide-cam-select" id="pageBody"> 
  <div class="controls" id="controls">
    <div id="camSelectButtons">
      <button id="select-cam-0" class="active" onclick="selectCam(0)">å·¦ä¸Š</button>
      <button id="select-cam-1" onclick="selectCam(1)">å³ä¸Š</button>
      <button id="select-cam-2" onclick="selectCam(2)">å·¦ä¸‹</button>
      <button id="select-cam-3" onclick="selectCam(3)">å³ä¸‹</button>
    </div>

    <div class="divider"></div>

    <div id="regionButtons" aria-label="ç¸£å¸‚èˆ‡æ™¯é»é¸å–®" role="toolbar"></div>

    <div class="divider"></div>
    <button id="fullscreenBtn" onclick="toggleFullscreen()">å…¨è¢å¹•</button>

    <div class="divider"></div>
    <button id="settingsBtn" onclick="openMainSettingsModal()" title="ç•«é¢åˆ†å‰²ã€èªè¨€èˆ‡æ¨™ç±¤è¨­å®š">âš™ï¸ è¨­å®š</button>

   
    <div class="divider"></div>
    <button id="muteBtn" onclick="toggleMute()">éœéŸ³</button>

    <div class="divider"></div>
    <button id="requestBtn" onclick="requestSong()" title="è¼¸å…¥ç¶²å€/IDé»æ­Œæˆ–æ’­æ”¾æ¸…å–®">ğŸ¶ é»æ­Œ/æ¸…å–®</button>

    <div class="divider"></div>
    <button id="lyricsToggleBtn" onclick="toggleLyrics()" title="é¡¯ç¤º/éš±è—æ­Œè©">ğŸ“ æ­Œè©</button>

    <div id="musicControlsContainer" class="music-controls-container">
      <div class="music-controls">
        <button id="prevSongBtn" onclick="skipToPreviousSong()" title="ä¸Šä¸€é¦–">â®ï¸</button>
        <button id="playPauseBtn" onclick="playPauseSong()" title="æ’­æ”¾/æš«åœ">â¸ï¸</button>
        <button id="nextSongBtn" onclick="skipToNextSong()" title="ä¸‹ä¸€é¦–">â­ï¸</button>
        <button id="modeBtn" onclick="openMusicSettingsModal()" title="æ¨¡å¼è¨­å®š">ğŸ”„</button>
        <button id="playlistQueueBtn" onclick="showMusicQueueStatusModal()" title="æŸ¥çœ‹æ’­æ”¾åˆ—è¡¨ç‹€æ…‹">ğŸµ</button>
      </div>
    </div>
 
  </div>

 
  <div class="stage-wrap grid-2x2" id="stageWrap">
    <div class="cell" data-index="0">
      <div id="player0" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap0">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot0" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label0">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="1">
      <div id="player1" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap1">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot1" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label1">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="2">
      <div id="player2" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap2">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot2" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label2">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="3">
      <div id="player3" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap3">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot3" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label3">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="4" style="display:none;">
      <div id="player4" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap4">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot4" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label4">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="5" style="display:none;">
      <div id="player5" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap5">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot5" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label5">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="6" style="display:none;">
      <div id="player6" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap6">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot6" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label6">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="7" style="display:none;">
      <div id="player7" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap7">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot7" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label7">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>

    <div class="cell" data-index="8" style="display:none;">
      <div id="player8" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="mini-map-overlay" id="miniMap8">
          <div class="mini-map-bg"></div>
          <div class="mini-map-dot" id="mapDot8" style="top:50%; left:50%;"></div>
      </div>
      <div class="label" id="label8">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
  </div>
    
  <script>
      const PLAYER_IDS = ['player0', 'player1', 'player2', 'player3', 'player4', 'player5', 'player6', 'player7', 'player8'];
      const LABEL_IDS = ['label0', 'label1', 'label2', 'label3', 'label4', 'label5', 'label6', 'label7', 'label8'];
      const CELLS = document.querySelectorAll('.stage-wrap .cell');
  </script>


  <div id="player_music_container" style="position:fixed; top:-100px; left:-100px; width:1px; height:1px; overflow:hidden;">
    <div id="player_music"></div>
  </div>

  <div id="mainSettingsModal" class="modal-backdrop">
    <div class="modal-content" style="width:400px; max-width:90%;">
        <h3 id="settingsTitle">âš™ï¸ ç¨‹å¼è¨­å®š</h3>
        
        <div style="margin-top:20px; padding:10px; border:1px solid #444; border-radius:6px;">
            <p id="gridSizeLabel" style="color:#fff; font-weight:bold; margin:0 0 10px;">ç•«é¢åˆ†å‰²æ¨¡å¼ï¼š</p>
            <div style="display:flex; justify-content:space-around; gap:10px;">
                <button id="grid1x1Btn" class="grid-btn" onclick="setGridSize('1x1')">1x1 (å–®ç•«é¢)</button>
                <button id="grid2x2Btn" class="grid-btn active" onclick="setGridSize('2x2')">2x2 (å››åˆ†å‰²)</button>
                <button id="grid3x3Btn" class="grid-btn" onclick="setGridSize('3x3')">3x3 (ä¹åˆ†å‰²)</button>
            </div>
            <p style="font-size:12px; color:#888; margin:10px 0 0;" id="gridSizeHint">æ›´æ”¹åˆ†å‰²æ¨¡å¼å°‡é‡è¨­æ‰€æœ‰ç•«é¢ã€‚</p>
        </div>

        <div style="margin-top:20px; padding:10px; border:1px solid #444; border-radius:6px;">
            <p id="languageLabel" style="color:#fff; font-weight:bold; margin:0 0 10px;">èªè¨€é¸æ“‡ï¼š</p>
            <select id="languageSelect" onchange="setLanguage(this.value)" style="width:100%; padding:10px; background-color:#333; color:#fff; border:1px solid #555; border-radius:6px; font-size:14px; cursor:pointer;">
                <option value="zh-TW">æ­£é«”ä¸­æ–‡ (ç¹é«”ä¸­æ–‡)</option>
                <option value="zh-CN">ç®€ä½“ä¸­æ–‡ (ç°¡é«”ä¸­æ–‡)</option>
                <option value="en-US">English (US)</option>
                <option value="en-GB">English (UK)</option>
                <option value="ja-JP">æ—¥æœ¬èª (æ—¥æ–‡)</option>
                <option value="ko-KR">í•œêµ­ì–´ (éŸ“æ–‡)</option>
                <option value="th-TH">à¹„à¸—à¸¢ (æ³°æ–‡)</option>
                <option value="vi-VN">Tiáº¿ng Viá»‡t (è¶Šå—æ–‡)</option>
                <option value="it-IT">Italiano (ç¾©å¤§åˆ©æ–‡)</option>
            </select>
        </div>

        <div style="margin-top:20px; padding:10px; border:1px solid #444; border-radius:6px; display:flex; justify-content:space-between; align-items:center;">
            <p id="labelsToggleLabel" style="color:#fff; font-weight:bold; margin:0;">ç•«é¢æ¨™ç±¤é¡¯ç¤ºï¼š</p>
            <button id="labelsToggleInModalBtn" onclick="toggleLabels()">æ¨™ç±¤éš±è—</button>
        </div>
        
        <div style="margin-top:10px; padding:10px; border:1px solid #444; border-radius:6px; display:flex; justify-content:space-between; align-items:center;">
            <p id="mapsToggleLabel" style="color:#fff; font-weight:bold; margin:0;">å°åœ°åœ–é¡¯ç¤ºï¼š</p>
            <button id="mapsToggleBtn" onclick="toggleMiniMaps()">åœ°åœ–é–‹å•Ÿ</button>
        </div>

        <button onclick="closeMainSettingsModal()" class="close-btn" style="width:100%;">é—œé–‰è¨­å®š</button>
    </div>
  </div>


  <div id="musicSettingsModal" class="modal-backdrop">
    <div class="modal-content" style="width:300px; max-width:90%; text-align:center;">
      <h3 id="musicModeTitle" style="margin-top:0; color:#fff;">éŸ³æ¨‚æ’­æ”¾æ¨¡å¼</h3>
      <p id="musicModeHint" style="font-size:12px; color:#aaa;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æ’­æ”¾æ¨¡å¼ï¼š</p>
      <div style="display:flex; justify-content:space-around; gap:10px; margin-top:15px;">
        <button id="modeListLoop" class="mode-btn" onclick="setPlaybackMode('listLoop')">ğŸ”„ åˆ—è¡¨å¾ªç’°</button>
        <button id="modeShuffle" class="mode-btn" onclick="setPlaybackMode('shuffle')">ğŸ”€ éš¨æ©Ÿæ’­æ”¾</button>
      </div>
      <button id="modeStopBtn" onclick="stopAndCloseModal()" class="stop-btn">â¹ï¸ åœæ­¢ä¸¦çµæŸæ’­æ”¾</button>
      <button id="musicModeCloseBtn" onclick="closeMusicSettingsModal()" class="close-btn">é—œé–‰</button>
    </div>
  </div>

  <div id="musicQueueModal" class="modal-backdrop">
    <div class="modal-content" style="width:350px; max-width:90%;">
      <h3 id="queueTitle" style="margin-top:0; color:#fff; text-align:center;">ğŸ¶ æ’­æ”¾åˆ—è¡¨ç‹€æ…‹</h3>
      <div id="queueListContent" style="margin-bottom:15px; padding-right:5px;"></div>
      <button id="queueCloseBtn" onclick="closeMusicQueueModal()" style="margin-top:10px;">é—œé–‰</button>
    </div>
  </div>

  <!-- æµ®å‹•æ­Œè©é¡¯ç¤ºå®¹å™¨ -->
  <div id="lyricsContainer">
    <div id="lyricsHeader">
      <span id="lyricsTitle">æ­Œè©</span>
      <div id="lyricsControls">
        <button id="lyricsMinimizeBtn" onclick="minimizeLyrics()" title="æœ€å°åŒ–">â–</button>
        <button id="lyricsCloseBtn" onclick="toggleLyrics()" title="é—œé–‰">âœ•</button>
      </div>
    </div>
    <div id="lyricsContent" class="empty">ç­‰å¾…æ’­æ”¾æ­Œæ›²...</div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    /* ===== ç›´æ’­ä¾†æº ===== */
    const ALL_STREAMS = {
      "å°åŒ—-è±¡å±±çœ‹101": {"id":"z_fY1pj1VBw","label":"å°åŒ—è±¡å±±","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-å¤§ç¨»åŸ•": {"id":"Ndo_8RuefH4","label":"å¤§ç¨»åŸ•","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-ç¢§å±±å·–": {"id":"uvwfYzwY8tg","label":"ç¢§å±±å·–","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-å¾®é¢¨å¹³å°": {"id":"34h_Cy_n0Ok","label":"å¾®é¢¨å¹³å°","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-è²“ç©ºæŒ‡å—å®®": {"id":"215ahZ_0rTg","label":"è²“ç©ºæŒ‡å—å®®","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-æ“å¤©å²¡è‰åŸ": {"id":"yF2LAyOvq0Q","label":"æ“å¤©å²¡è‰åŸ","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-é™½æ˜æ›¸å±‹": {"id":"RttyIGHbN_w","label":"é™½æ˜æ›¸å±‹","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-é çœºä¸ƒæ˜Ÿå±±": {"id":"PvJr2efA6n0","label":"é çœºä¸ƒæ˜Ÿå±±","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-äºŒåªå­åœè»Šå ´": {"id":"d9KuXrPCWYU","label":"äºŒåªå­åœè»Šå ´","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-å¤§å±¯è‡ªç„¶å…¬åœ’": {"id":"6ghffcNt3Nw","label":"å¤§å±¯è‡ªç„¶å…¬åœ’","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-å°æ²¹å‘åœè»Šå ´": {"id":"kKD-ZBLs8-4","label":"å°æ²¹å‘åœè»Šå ´","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "å°åŒ—-å†·æ°´å‘åœè»Šå ´": {"id":"GB64WeZZQPQ","label":"å†·æ°´å‘åœè»Šå ´","source":"é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
      "æ–°åŒ—-æ¼äººç¢¼é ­": {"id":"xwAWSh35uuw","label":"æ–°åŒ—æ·¡æ°´","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-é¼»é ­æœå‹™å€": {"id":"MD4Qb1bJFXE","label":"æ–°åŒ—é¼»é ­","source":"necoast nsa"},
      "æ–°åŒ—-ä¸­è§’ç£": {"id":"mmM9NOZLLKY","label":"ä¸­è§’ç£","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "æ–°åŒ—-ååˆ†ç€‘å¸ƒå…¬åœ’": {"id":"HirBQsQEUeA","label":"ååˆ†ç€‘å¸ƒå…¬åœ’","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-ä¹ä»½": {"id":"XSD5ptYisw8","label":"æ–°åŒ—ä¹ä»½","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-å…§æ´åœ‹å®¶æ£®æ—éŠæ¨‚å€": {"id":"lX2MYEFomK0","label":"å…§æ´åœ‹å®¶æ£®æ—éŠæ¨‚å€","source":"åœ‹å®¶æ£®æ—éŠæ¨‚å€å³æ™‚å½±åƒ"},
      "æ–°åŒ—-ä¸‰å³½è€è¡—åŒ—æ®µ": {"id":"M24SZJU-uoo","label":"ä¸‰å³½è€è¡—åŒ—æ®µ","source":"ä¸‰å³½æ°‘æ¬Šè€è¡—å•†åœˆ"},
      "æ–°åŒ—-ä¸‰å³½è€è¡—å—æ®µ": {"id":"R_5jhoux3nY","label":"ä¸‰å³½è€è¡—å—æ®µ","source":"ä¸‰å³½æ°‘æ¬Šè€è¡—å•†åœˆ"},
      "æ–°åŒ—-çƒä¾†åŠæ©‹": {"id":"jGoYvmTxLyU","label":"çƒä¾†åŠæ©‹","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "æ–°åŒ—-å“¡å±±å­": {"id":"JkGKqXOt9Ls","label":"å“¡å±±å­","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "æ–°åŒ—-æ–‡å±±è¾²å ´å¤§è‰çš®": {"id":"_LRkfObNP_U","label":"æ–‡å±±è¾²å ´å¤§è‰çš®","source":"æ–°åŒ—å¸‚è¾²æœƒæ–‡å±±è¾²å ´"},
      "åŸºéš†-å¤–æœ¨å±±": {"id":"LInNQYAbAwQ","label":"å¤–æœ¨å±±","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "æ–°ç«¹-æˆåŠŸæ¹–": {"id":"Y6xJKj8k2ys","label":"æˆåŠŸæ¹–","source":"åœ‹ç«‹æ¸…è¯å¤§å­¸è¨ˆé€šä¸­å¿ƒå­¸ç§‘çµ„"},
      "æ–°ç«¹-å¤§è‰åª": {"id":"x_FuMf2ke1o","label":"å¤§è‰åª","source":"åœ‹ç«‹æ¸…è¯å¤§å­¸è¨ˆé€šä¸­å¿ƒå­¸ç§‘çµ„"},
      "æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´": {"id":"91PfFoqvuUk","label":"æ¡ƒåœ’æ©Ÿå ´","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´å—è·‘é“": {"id":"y3_x8el5ZJY","label":"TPE å—è·‘é“","source":"Taoyuan Airport"},
      "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´åŒ—è·‘é“": {"id":"wWEnxWA7nnY","label":"TPE åŒ—è·‘é“","source":"Taoyuan Airport"},
      "æ¡ƒåœ’-æ°¸å®‰æ¼æ¸¯": {"id":"tD_a03trUvE","label":"æ°¸å®‰æ¼æ¸¯","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ": {"id":"YkIUZjVlhv4","label":"æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è™é ­å±±ç’°ä¿å…¬åœ’": {"id":"tu_gsIkNt-w","label":"è™é ­å±±ç’°ä¿å…¬åœ’","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å°çƒä¾†å¤©ç©ºæ­¥é“": {"id":"neaiCec1kec","label":"å°çƒä¾†å¤©ç©ºæ­¥é“","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±æ€è¦ªäº­": {"id":"3Za9y4z_Lzc","label":"è§’æ¿å±±æ€è¦ªäº­","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°": {"id":"5YDXZ1aiR5Y","label":"ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å¤§æºªæ©‹": {"id":"oFJ6gCaBb_Q","label":"å¤§æºªæ©‹","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è™é ­å±±å¥§çˆ¾æ£®æ—å­¸å ‚": {"id":"yQSmajHyMhU","label":"å¥§çˆ¾æ£®æ—å­¸å ‚","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±æ¢…åœ’": {"id":"-xT1bZhWLuU","label":"è§’æ¿å±±æ¢…åœ’","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±ç”Ÿæ…‹æ± ": {"id":"XEbo8NzMTbQ","label":"è§’æ¿å±±ç”Ÿæ…‹æ± ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å¤§æºªè€è¡—": {"id":"XUWjAsajKXg","label":"å¤§æºªè€è¡—","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-çŸ³é–€æ°´åº«": {"id":"GUCaVR88ZFU","label":"çŸ³é–€æ°´åº«","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ…ˆæ¹–æ°´å²¸å»£å ´": {"id":"pSQ0e-ZTZ5g","label":"æ…ˆæ¹–æ°´å²¸å»£å ´","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-é˜¿å§†åªè–‘æ¯å³¶": {"id":"EUOp2LchPQM","label":"è–‘æ¯å³¶","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-ä¸Šå·´é™µ": {"id":"nV-DKquUjFs","label":"ä¸Šå·´é™µ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ¡ƒåœ’åœ‹éš›æ©Ÿå ´å‡±æ‚…é…’åº—": {"id":"68GFgzQxrXs","label":"æ©Ÿå ´å‡±æ‚…","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å°çƒä¾†å¯°å®‡å¹³å°": {"id":"PJWye36lEj4","label":"å¯°å®‡å¹³å°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è¨±åæ¸¯æ¿•åœ°": {"id":"44JArbF682k","label":"è¨±åæ¸¯æ¿•åœ°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "å®œè˜­-å¤–æ¾³æ²™ç˜": {"id":"UgoT-QTbYvo","label":"å®œè˜­å¤–æ¾³","source":"necoast nsa"},
      "å®œè˜­-ç¦éš†æµ·æ°´æµ´å ´": {"id":"mMG7v_fET5A","label":"å®œè˜­ç¦éš†","source":"necoast nsa"}, 
      "å®œè˜­-çŸ³åŸæ¼æ¸¯": {"id":"X76Dkt_fPG0","label":"çŸ³åŸæ¼æ¸¯","source":"necoast nsa"}, 
      "å®œè˜­-ç„¡å°¾æ¸¯": {"id":"Bux0vT_5MBw","label":"ç„¡å°¾æ¸¯","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
      "å®œè˜­-çŸ³åŸæ¼æ¸¯": {"id":"ozZVLl0h--A","label":"çŸ³åŸæ¼æ¸¯1","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
      "å®œè˜­-ç¤æºªå¯’æ²é…’åº—": {"id":"cPh2vzrtG_w","label":"ç¤æºªå¯’æ²é…’åº—","source":"ç¤æºªå¯’æ²é…’åº—MU JIAO XI HOTEL"}, 
      "è‹—æ —-æ±¶æ°´éŠå®¢ä¸­å¿ƒ(é›ªéœ¸)": {"id":"VgmWVBUsfGo","label":"æ±¶æ°´éŠå®¢ä¸­å¿ƒ","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "è‹—æ —-è§€éœ§éŠæ†©å€(é›ªéœ¸)": {"id":"Isp6RQiuxNo","label":"è§€éœ§éŠæ†©å€","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "è‹—æ —-é›ªè¦‹éŠæ†©å€(é›ªéœ¸)": {"id":"2KDE860OW_A","label":"é›ªè¦‹éŠæ†©å€","source":"é›ªéœ¸åœ‹å®¶å…¬åœ’ Shei-Pa National Park"},
      "å°ä¸­-é«˜ç¾æ¿•åœ°": {"id":"fjhg3gAnMFg","label":"å°ä¸­é«˜ç¾","source":"å¤§ç©å°ä¸­-è‡ºä¸­è§€å…‰æ—…éŠå±€"},
      "å°ä¸­-æœ›é«˜å¯®": {"id":"lhXXhDyjFtI","label":"æœ›é«˜å¯®","source":"å¤§ç©å°ä¸­-è‡ºä¸­è§€å…‰æ—…éŠå±€"},
      "å½°åŒ–-ç‹åŠŸæ¼æ¸¯": {"id":"ABT9YRFUYXs","label":"å½°åŒ–ç‹åŠŸ","source":"æ„›ç©å½°åŒ– Changhua Travels"},
      "å—æŠ•-åˆæ­¡å±±æ­¦å¶ºäº­": {"id":"2lVMTs_Fj0M","label":"æ­¦å¶ºäº­","source":"å°ç£å³æ™‚å½±åƒç›£è¦–å™¨"},
      "å˜‰ç¾©-å¥®èµ·æ¹–": {"id":"B6eki-0-w0g","label":"å˜‰ç¾©å¥®èµ·æ¹–","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-äºŒå»¶å¹³æ­¥é“": {"id":"j2L_559nCjc","label":"äºŒå»¶å¹³æ­¥é“","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-å¤ªå¹³é›²æ¢¯": {"id":"dY2cRNr5Buw","label":"å¤ªå¹³é›²æ¢¯","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-è§¸å£éŠå®¢ä¸­å¿ƒ": {"id":"8KnqJBf_dow","label":"è§¸å£éŠå®¢ä¸­å¿ƒ","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-æ„›æƒ…å¤§è‰åŸ": {"id":"hMYs60qtkK8","label":"æ„›æƒ…å¤§è‰åŸ","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-ç”ŸåŠ›è¾²å ´": {"id":"agEzlv9n9Eg","label":"ç”ŸåŠ›è¾²å ´","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-é‡Œä½³è³‡è¨Šç«™": {"id":"zDt8FBPozZQ","label":"é‡Œä½³è³‡è¨Šç«™","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°å—-ä¸ƒè‚¡è³é³¥å°": {"id":"5KJe2gCTngA","label":"å°å—ä¸ƒè‚¡","source":"å°æ±Ÿåœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å°å—-åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€": {"id":"FES0gWTFUHQ","label":"åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€","source":"å°æ±Ÿåœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å°å—-æ›¾æ–‡æ°´åº«": {"id":"EH4V8IwFIp4","label":"æ›¾æ–‡æ°´åº«","source":"è¥¿æ‹‰é›…åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°å—-ç«å±±ç¢§é›²å¯º": {"id":"zkX6X9p-6iA","label":"ç«å±±ç¢§é›²å¯º","source":"è¥¿æ‹‰é›…åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
      "é«˜é›„-æ¥ æ¢“è–èˆˆæ©‹": {"id":"1vVCtk5OXVk","label":"æ¥ æ¢“è–èˆˆæ©‹","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "é«˜é›„-èšµå¯®åœ‹å°": {"id":"sKrqs-5Auqo","label":"èšµå¯®åœ‹å°","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "é«˜é›„-æ——æ´¥æµ·æ°´æµ´å ´": {"id":"ka7FV0sCvxQ","label":"æ——æ´¥æµ·æ°´æµ´å ´","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-å£½å±±è§€æ™¯å°": {"id":"C03Itx8iSC0","label":"å£½å±±è§€æ™¯å°","source":"é«˜é›„æ—…éŠç¶²"},
      "é«˜é›„-è“®æ± æ½­": {"id":"BnPoNatG-HE","label":"è“®æ± æ½­","source":"é«˜é›„æ—…éŠç¶²"}, 
      "é«˜é›„-é«˜é›„ç‡ˆå¡”": {"id":"HqrPgNErSOA","label":"é«˜é›„ç‡ˆå¡”","source":"Ship"}, 
      "é«˜é›„-æ——æ´¥æ²™ç˜": {"id":"lh7OdmxRvTg","label":"æ——æ´¥æ²™ç˜","source":"ship"}, 
      "å±æ±-ç¾Œå…‰æ©‹": {"id":"13C8jdbqQcI","label":"ç¾Œå…‰æ©‹","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"}, 
      "å±æ±-å¢¾ä¸å—ç£": {"id":"jUnFuJSj0OU","label":"å¢¾ä¸å—ç£","source":"æˆ‘æ„›å¢¾ä¸æ—…éŠç¥¨åˆ¸ä¸­å¿ƒ"},
      "å±æ±-èˆ¹å¸†çŸ³": {"id":"3Wb_Lgw7Ltc","label":"èˆ¹å¸†çŸ³","source":"å¢¾ä¸åœ‹å®¶å…¬åœ’"}, 
      "å±æ±-èˆ¹å¸†çŸ³æ²™ç˜": {"id":"f8yo_osMxAg","label":"èˆ¹å¸†çŸ³æ²™ç˜ (4K)","source":"å¢¾ä¸åœ‹å®¶å…¬åœ’"},
      "å±æ±-é›€é¯›å…¬å¯“": {"id":"BggLWTcLixM","label":"é›€é¯›å…¬å¯“","source":"å°é›»-å—ç£æµ·åŸŸçŠç‘šè§€æ¸¬è¨ˆç•«"}, 
      "å±æ±-é ‚æµå€": {"id":"oMlSukuxtHw","label":"é ‚æµå€","source":"å°é›»-å—ç£æµ·åŸŸçŠç‘šè§€æ¸¬è¨ˆç•«"}, 
      "å±æ±-è»¸å­”å…¬åœ’": {"id":"2GzIYf-I5kM","label":"è»¸å­”å…¬åœ’","source":"å°é›»-å—ç£æµ·åŸŸçŠç‘šè§€æ¸¬è¨ˆç•«"}, 
      "å±æ±-æ–æ›³å¤§è‰åŸ": {"id":"2dyGcIYbJa8","label":"æ–æ›³å¤§è‰åŸ","source":"å°é›»-å—ç£æµ·åŸŸçŠç‘šè§€æ¸¬è¨ˆç•«"}, 
      "èŠ±è“®-é¦¬å¤ªéæºªå·¦å²¸": {"id":"Ic6hqus0tjA","label":"é¦¬å¤ªéæºªå·¦å²¸","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
      "èŠ±è“®-ä¸ƒæ˜Ÿæ½­": {"id":"j3l32VFi5M8","label":"ä¸ƒæ˜Ÿæ½­","source":"æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"}, 
      "èŠ±è“®-çŸ³æ¢¯åª": {"id":"mXnigLvIL0Q","label":"çŸ³æ¢¯åª","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "èŠ±è“®-å¤§çŸ³é¼»å±±": {"id":"JkoXcXI04Qk","label":"å¤§çŸ³é¼»å±±","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "èŠ±è“®-é•·è™¹æ©‹": {"id":"JnD8Rk3o0BM","label":"é•·è™¹æ©‹","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-é¯‰é­šå±±": {"id":"BUJJaW0vkJs","label":"å°æ±é¯‰é­šå±±","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-é‡‘å´™å¤§æ©‹": {"id":"9QqBz3kNHis","label":"å°æ±é‡‘å´™å¤§æ©‹","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-é‡‘æ¨½è§€æµª": {"id":"q3KJt-SZc2s","label":"å°æ±é‡‘æ¨½è§€æµª","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å¯Œå±±": {"id":"Rsq95SQ26bY","label":"å°æ±å¯Œå±±","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-æ‰åŸç£": {"id":"VqS_Y8ZCj6M","label":"å°æ±æ‰åŸç£","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å¯Œå²¡æ¼æ¸¯": {"id":"D945F_dauls","label":"å°æ±å¯Œå²¡æ¼æ¸¯","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-è¯æºæ›™å…‰è§€æ™¯å°": {"id":"TY4qQElcUrA","label":"å°æ±è¯æºæ›™å…‰è§€æ™¯å°","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å—æ©«åŸ¡å£": {"id":"LSkq-wHMxQY","label":"å°æ±å—æ©«å£","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-æ± ä¸Šå¤©å ‚è·¯": {"id":"6kUEK3LVrro","label":"å°æ±æ± ä¸Šå¤©å ‚è·¯","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å¤šè‰¯è»Šç«™": {"id":"UCG1aXVO8H8","label":"å°æ±å¤šè‰¯","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-é¹¿é‡é«˜å°": {"id":"rvc1klNIgQc","label":"é¹¿é‡é«˜å°","source":"ervnsa"},
      "å°æ±-æˆåŠŸä¸‰ä»™å°": {"id":"dQ7Sd6PGLdA","label":"ä¸‰ä»™å°","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-é‡‘æ¨½éŠæ†©å€": {"id":"ZdqHgQwvZOw","label":"é‡‘æ¨½éŠæ†©å€","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-éƒ½æ­·éŠå®¢ä¸­å¿ƒ": {"id":"JhQuR77AR7U","label":"éƒ½æ­·éŠå®¢ä¸­å¿ƒ","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-åŠ è·¯è˜­éŠæ†©å€": {"id":"AKl3F6cAY2Q","label":"åŠ è·¯è˜­éŠæ†©å€","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶å—å¯®": {"id":"wTHhv7M0vCI","label":"ç¶ å³¶å—å¯®","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶å¸†èˆ¹é¼»": {"id":"pLdBc8PvZko","label":"ç¶ å³¶å¸†èˆ¹é¼»","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶æŸ´å£æµ®æ½›å€": {"id":"a8nJQr5rBGs","label":"ç¶ å³¶æŸ´å£æµ®æ½›å€","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-å¨œè·¯å½é…’åº—": {"id":"Yo64T79w6Vg","label":"å¨œè·¯å½é…’åº—","source":"å¨œè·¯å½åƒ.å–.ç©.æ¨‚"}, 
      "é‡‘é–€-éº’éºŸå±±æ£®æ—å…¬åœ’": {"id":"M4EJtf_iP8s","label":"é‡‘é–€éº’éºŸå±±å…¬åœ’","source":"æ¨‚éŠé‡‘é–€"},
      "é‡‘é–€-134é«˜åœ°": {"id":"-srNHTE-Nf0","label":"é‡‘é–€134é«˜åœ°","source":"æ¨‚éŠé‡‘é–€"},
      "é‡‘é–€-å»ºåŠŸå¶¼": {"id":"uh_yNAE01w8","label":"é‡‘é–€å»ºåŠŸå¶¼","source":"æ¨‚éŠé‡‘é–€"},
      "é¦¬ç¥–-åŒ—ç«¿èˆªç©ºç«™ä¼‘æ¯å®¤": {"id":"EaUVZ49xKQ4","label":"åŒ—ç«¿èˆªç©ºç«™ä¼‘æ¯å®¤","source":"MFKåŒ—ç«¿èˆªç©ºç«™"},
      "å…¶ä»–-è“®è¯å¯ºæ­£æ®¿1": {"id":"Cfh_CpU2KY0","label":"è“®è¯å¯ºæ­£æ®¿1","source":"lifemapäººç”Ÿåœ°åœ–"}, 
      "å…¶ä»–-è“®è¯å¯ºæ­£æ®¿2": {"id":"tQ5L2IMHjpM","label":"è“®è¯å¯ºæ­£æ®¿2","source":"lifemapäººç”Ÿåœ°åœ–"}, 
      "å…¶ä»–-åœ°éœ‡ç›£æ¸¬ç›´æ’­": {"id":"meHTKm4XBS8","label":"åœ°éœ‡ç›£æ¸¬ç›´æ’­","source":"è¯è¦–æ–°è CH52"},
      "å…¶ä»–-æ¾å±±æ©Ÿå ´èˆªç­è³‡è¨Š": {"id":"ZoUCjUtTVxs","label":"æ¾å±±æ©Ÿå ´èˆªç­è³‡è¨Š","source":"TWSkyWave ç©ºä¸­é›»æ³¢"},
      "å…¶ä»–-é«˜é›„æ©Ÿå ´èˆªç­è³‡è¨Š": {"id":"YdiLKafucSo","label":"é«˜é›„æ©Ÿå ´èˆªç­è³‡è¨Š","source":"TWSkyWave ç©ºä¸­é›»æ³¢"},
      "å…¶ä»–-æ¡ƒåœ’æ©Ÿå ´èˆªç­è³‡è¨Š": {"id":"GbvjIBkhOow","label":"æ¡ƒåœ’æ©Ÿå ´èˆªç­è³‡è¨Š","source":"TWSkyWave ç©ºä¸­é›»æ³¢"},
      "å…¶ä»–-æ¡ƒåœ’æ©Ÿå ´ç•«é¢/è³‡è¨Š": {"id":"0D6QgDOdI6c","label":"æ¡ƒåœ’æ©Ÿå ´ç•«é¢/è³‡è¨Š","source":"éŠæ¡ƒåœ’ Taoyuan Travel"}
    };
    /* ---------------------------------------------------------------------- */
    /* JavaScript åŠŸèƒ½ */
    /* ---------------------------------------------------------------------- */
    
    // æ“´å±•åˆ° 9 å€‹æ’­æ”¾å™¨ (æ”¯æ´ 3x3)
    const MAX_PLAYERS = 9;
    const DEFAULT_VIDEO_ID = "215ahZ_0rTg";

    let selectedCamIndex = 0;
    let players = Array(MAX_PLAYERS).fill(null); 
    let streamState = Array(MAX_PLAYERS).fill(null); 
    let isMuted = true;
    let currentCity = null;
    
    // è¨­å®šç›¸é—œè®Šæ•¸
    let currentGridSize = localStorage.getItem('gridSize') || '2x2';
    let isLabelsVisible = !(localStorage.getItem('hideLabels') === 'true'); // é è¨­ç‚ºé¡¯ç¤º
    let currentLang = localStorage.getItem('language') || 'zh-TW';
    // éŸ³æ¨‚æ’­æ”¾å™¨ç›¸é—œè®Šæ•¸
    let musicPlayer = null;
    let musicQueue = [];
    let currentMusicIndex = -1;
    let pendingPlaylistId = null; 
    let playbackMode = localStorage.getItem('playbackMode') || 'listLoop'; 
    let isPlaying = false;
    let isMusicReady = false;
    let currentPlaylistId = null;
    
    // æ­Œè©ç›¸é—œè®Šæ•¸
    let isLyricsVisible = localStorage.getItem('showLyrics') === 'true';
    let currentLyrics = '';
    let lyricsData = null; // å­˜å‚¨æ­Œè¯æ•°æ®ï¼ˆå¯èƒ½åŒ…å«æ—¶é—´è½´ï¼‰
    let lyricsLines = []; // è§£æåçš„æ­Œè¯è¡Œ
    let currentLyricsLineIndex = 0; // å½“å‰æ˜¾ç¤ºçš„æ­Œè¯è¡Œç´¢å¼•
    let lyricsUpdateInterval = null; // æ­Œè¯æ›´æ–°å®šæ—¶å™¨
    let currentSongTitle = ''; // å½“å‰æ­Œæ›²æ ‡é¢˜
    let lyricsPosition = JSON.parse(localStorage.getItem('lyricsPosition') || '{"x": 50, "y": 20}'); // ç™¾åˆ†æ¯”ä½ç½®
    let isLyricsMinimized = false;
    let isDraggingLyrics = false;
    let dragStartPos = { x: 0, y: 0 };

    let lastReloadAt = Array(MAX_PLAYERS).fill(0); 
    let isReloading = Array(MAX_PLAYERS).fill(false); 
    const RELOAD_COOLDOWN_MS = 60000;
    // YouTube Data API key
    const YT_DATA_API_KEY = 'AIzaSyCwW3oAnY8rqIgL-kK9yGCxb7pNsvbvIz4';
    // åŸå¸‚åˆ†çµ„
    const GROUPED_STREAMS = {};
    Object.keys(ALL_STREAMS).forEach(key => {
      const city = key.split('-')[0];
      if (!GROUPED_STREAMS[city]) GROUPED_STREAMS[city] = [];
      GROUPED_STREAMS[city].push({ key: key, ...ALL_STREAMS[key] });
    });
    const REGION_GROUPS = {
      'åŒ—éƒ¨': ['å°åŒ—', 'æ–°åŒ—', 'åŸºéš†', 'æ¡ƒåœ’', 'å®œè˜­', 'æ–°ç«¹'],
      'ä¸­éƒ¨': ['è‹—æ —', 'å°ä¸­', 'å½°åŒ–', 'å—æŠ•', 'é›²æ—'],
      'å—éƒ¨': ['å˜‰ç¾©', 'å°å—', 'é«˜é›„', 'å±æ±', 'æ¾æ¹–'],
      'æ±éƒ¨': ['èŠ±è“®', 'å°æ±'],
      'é›¢å³¶': ['é‡‘é–€', 'é¦¬ç¥–'],
      'å…¶ä»–': ['å…¶ä»–']
    };
    // å¤šèªè¨€åŸå¸‚åç¨±å°ç…§è¡¨
    const CITY_NAMES = {
        'zh-TW': {
            'å°åŒ—': 'å°åŒ—', 'æ–°åŒ—': 'æ–°åŒ—', 'åŸºéš†': 'åŸºéš†', 'æ¡ƒåœ’': 'æ¡ƒåœ’', 'å®œè˜­': 'å®œè˜­', 'æ–°ç«¹': 'æ–°ç«¹',
            'è‹—æ —': 'è‹—æ —', 'å°ä¸­': 'å°ä¸­', 'å½°åŒ–': 'å½°åŒ–', 'å—æŠ•': 'å—æŠ•', 'é›²æ—': 'é›²æ—',
            'å˜‰ç¾©': 'å˜‰ç¾©', 'å°å—': 'å°å—', 'é«˜é›„': 'é«˜é›„', 'å±æ±': 'å±æ±', 'æ¾æ¹–': 'æ¾æ¹–',
            'èŠ±è“®': 'èŠ±è“®', 'å°æ±': 'å°æ±', 'é‡‘é–€': 'é‡‘é–€', 'é¦¬ç¥–': 'é¦¬ç¥–', 'å…¶ä»–': 'å…¶ä»–',
            'åŒ—éƒ¨': 'åŒ—éƒ¨', 'ä¸­éƒ¨': 'ä¸­éƒ¨', 'å—éƒ¨': 'å—éƒ¨', 'æ±éƒ¨': 'æ±éƒ¨', 'é›¢å³¶': 'é›¢å³¶'
        },
        'zh-CN': {
            'å°åŒ—': 'å°åŒ—', 'æ–°åŒ—': 'æ–°åŒ—', 'åŸºéš†': 'åŸºéš†', 'æ¡ƒåœ’': 'æ¡ƒåœ’', 'å®œè˜­': 'å®œè˜­', 'æ–°ç«¹': 'æ–°ç«¹',
            'è‹—æ —': 'è‹—æ —', 'å°ä¸­': 'å°ä¸­', 'å½°åŒ–': 'å½°åŒ–', 'å—æŠ•': 'å—æŠ•', 'é›²æ—': 'é›²æ—',
            'å˜‰ç¾©': 'å˜‰ç¾©', 'å°å—': 'å°å—', 'é«˜é›„': 'é«˜é›„', 'å±æ±': 'å±æ±', 'æ¾æ¹–': 'æ¾æ¹–',
            'èŠ±è“®': 'èŠ±è“®', 'å°æ±': 'å°æ±', 'é‡‘é–€': 'é‡‘é–€', 'é¦¬ç¥–': 'é¦¬ç¥–', 'å…¶ä»–': 'å…¶ä»–',
            'åŒ—éƒ¨': 'åŒ—éƒ¨', 'ä¸­éƒ¨': 'ä¸­éƒ¨', 'å—éƒ¨': 'å—éƒ¨', 'æ±éƒ¨': 'æ±éƒ¨', 'é›¢å³¶': 'é›¢å³¶'
        },
        'en-US': {
            'å°åŒ—': 'Taipei', 'æ–°åŒ—': 'New Taipei', 'åŸºéš†': 'Keelung', 'æ¡ƒåœ’': 'Taoyuan', 'å®œè˜­': 'Yilan', 'æ–°ç«¹': 'Hsinchu',
            'è‹—æ —': 'Miaoli', 'å°ä¸­': 'Taichung', 'å½°åŒ–': 'Changhua', 'å—æŠ•': 'Nantou', 'é›²æ—': 'Yunlin',
            'å˜‰ç¾©': 'Chiayi', 'å°å—': 'Tainan', 'é«˜é›„': 'Kaohsiung', 'å±æ±': 'Pingtung', 'æ¾æ¹–': 'Penghu',
            'èŠ±è“®': 'Hualien', 'å°æ±': 'Taitung', 'é‡‘é–€': 'Kinmen', 'é¦¬ç¥–': 'Matsu', 'å…¶ä»–': 'Others',
            'åŒ—éƒ¨': 'North', 'ä¸­éƒ¨': 'Central', 'å—éƒ¨': 'South', 'æ±éƒ¨': 'East', 'é›¢å³¶': 'Islands'
        },
        'en-GB': {
            'å°åŒ—': 'Taipei', 'æ–°åŒ—': 'New Taipei', 'åŸºéš†': 'Keelung', 'æ¡ƒåœ’': 'Taoyuan', 'å®œè˜­': 'Yilan', 'æ–°ç«¹': 'Hsinchu',
            'è‹—æ —': 'Miaoli', 'å°ä¸­': 'Taichung', 'å½°åŒ–': 'Changhua', 'å—æŠ•': 'Nantou', 'é›²æ—': 'Yunlin',
            'å˜‰ç¾©': 'Chiayi', 'å°å—': 'Tainan', 'é«˜é›„': 'Kaohsiung', 'å±æ±': 'Pingtung', 'æ¾æ¹–': 'Penghu',
            'èŠ±è“®': 'Hualien', 'å°æ±': 'Taitung', 'é‡‘é–€': 'Kinmen', 'é¦¬ç¥–': 'Matsu', 'å…¶ä»–': 'Others',
            'åŒ—éƒ¨': 'North', 'ä¸­éƒ¨': 'Central', 'å—éƒ¨': 'South', 'æ±éƒ¨': 'East', 'é›¢å³¶': 'Islands'
        },
        'ja-JP': {
            'å°åŒ—': 'å°åŒ—', 'æ–°åŒ—': 'æ–°åŒ—', 'åŸºéš†': 'åŸºéš†', 'æ¡ƒåœ’': 'æ¡ƒåœ’', 'å®œè˜­': 'å®œè˜­', 'æ–°ç«¹': 'æ–°ç«¹',
            'è‹—æ —': 'è‹—æ —', 'å°ä¸­': 'å°ä¸­', 'å½°åŒ–': 'å½°åŒ–', 'å—æŠ•': 'å—æŠ•', 'é›²æ—': 'é›²æ—',
            'å˜‰ç¾©': 'å˜‰ç¾©', 'å°å—': 'å°å—', 'é«˜é›„': 'é«˜é›„', 'å±æ±': 'å±æ±', 'æ¾æ¹–': 'æ¾æ¹–',
            'èŠ±è“®': 'èŠ±è“®', 'å°æ±': 'å°æ±', 'é‡‘é–€': 'é‡‘é–€', 'é¦¬ç¥–': 'é¦¬ç¥–', 'å…¶ä»–': 'ãã®ä»–',
            'åŒ—éƒ¨': 'åŒ—éƒ¨', 'ä¸­éƒ¨': 'ä¸­éƒ¨', 'å—éƒ¨': 'å—éƒ¨', 'æ±éƒ¨': 'æ±éƒ¨', 'é›¢å³¶': 'é›¢å³¶'
        },
        'ko-KR': {
            'å°åŒ—': 'íƒ€ì´ë² ì´', 'æ–°åŒ—': 'ì‹ ë² ì´', 'åŸºéš†': 'ì§€ë£½', 'æ¡ƒåœ’': 'íƒ€ì˜¤ìœ„ì•ˆ', 'å®œè˜­': 'ì´ë€', 'æ–°ç«¹': 'ì‹ ì£¼',
            'è‹—æ —': 'ë¨€ì˜¤ë¦¬', 'å°ä¸­': 'íƒ€ì´ì¤‘', 'å½°åŒ–': 'ì¥í™”', 'å—æŠ•': 'ë‚œí„°ìš°', 'é›²æ—': 'ìœˆë¦°',
            'å˜‰ç¾©': 'ìì´', 'å°å—': 'íƒ€ì´ë‚œ', 'é«˜é›„': 'ê°€ì˜¤ìŠ', 'å±æ±': 'í•‘ë‘¥', 'æ¾æ¹–': 'í‘í›„',
            'èŠ±è“®': 'í™”ë¡„', 'å°æ±': 'íƒ€ì´ë‘¥', 'é‡‘é–€': 'ì§„ë¨¼', 'é¦¬ç¥–': 'ë§ˆì­ˆ', 'å…¶ä»–': 'ê¸°íƒ€',
            'åŒ—éƒ¨': 'ë¶ë¶€', 'ä¸­éƒ¨': 'ì¤‘ë¶€', 'å—éƒ¨': 'ë‚¨ë¶€', 'æ±éƒ¨': 'ë™ë¶€', 'é›¢å³¶': 'ì™¸ë„'
        },
        'th-TH': {
            'å°åŒ—': 'à¹„à¸—à¹€à¸›', 'æ–°åŒ—': 'à¸‹à¸´à¸™à¹€à¸›à¹ˆà¸¢à¹Œ', 'åŸºéš†': 'à¸ˆà¸µà¸«à¸¥à¸‡', 'æ¡ƒåœ’': 'à¹€à¸–à¸²à¸«à¸¢à¸§à¸™', 'å®œè˜­': 'à¸­à¸µà¹‹à¸«à¸¥à¸²à¸™', 'æ–°ç«¹': 'à¸‹à¸´à¸™à¸ˆà¸¹à¹‹',
            'è‹—æ —': 'à¹€à¸«à¸¡à¸µà¸¢à¸§à¸¥à¸µà¹ˆ', 'å°ä¸­': 'à¹„à¸—à¸ˆà¸‡', 'å½°åŒ–': 'à¸ˆà¸²à¸‡à¸®à¸§à¸²', 'å—æŠ•': 'à¸«à¸™à¸²à¸™à¹‚à¸–à¸§', 'é›²æ—': 'à¸¢à¸ºà¸«à¸§à¸´à¸™à¸«à¸¥à¸´à¸™',
            'å˜‰ç¾©': 'à¹€à¸ˆà¸µà¸¢à¸­à¸µà¹‰', 'å°å—': 'à¹„à¸–à¸«à¸™à¸²à¸™', 'é«˜é›„': 'à¹€à¸à¸²à¸ªà¸ºà¸¢à¸‡', 'å±æ±': 'à¸œà¸´à¸‡à¸•à¸‡', 'æ¾æ¹–': 'à¹€à¸œà¸´à¸‡à¸«à¸¹',
            'èŠ±è“®': 'à¸®à¸§à¸²à¹€à¸«à¸¥à¸µà¸¢à¸™', 'å°æ±': 'à¹„à¸–à¸•à¸‡', 'é‡‘é–€': 'à¸ˆà¸´à¸™à¹€à¸«à¸¡à¸´à¸™', 'é¦¬ç¥–': 'à¸«à¸¡à¸²à¸ˆà¸¹à¹ˆ', 'å…¶ä»–': 'à¸­à¸·à¹ˆà¸™à¹†',
            'åŒ—éƒ¨': 'à¹€à¸«à¸™à¸·à¸­', 'ä¸­éƒ¨': 'à¸à¸¥à¸²à¸‡', 'å—éƒ¨': 'à¹ƒà¸•à¹‰', 'æ±éƒ¨': 'à¸•à¸°à¸§à¸±à¸™à¸­à¸­à¸', 'é›¢å³¶': 'à¹€à¸à¸²à¸°'
        },
        'vi-VN': {
            'å°åŒ—': 'ÄÃ i Báº¯c', 'æ–°åŒ—': 'TÃ¢n Báº¯c', 'åŸºéš†': 'CÆ¡ Long', 'æ¡ƒåœ’': 'ÄÃ o ViÃªn', 'å®œè˜­': 'Nghi Lan', 'æ–°ç«¹': 'TÃ¢n TrÃºc',
            'è‹—æ —': 'MiÃªu Láº­t', 'å°ä¸­': 'ÄÃ i Trung', 'å½°åŒ–': 'ChÆ°Æ¡ng HÃ³a', 'å—æŠ•': 'Nam Äáº§u', 'é›²æ—': 'VÃ¢n LÃ¢m',
            'å˜‰ç¾©': 'Gia NghÄ©a', 'å°å—': 'ÄÃ i Nam', 'é«˜é›„': 'Cao HÃ¹ng', 'å±æ±': 'BÃ¬nh ÄÃ´ng', 'æ¾æ¹–': 'BÃ nh Há»“',
            'èŠ±è“®': 'Hoa LiÃªn', 'å°æ±': 'ÄÃ i ÄÃ´ng', 'é‡‘é–€': 'Kim MÃ´n', 'é¦¬ç¥–': 'MÃ£ Tá»•', 'å…¶ä»–': 'KhÃ¡c',
            'åŒ—éƒ¨': 'Báº¯c', 'ä¸­éƒ¨': 'Trung', 'å—éƒ¨': 'Nam', 'æ±éƒ¨': 'ÄÃ´ng', 'é›¢å³¶': 'Äáº£o'
        },
        'it-IT': {
            'å°åŒ—': 'Taipei', 'æ–°åŒ—': 'New Taipei', 'åŸºéš†': 'Keelung', 'æ¡ƒåœ’': 'Taoyuan', 'å®œè˜­': 'Yilan', 'æ–°ç«¹': 'Hsinchu',
            'è‹—æ —': 'Miaoli', 'å°ä¸­': 'Taichung', 'å½°åŒ–': 'Changhua', 'å—æŠ•': 'Nantou', 'é›²æ—': 'Yunlin',
            'å˜‰ç¾©': 'Chiayi', 'å°å—': 'Tainan', 'é«˜é›„': 'Kaohsiung', 'å±æ±': 'Pingtung', 'æ¾æ¹–': 'Penghu',
            'èŠ±è“®': 'Hualien', 'å°æ±': 'Taitung', 'é‡‘é–€': 'Kinmen', 'é¦¬ç¥–': 'Matsu', 'å…¶ä»–': 'Altri',
            'åŒ—éƒ¨': 'Nord', 'ä¸­éƒ¨': 'Centro', 'å—éƒ¨': 'Sud', 'æ±éƒ¨': 'Est', 'é›¢å³¶': 'Isole'
        }
    };
    
    // ä¿ç•™è‹±æ–‡å°ç…§è¡¨ä»¥å‘å¾Œå…¼å®¹
    const CITY_NAMES_EN = CITY_NAMES['en-US'];

    const STREAM_NAME_EN = {
        // å°åŒ—
        "å°åŒ—è±¡å±±": "Elephant Mountain", "å¤§ç¨»åŸ•": "Dadaocheng", "ç¢§å±±å·–": "Bishan Temple", "å¾®é¢¨å¹³å°": "Breeze Platform",
        "è²“ç©ºæŒ‡å—å®®": "Maokong Zhinan Temple", "æ“å¤©å²¡è‰åŸ": "Qingtiangang Grassland", "é™½æ˜æ›¸å±‹": "Yangming Bookshelf",
        "é çœºä¸ƒæ˜Ÿå±±": "Mt. Qixing View", "äºŒåªå­åœè»Šå ´": "Erpingzi Parking", "å¤§å±¯è‡ªç„¶å…¬åœ’": "Datun Nature Park",
        "å°æ²¹å‘åœè»Šå ´": "Xiaoyoukeng Parking", "å†·æ°´å‘åœè»Šå ´": "Lengshuikeng Parking",
        // æ–°åŒ—
        "æ–°åŒ—æ·¡æ°´": "Tamsui", "æ–°åŒ—é¼»é ­": "Bitou Cape", "ä¸­è§’ç£": "Zhongjiao Bay", "ååˆ†ç€‘å¸ƒå…¬åœ’": "Shifen Waterfall",
        "æ–°åŒ—ä¹ä»½": "Jiufen", "å…§æ´åœ‹å®¶æ£®æ—éŠæ¨‚å€": "Neidong Forest Area", "ä¸‰å³½è€è¡—åŒ—æ®µ": "Sanxia Old St. (N)",
        "ä¸‰å³½è€è¡—å—æ®µ": "Sanxia Old St. (S)", "çƒä¾†åŠæ©‹": "Wulai Suspension Bridge", "å“¡å±±å­": "Yuanshanzi",
        "æ–‡å±±è¾²å ´å¤§è‰çš®": "Wenshan Farm",
        // åŸºéš†/æ–°ç«¹/æ¡ƒåœ’
        "å¤–æœ¨å±±": "Waimushan", "æˆåŠŸæ¹–": "Cheng Kung Lake", "å¤§è‰åª": "Great Lawn",
        "æ¡ƒåœ’æ©Ÿå ´": "Taoyuan Airport", "TPE å—è·‘é“": "TPE South Runway", "TPE åŒ—è·‘é“": "TPE North Runway",
        "æ°¸å®‰æ¼æ¸¯": "Yongan Fishing Port", "æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ": "Lalashan Visitor Ctr", "è™é ­å±±ç’°ä¿å…¬åœ’": "Hutoushan Park",
        "å°çƒä¾†å¤©ç©ºæ­¥é“": "Xiao Wulai Skywalk", "è§’æ¿å±±æ€è¦ªäº­": "Jiaobanshan Pavilion", "ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°": "San-Gui-Xi-Shui",
        "å¤§æºªæ©‹": "Daxi Bridge", "å¥§çˆ¾æ£®æ—å­¸å ‚": "Owl Forest School", "è§’æ¿å±±æ¢…åœ’": "Jiaobanshan Plum Garden",
        "è§’æ¿å±±ç”Ÿæ…‹æ± ": "Jiaobanshan Pond", "å¤§æºªè€è¡—": "Daxi Old Street", "çŸ³é–€æ°´åº«": "Shihmen Reservoir",
        "æ…ˆæ¹–æ°´å²¸å»£å ´": "Cihu Waterfront", "è–‘æ¯å³¶": "Jiangmu Island", "ä¸Šå·´é™µ": "Upper Baling",
        "æ©Ÿå ´å‡±æ‚…": "Hyatt Place", "å¯°å®‡å¹³å°": "Huanyu Platform", "è¨±åæ¸¯æ¿•åœ°": "Xucuogang Wetlands",
        "æ¡ƒåœ’æ©Ÿå ´ç•«é¢/è³‡è¨Š": "Airport Info/View",
        // å®œè˜­
        "å®œè˜­å¤–æ¾³": "Waiao Beach", "å®œè˜­ç¦éš†": "Fulong Beach", "çŸ³åŸæ¼æ¸¯": "Shicheng Port", "ç„¡å°¾æ¸¯": "Wuwei Port",
        "çŸ³åŸæ¼æ¸¯1": "Shicheng Port 1", "ç¤æºªå¯’æ²é…’åº—": "Mu Jiao Xi Hotel",
        // è‹—æ —/å°ä¸­/å½°åŒ–/å—æŠ•
        "æ±¶æ°´éŠå®¢ä¸­å¿ƒ": "Wenshui Visitor Ctr", "è§€éœ§éŠæ†©å€": "Guanwu Rec Area", "é›ªè¦‹éŠæ†©å€": "Xuejian Rec Area",
        "å°ä¸­é«˜ç¾": "Gaomei Wetlands", "æœ›é«˜å¯®": "Wanggaoliao", "å½°åŒ–ç‹åŠŸ": "Wanggong Port", "æ­¦å¶ºäº­": "Wuling Pavilion",
        // å˜‰ç¾©/å°å—
        "å˜‰ç¾©å¥®èµ·æ¹–": "Fenqihu", "äºŒå»¶å¹³æ­¥é“": "Eryanping Trail", "å¤ªå¹³é›²æ¢¯": "Taiping Suspension Bridge",
        "è§¸å£éŠå®¢ä¸­å¿ƒ": "Chukou Visitor Ctr", "æ„›æƒ…å¤§è‰åŸ": "Love Prairie", "ç”ŸåŠ›è¾²å ´": "Shengli Farm",
        "é‡Œä½³è³‡è¨Šç«™": "Lijia Info Station", "å°å—ä¸ƒè‚¡": "Qigu", "åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€": "Beishanwei Birds",
        "æ›¾æ–‡æ°´åº«": "Zengwen Reservoir", "ç«å±±ç¢§é›²å¯º": "Biyun Temple",
        // é«˜é›„/å±æ±
        "æ¥ æ¢“è–èˆˆæ©‹": "Shengxing Bridge", "èšµå¯®åœ‹å°": "Keliao Elementary", "æ——æ´¥æµ·æ°´æµ´å ´": "Cijin Beach",
        "å£½å±±è§€æ™¯å°": "Shoushan Lookout", "è“®æ± æ½­": "Lotus Pond", "é«˜é›„ç‡ˆå¡”": "Kaohsiung Lighthouse",
        "æ——æ´¥æ²™ç˜": "Cijin Beach Cam", "ç¾Œå…‰æ©‹": "Qiangguang Bridge", "å¢¾ä¸å—ç£": "Kenting Nanwan",
        "èˆ¹å¸†çŸ³": "Chuanfanshi", "èˆ¹å¸†çŸ³æ²™ç˜ (4K)": "Chuanfanshi Beach", "é›€é¯›å…¬å¯“": "Damselfish Apt",
        "é ‚æµå€": "Upcurrent Zone", "è»¸å­”å…¬åœ’": "Acropora Park", "æ–æ›³å¤§è‰åŸ": "Swaying Grassland",
        // èŠ±è“®/å°æ±
        "é¦¬å¤ªéæºªå·¦å²¸": "Mataian Creek", "ä¸ƒæ˜Ÿæ½­": "Qixingtan", "çŸ³æ¢¯åª": "Shitiping", "å¤§çŸ³é¼»å±±": "Dashibishan",
        "é•·è™¹æ©‹": "Changhong Bridge", "å°æ±é¯‰é­šå±±": "Liyushan", "å°æ±é‡‘å´™å¤§æ©‹": "Jinlun Bridge",
        "å°æ±é‡‘æ¨½è§€æµª": "Jinzun Surf", "å°æ±å¯Œå±±": "Fushan", "å°æ±æ‰åŸç£": "Shanyuan Bay",
        "å°æ±å¯Œå²¡æ¼æ¸¯": "Fugang Port", "å°æ±è¯æºæ›™å…‰è§€æ™¯å°": "Huayuan Sunrise", "å°æ±å—æ©«å£": "S. Cross-Island Hwy",
        "å°æ±æ± ä¸Šå¤©å ‚è·¯": "Chishang Paradise Rd", "å°æ±å¤šè‰¯": "Duoliang Station", "é¹¿é‡é«˜å°": "Luye Highland",
        "ä¸‰ä»™å°": "Sanxiantai", "é‡‘æ¨½éŠæ†©å€": "Jinzun Rec Area", "éƒ½æ­·éŠå®¢ä¸­å¿ƒ": "Duli Visitor Ctr",
        "åŠ è·¯è˜­éŠæ†©å€": "Jialulan Rec Area", "ç¶ å³¶å—å¯®": "Green Island Nanliao", "ç¶ å³¶å¸†èˆ¹é¼»": "Fanchuanbi",
        "ç¶ å³¶æŸ´å£æµ®æ½›å€": "Chaikou Snorkeling", "å¨œè·¯å½é…’åº—": "Naruwan Hotel",
        // é›¢å³¶/å…¶ä»–
        "é‡‘é–€éº’éºŸå±±å…¬åœ’": "Qilin Mt. Park", "é‡‘é–€134é«˜åœ°": "134 Highland", "é‡‘é–€å»ºåŠŸå¶¼": "Jiangong Islet",
        "åŒ—ç«¿èˆªç©ºç«™ä¼‘æ¯å®¤": "Beigan Airport", "è“®è¯å¯ºæ­£æ®¿1": "Lianhua Temple 1", "è“®è¯å¯ºæ­£æ®¿2": "Lianhua Temple 2",
        "åœ°éœ‡ç›£æ¸¬ç›´æ’­": "Earthquake Monitor", "æ¾å±±æ©Ÿå ´èˆªç­è³‡è¨Š": "TSA Flight Info", "é«˜é›„æ©Ÿå ´èˆªç­è³‡è¨Š": "KHH Flight Info",
        "æ¡ƒåœ’æ©Ÿå ´èˆªç­è³‡è¨Š": "TPE Flight Info"
    };

    /* ===== èªè¨€åŒ… (Localization) ===== */
    const LANGUAGES = {
        'zh-TW': {
            'title': 'å°ç£å³æ™‚ç›´æ’­å¤šåˆ†å‰²ç›£çœ‹',
            // ä¿®æ­£ 3x3 é †åºï¼šå·¦ä¸Š,ä¸­ä¸Š,å³ä¸Š,å·¦ä¸­,ä¸­å¤®,å³ä¸­,å·¦ä¸‹,ä¸­ä¸‹,å³ä¸‹
            'cam_name': (index) => {
                const names = ['å·¦ä¸Š', 'å³ä¸Š', 'å·¦ä¸‹', 'å³ä¸‹'];
                // 2x2 é è¨­
                const names3x3 = ['å·¦ä¸Š', 'ä¸­ä¸Š', 'å³ä¸Š', 'å·¦ä¸­', 'ä¸­å¤®', 'å³ä¸­', 'å·¦ä¸‹', 'ä¸­ä¸‹', 'å³ä¸‹'];
                // 3x3
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `ç•«é¢ ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `ç•«é¢ ${index + 1}`;
                } else {
                    return `ç•«é¢ ${index + 1}`;
                }
            },
            'fullscreen_btn': 'å…¨è¢å¹•',
            'settings_btn': 'âš™ï¸ è¨­å®š',
            'mute_btn_unmuted': 'è§£é™¤éœéŸ³',
            'mute_btn_muted': 'éœéŸ³',
            'request_btn': 'ğŸ¶ é»æ­Œ/æ¸…å–®',
            'back_btn': 'ğŸ  è¿”å›åœ°å€åˆ—è¡¨',
            'loading': 'è¼‰å…¥ä¸­...',
            'source_prefix': 'ä¾†æº:',
            // Settings Modal
            'settings_title': 'âš™ï¸ ç¨‹å¼è¨­å®š',
            'grid_size_label': 'ç•«é¢åˆ†å‰²æ¨¡å¼ï¼š',
            'grid_1x1': '1x1 (å–®ç•«é¢)',
            'grid_2x2': '2x2 (å››åˆ†å‰²)',
            'grid_3x3': '3x3 (ä¹åˆ†å‰²)',
            'grid_hint': 'æ›´æ”¹åˆ†å‰²æ¨¡å¼å°‡é‡è¨­æ‰€æœ‰ç•«é¢ã€‚',
            'language_label': 'èªè¨€é¸æ“‡ï¼š',
            'lang_zh_tw': 'æ­£é«”ä¸­æ–‡',
            'lang_en_us': 'English',
            'labels_toggle_label': 'ç•«é¢æ¨™ç±¤é¡¯ç¤ºï¼š',
            'labels_toggle_hide': 'æ¨™ç±¤éš±è—',
            'labels_toggle_show': 'æ¨™ç±¤é¡¯ç¤º',
            'settings_close_btn': 'é—œé–‰è¨­å®š',
            // Music Modal
            'music_mode_title': 'éŸ³æ¨‚æ’­æ”¾æ¨¡å¼',
            'music_mode_hint': 'é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æ’­æ”¾æ¨¡å¼ï¼š',
            'mode_list_loop': 'ğŸ”„ åˆ—è¡¨å¾ªç’°',
            'mode_shuffle': 'ğŸ”€ éš¨æ©Ÿæ’­æ”¾',
            'mode_stop_btn': 'â¹ï¸ åœæ­¢ä¸¦çµæŸæ’­æ”¾',
            'queue_title': 'ğŸ¶ æ’­æ”¾åˆ—è¡¨ç‹€æ…‹',
            'queue_playing_playlist': 'æ­£åœ¨æ’­æ”¾æ¸…å–® IDï¼š',
            'queue_list_empty': 'ï¼ˆæ¸…å–®å°šæœªè®€å–æˆ–ç‚ºç©ºï¼‰',
            'queue_total': (total, current, mode) => `ç¸½è¨ˆï¼š${total} é¦– | ç•¶å‰ï¼šç¬¬ ${current} é¦– | æ¨¡å¼ï¼š${mode}`,
            'queue_next_video': 'ä¸‹ä¸€é¦–æ­Œæ›²ï¼š',
            'queue_playlist_pending': (id) => `âš ï¸ æœ‰å¾…æ’­æ¸…å–®ï¼ˆID: ${id}ï¼‰å°‡æ–¼ç•¶å‰æ­Œæ›²çµæŸå¾Œé–‹å§‹æ’­æ”¾ã€‚`,
            'queue_empty_queue': 'æ’­æ”¾åˆ—è¡¨ç‚ºç©ºã€‚',
            'queue_playing_queue': 'æ­£åœ¨æ’­æ”¾åˆ—è¡¨å–®æ›²ï¼š',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'é—œé–‰',
            'queue_full_list': 'å®Œæ•´æ¸…å–®ï¼š',
            // Alerts
            'alert_invalid_playlist': 'ç„¡æ•ˆçš„æ’­æ”¾æ¸…å–®ã€‚',
            'alert_playlist_playing': 'è©²æ’­æ”¾æ¸…å–®å·²åœ¨æ’­æ”¾ä¸­ã€‚',
            'alert_playlist_queued': (id) => `âœ… ç•¶å‰å–®æ›²æ’­æ”¾å®Œç•¢å¾Œï¼Œå°‡è‡ªå‹•é–‹å§‹æ’­æ”¾æ¸…å–® ID: ${id}ã€‚`,
            'alert_playlist_loaded': (id) => `âœ… å·²è¼‰å…¥æ’­æ”¾æ¸…å–® ID: ${id}ã€‚`,
            'alert_song_added': (title) => `âœ… å·²å°‡ ${title} åŠ å…¥æ’­æ”¾åˆ—è¡¨ã€‚`,
            'alert_no_video_found': 'æ‰¾ä¸åˆ°ç¬¦åˆçš„å½±ç‰‡ã€‚',
            'alert_found_and_added': (title) => `âœ… å·²æ‰¾åˆ°ä¸¦åŠ å…¥ï¼š${title}`,
            'alert_playing_now': 'æ­£åœ¨æ’­æ”¾ï¼š',
            'alert_play_index_error': 'æ’­æ”¾ç´¢å¼•éŒ¯èª¤ã€‚',
            // Music button titles
            'music_prev_btn': 'ä¸Šä¸€é¦–',
            'music_next_btn': 'ä¸‹ä¸€é¦–',
            'music_play_btn': 'æ’­æ”¾',
            'music_pause_btn': 'æš«åœ',
            'music_mode_btn': 'æ¨¡å¼è¨­å®š',
            'music_queue_btn': 'æŸ¥çœ‹æ’­æ”¾åˆ—è¡¨ç‹€æ…‹',
            'settings_btn_title': 'ç•«é¢åˆ†å‰²ã€èªè¨€èˆ‡æ¨™ç±¤è¨­å®š',
            'request_btn_title': 'è¼¸å…¥ç¶²å€/IDé»æ­Œæˆ–æ’­æ”¾æ¸…å–®',
            'request_prompt': 'è¼¸å…¥ç¶²å€/IDé»æ­Œæˆ–æ’­æ”¾æ¸…å–®\nï¼ˆä¾‹å¦‚ï¼šå½±ç‰‡ID: dQw4w9WgXcQï¼Œæˆ–æ’­æ”¾æ¸…å–®ç¶²å€ï¼Œæˆ–é—œéµå­—ï¼‰',
            'maps_toggle_label': 'å°åœ°åœ–é¡¯ç¤ºï¼š',
            'maps_toggle_show': 'åœ°åœ–é¡¯ç¤º',
            'maps_toggle_hide': 'åœ°åœ–éš±è—',
            'city_btn_title': (city) => `åˆ‡æ›é¡¯ç¤º ${city} çš„ç›´æ’­åˆ—è¡¨`,
            // Lyrics
            'lyrics_btn': 'ğŸ“ æ­Œè©',
            'lyrics_title': 'æ­Œè©',
            'lyrics_empty': 'é»æ“Šç·¨è¼¯æŒ‰éˆ•è¼¸å…¥æ­Œè©',
            'lyrics_edit_title': 'ç·¨è¼¯æ­Œè©',
            'lyrics_edit_placeholder': 'åœ¨æ­¤è¼¸å…¥æ­Œè©...',
            'lyrics_save': 'å„²å­˜',
            'lyrics_clear': 'æ¸…é™¤',
            'lyrics_cancel': 'å–æ¶ˆ',
            'lyrics_edit_btn': 'ç·¨è¼¯æ­Œè©',
            'lyrics_minimize_btn': 'æœ€å°åŒ–',
            'lyrics_close_btn': 'é—œé–‰',
        },
        'en-US': {
            'title': 'Taiwan Live Stream Multi-View Monitor',
            'cam_name': (index) => {
                const names = ['Top Left', 'Top Right', 'Bottom Left', 'Bottom Right'];
                const names3x3 = ['Top Left', 'Top Center', 'Top Right', 'Middle Left', 'Center', 'Middle Right', 'Bottom Left', 'Bottom Center', 'Bottom Right'];
                const numCams = getGridDimension() * getGridDimension();
                
                if (numCams === 9) {
                    return names3x3[index] || `Cam ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `Cam ${index + 1}`;
                } else {
                    return `Cam ${index + 1}`;
                }
            },
            'fullscreen_btn': 'Fullscreen',
            'settings_btn': 'âš™ï¸ Settings',
            'mute_btn_unmuted': 'Unmute',
            'mute_btn_muted': 'Mute',
            'request_btn': 'ğŸ¶ Song/Playlist',
            'back_btn': 'ğŸ  Back to Regions',
            'loading': 'Loading...',
            'source_prefix': 'Source:',
            // Settings Modal
            'settings_title': 'âš™ï¸ Program Settings',
            'grid_size_label': 'Screen Grid Layout:',
            'grid_1x1': '1x1 (Single View)',
            'grid_2x2': '2x2 (Quad View)',
            'grid_3x3': '3x3 (Nine View)',
            'grid_hint': 'Changing the grid will reset all views.',
            'language_label': 'Language Selection:',
            'lang_zh_tw': 'Traditional Chinese',
            'lang_en_us': 'English',
            'labels_toggle_label': 'Screen Labels Display:',
            'labels_toggle_hide': 'Hide Labels',
            'labels_toggle_show': 'Show Labels',
            'settings_close_btn': 'Close Settings',
            // Music Modal
            'music_mode_title': 'Music Playback Mode',
            'music_mode_hint': 'Click a button below to select playback mode:',
            'mode_list_loop': 'ğŸ”„ List Loop',
            'mode_shuffle': 'ğŸ”€ Shuffle',
            'mode_stop_btn': 'â¹ï¸ Stop and End Playback',
            'queue_title': 'ğŸ¶ Playlist Status',
            'queue_playing_playlist': 'Currently playing Playlist ID:',
            'queue_list_empty': '(Playlist not loaded or empty)',
            'queue_total': (total, current, mode) => `Total: ${total} tracks | Current: #${current} | Mode: ${mode}`,
            'queue_next_video': 'Next Video:',
            'queue_playlist_pending': (id) => `âš ï¸ Pending playlist (ID: ${id}) will start after current song ends.`,
            'queue_empty_queue': 'Playback queue is empty.',
            'queue_playing_queue': 'Currently playing queued song:',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'Close',
            'queue_full_list': 'Full List:',
            // Alerts
            'alert_invalid_playlist': 'Invalid playlist.',
            'alert_playlist_playing': 'This playlist is already playing.',
            'alert_playlist_queued': (id) => `âœ… Playlist ID: ${id} will start automatically after the current song ends.`,
            'alert_playlist_loaded': (id) => `âœ… Playlist ID: ${id} loaded.`,
            'alert_song_added': (title) => `âœ… Added ${title} to the playback queue.`,
            'alert_no_video_found': 'No matching video found.',
            'alert_found_and_added': (title) => `âœ… Found and added: ${title}`,
            'alert_playing_now': 'Now Playing:',
            'alert_play_index_error': 'Playback index error.',
            // Music button titles
            'music_prev_btn': 'Previous',
            'music_next_btn': 'Next',
            'music_play_btn': 'Play',
            'music_pause_btn': 'Pause',
            'music_mode_btn': 'Mode Settings',
            'music_queue_btn': 'View Playlist Status',
            'settings_btn_title': 'Grid Layout, Language & Label Settings',
            'request_btn_title': 'Enter URL/ID to request song or playlist',
            'request_prompt': 'Enter URL/ID to request song or playlist\n(Example: Video ID: dQw4w9WgXcQ, or playlist URL, or keywords)',
            'maps_toggle_label': 'Mini Map Display:',
            'maps_toggle_show': 'Show Map',
            'maps_toggle_hide': 'Hide Map',
            'city_btn_title': (city) => `Switch to show ${city} live streams`,
      },
      'zh-CN': {
            'title': 'å°æ¹¾å®æ—¶ç›´æ’­å¤šåˆ†å‰²ç›‘çœ‹',
            'cam_name': (index) => {
                const names = ['å·¦ä¸Š', 'å³ä¸Š', 'å·¦ä¸‹', 'å³ä¸‹'];
                const names3x3 = ['å·¦ä¸Š', 'ä¸­ä¸Š', 'å³ä¸Š', 'å·¦ä¸­', 'ä¸­å¤®', 'å³ä¸­', 'å·¦ä¸‹', 'ä¸­ä¸‹', 'å³ä¸‹'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `ç”»é¢ ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `ç”»é¢ ${index + 1}`;
                } else {
                    return `ç”»é¢ ${index + 1}`;
                }
            },
            'fullscreen_btn': 'å…¨å±',
            'settings_btn': 'âš™ï¸ è®¾ç½®',
            'mute_btn_unmuted': 'è§£é™¤é™éŸ³',
            'mute_btn_muted': 'é™éŸ³',
            'request_btn': 'ğŸ¶ ç‚¹æ­Œ/æ¸…å•',
            'back_btn': 'ğŸ  è¿”å›åœ°åŒºåˆ—è¡¨',
            'loading': 'åŠ è½½ä¸­...',
            'source_prefix': 'æ¥æº:',
            'settings_title': 'âš™ï¸ ç¨‹åºè®¾ç½®',
            'grid_size_label': 'ç”»é¢åˆ†å‰²æ¨¡å¼ï¼š',
            'grid_1x1': '1x1 (å•ç”»é¢)',
            'grid_2x2': '2x2 (å››åˆ†å‰²)',
            'grid_3x3': '3x3 (ä¹åˆ†å‰²)',
            'grid_hint': 'æ›´æ”¹åˆ†å‰²æ¨¡å¼å°†é‡ç½®æ‰€æœ‰ç”»é¢ã€‚',
            'language_label': 'è¯­è¨€é€‰æ‹©ï¼š',
            'lang_zh_tw': 'ç¹ä½“ä¸­æ–‡',
            'lang_en_us': 'English',
            'labels_toggle_label': 'ç”»é¢æ ‡ç­¾æ˜¾ç¤ºï¼š',
            'labels_toggle_hide': 'æ ‡ç­¾éšè—',
            'labels_toggle_show': 'æ ‡ç­¾æ˜¾ç¤º',
            'settings_close_btn': 'å…³é—­è®¾ç½®',
            'music_mode_title': 'éŸ³ä¹æ’­æ”¾æ¨¡å¼',
            'music_mode_hint': 'ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®é€‰æ‹©æ’­æ”¾æ¨¡å¼ï¼š',
            'mode_list_loop': 'ğŸ”„ åˆ—è¡¨å¾ªç¯',
            'mode_shuffle': 'ğŸ”€ éšæœºæ’­æ”¾',
            'mode_stop_btn': 'â¹ï¸ åœæ­¢å¹¶ç»“æŸæ’­æ”¾',
            'queue_title': 'ğŸ¶ æ’­æ”¾åˆ—è¡¨çŠ¶æ€',
            'queue_playing_playlist': 'æ­£åœ¨æ’­æ”¾æ¸…å• IDï¼š',
            'queue_list_empty': 'ï¼ˆæ¸…å•å°šæœªè¯»å–æˆ–ä¸ºç©ºï¼‰',
            'queue_total': (total, current, mode) => `æ€»è®¡ï¼š${total} é¦– | å½“å‰ï¼šç¬¬ ${current} é¦– | æ¨¡å¼ï¼š${mode}`,
            'queue_next_video': 'ä¸‹ä¸€é¦–æ­Œæ›²ï¼š',
            'queue_playlist_pending': (id) => `âš ï¸ æœ‰å¾…æ’­æ¸…å•ï¼ˆID: ${id}ï¼‰å°†äºå½“å‰æ­Œæ›²ç»“æŸåå¼€å§‹æ’­æ”¾ã€‚`,
            'queue_empty_queue': 'æ’­æ”¾åˆ—è¡¨ä¸ºç©ºã€‚',
            'queue_playing_queue': 'æ­£åœ¨æ’­æ”¾åˆ—è¡¨å•æ›²ï¼š',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'å…³é—­',
            'queue_full_list': 'å®Œæ•´æ¸…å•ï¼š',
            'alert_invalid_playlist': 'æ— æ•ˆçš„æ’­æ”¾æ¸…å•ã€‚',
            'alert_playlist_playing': 'è¯¥æ’­æ”¾æ¸…å•å·²åœ¨æ’­æ”¾ä¸­ã€‚',
            'alert_playlist_queued': (id) => `âœ… å½“å‰å•æ›²æ’­æ”¾å®Œæ¯•åï¼Œå°†è‡ªåŠ¨å¼€å§‹æ’­æ”¾æ¸…å• ID: ${id}ã€‚`,
            'alert_playlist_loaded': (id) => `âœ… å·²è½½å…¥æ’­æ”¾æ¸…å• ID: ${id}ã€‚`,
            'alert_song_added': (title) => `âœ… å·²å°† ${title} åŠ å…¥æ’­æ”¾åˆ—è¡¨ã€‚`,
            'alert_no_video_found': 'æ‰¾ä¸åˆ°ç¬¦åˆçš„è§†é¢‘ã€‚',
            'alert_found_and_added': (title) => `âœ… å·²æ‰¾åˆ°å¹¶åŠ å…¥ï¼š${title}`,
            'alert_playing_now': 'æ­£åœ¨æ’­æ”¾ï¼š',
            'alert_play_index_error': 'æ’­æ”¾ç´¢å¼•é”™è¯¯ã€‚',
            // Music button titles
            'music_prev_btn': 'ä¸Šä¸€é¦–',
            'music_next_btn': 'ä¸‹ä¸€é¦–',
            'music_play_btn': 'æ’­æ”¾',
            'music_pause_btn': 'æš‚åœ',
            'music_mode_btn': 'æ¨¡å¼è®¾ç½®',
            'music_queue_btn': 'æŸ¥çœ‹æ’­æ”¾åˆ—è¡¨çŠ¶æ€',
            'settings_btn_title': 'ç”»é¢åˆ†å‰²ã€è¯­è¨€ä¸æ ‡ç­¾è®¾ç½®',
            'request_btn_title': 'è¾“å…¥ç½‘å€/IDç‚¹æ­Œæˆ–æ’­æ”¾æ¸…å•',
            'request_prompt': 'è¾“å…¥ç½‘å€/IDç‚¹æ­Œæˆ–æ’­æ”¾æ¸…å•\nï¼ˆä¾‹å¦‚ï¼šå½±ç‰‡ID: dQw4w9WgXcQï¼Œæˆ–æ’­æ”¾æ¸…å•ç½‘å€ï¼Œæˆ–å…³é”®å­—ï¼‰',
            'maps_toggle_label': 'å°åœ°å›¾æ˜¾ç¤ºï¼š',
            'maps_toggle_show': 'åœ°å›¾æ˜¾ç¤º',
            'maps_toggle_hide': 'åœ°å›¾éšè—',
            'city_btn_title': (city) => `åˆ‡æ¢æ˜¾ç¤º ${city} çš„ç›´æ’­åˆ—è¡¨`,
      },
      'en-GB': {
            'title': 'Taiwan Live Stream Multi-View Monitor',
            'cam_name': (index) => {
                const names = ['Top Left', 'Top Right', 'Bottom Left', 'Bottom Right'];
                const names3x3 = ['Top Left', 'Top Centre', 'Top Right', 'Middle Left', 'Centre', 'Middle Right', 'Bottom Left', 'Bottom Centre', 'Bottom Right'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `Cam ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `Cam ${index + 1}`;
                } else {
                    return `Cam ${index + 1}`;
                }
            },
            'fullscreen_btn': 'Fullscreen',
            'settings_btn': 'âš™ï¸ Settings',
            'mute_btn_unmuted': 'Unmute',
            'mute_btn_muted': 'Mute',
            'request_btn': 'ğŸ¶ Song/Playlist',
            'back_btn': 'ğŸ  Back to Regions',
            'loading': 'Loading...',
            'source_prefix': 'Source:',
            'settings_title': 'âš™ï¸ Programme Settings',
            'grid_size_label': 'Screen Grid Layout:',
            'grid_1x1': '1x1 (Single View)',
            'grid_2x2': '2x2 (Quad View)',
            'grid_3x3': '3x3 (Nine View)',
            'grid_hint': 'Changing the grid will reset all views.',
            'language_label': 'Language Selection:',
            'lang_zh_tw': 'Traditional Chinese',
            'lang_en_us': 'English',
            'labels_toggle_label': 'Screen Labels Display:',
            'labels_toggle_hide': 'Hide Labels',
            'labels_toggle_show': 'Show Labels',
            'settings_close_btn': 'Close Settings',
            'music_mode_title': 'Music Playback Mode',
            'music_mode_hint': 'Click a button below to select playback mode:',
            'mode_list_loop': 'ğŸ”„ List Loop',
            'mode_shuffle': 'ğŸ”€ Shuffle',
            'mode_stop_btn': 'â¹ï¸ Stop and End Playback',
            'queue_title': 'ğŸ¶ Playlist Status',
            'queue_playing_playlist': 'Currently playing Playlist ID:',
            'queue_list_empty': '(Playlist not loaded or empty)',
            'queue_total': (total, current, mode) => `Total: ${total} tracks | Current: #${current} | Mode: ${mode}`,
            'queue_next_video': 'Next Video:',
            'queue_playlist_pending': (id) => `âš ï¸ Pending playlist (ID: ${id}) will start after current song ends.`,
            'queue_empty_queue': 'Playback queue is empty.',
            'queue_playing_queue': 'Currently playing queued song:',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'Close',
            'queue_full_list': 'Full List:',
            'alert_invalid_playlist': 'Invalid playlist.',
            'alert_playlist_playing': 'This playlist is already playing.',
            'alert_playlist_queued': (id) => `âœ… Playlist ID: ${id} will start automatically after the current song ends.`,
            'alert_playlist_loaded': (id) => `âœ… Playlist ID: ${id} loaded.`,
            'alert_song_added': (title) => `âœ… Added ${title} to the playback queue.`,
            'alert_no_video_found': 'No matching video found.',
            'alert_found_and_added': (title) => `âœ… Found and added: ${title}`,
            'alert_playing_now': 'Now Playing:',
            'alert_play_index_error': 'Playback index error.',
            // Music button titles
            'music_prev_btn': 'Previous',
            'music_next_btn': 'Next',
            'music_play_btn': 'Play',
            'music_pause_btn': 'Pause',
            'music_mode_btn': 'Mode Settings',
            'music_queue_btn': 'View Playlist Status',
            'settings_btn_title': 'Grid Layout, Language & Label Settings',
            'request_btn_title': 'Enter URL/ID to request song or playlist',
            'request_prompt': 'Enter URL/ID to request song or playlist\n(Example: Video ID: dQw4w9WgXcQ, or playlist URL, or keywords)',
            'maps_toggle_label': 'Mini Map Display:',
            'maps_toggle_show': 'Show Map',
            'maps_toggle_hide': 'Hide Map',
      },
      'ja-JP': {
            'title': 'å°æ¹¾ãƒ©ã‚¤ãƒ–ã‚¹ãƒˆãƒªãƒ¼ãƒ å¤šåˆ†å‰²ç›£è¦–',
            'cam_name': (index) => {
                const names = ['å·¦ä¸Š', 'å³ä¸Š', 'å·¦ä¸‹', 'å³ä¸‹'];
                const names3x3 = ['å·¦ä¸Š', 'ä¸­ä¸Š', 'å³ä¸Š', 'å·¦ä¸­', 'ä¸­å¤®', 'å³ä¸­', 'å·¦ä¸‹', 'ä¸­ä¸‹', 'å³ä¸‹'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `ç”»é¢ ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `ç”»é¢ ${index + 1}`;
                } else {
                    return `ç”»é¢ ${index + 1}`;
                }
            },
            'fullscreen_btn': 'å…¨ç”»é¢',
            'settings_btn': 'âš™ï¸ è¨­å®š',
            'mute_btn_unmuted': 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤',
            'mute_btn_muted': 'ãƒŸãƒ¥ãƒ¼ãƒˆ',
            'request_btn': 'ğŸ¶ æ›²/ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ',
            'back_btn': 'ğŸ  åœ°åŸŸãƒªã‚¹ãƒˆã«æˆ»ã‚‹',
            'loading': 'èª­ã¿è¾¼ã¿ä¸­...',
            'source_prefix': 'ã‚½ãƒ¼ã‚¹:',
            'settings_title': 'âš™ï¸ ãƒ—ãƒ­ã‚°ãƒ©ãƒ è¨­å®š',
            'grid_size_label': 'ç”»é¢åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ï¼š',
            'grid_1x1': '1x1 (å˜ç”»é¢)',
            'grid_2x2': '2x2 (å››åˆ†å‰²)',
            'grid_3x3': '3x3 (ä¹åˆ†å‰²)',
            'grid_hint': 'åˆ†å‰²ãƒ¢ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®ç”»é¢ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚',
            'language_label': 'è¨€èªé¸æŠï¼š',
            'lang_zh_tw': 'ç¹ä½“ä¸­å›½èª',
            'lang_en_us': 'English',
            'labels_toggle_label': 'ç”»é¢ãƒ©ãƒ™ãƒ«è¡¨ç¤ºï¼š',
            'labels_toggle_hide': 'ãƒ©ãƒ™ãƒ«éè¡¨ç¤º',
            'labels_toggle_show': 'ãƒ©ãƒ™ãƒ«è¡¨ç¤º',
            'settings_close_btn': 'è¨­å®šã‚’é–‰ã˜ã‚‹',
            'music_mode_title': 'éŸ³æ¥½å†ç”Ÿãƒ¢ãƒ¼ãƒ‰',
            'music_mode_hint': 'ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å†ç”Ÿãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠï¼š',
            'mode_list_loop': 'ğŸ”„ ãƒªã‚¹ãƒˆãƒ«ãƒ¼ãƒ—',
            'mode_shuffle': 'ğŸ”€ ã‚·ãƒ£ãƒƒãƒ•ãƒ«',
            'mode_stop_btn': 'â¹ï¸ åœæ­¢ã—ã¦å†ç”Ÿçµ‚äº†',
            'queue_title': 'ğŸ¶ ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆçŠ¶æ…‹',
            'queue_playing_playlist': 'ç¾åœ¨å†ç”Ÿä¸­ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ IDï¼š',
            'queue_list_empty': 'ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„ã‹ç©ºã§ã™ï¼‰',
            'queue_total': (total, current, mode) => `åˆè¨ˆï¼š${total} æ›² | ç¾åœ¨ï¼š${current} æ›²ç›® | ãƒ¢ãƒ¼ãƒ‰ï¼š${mode}`,
            'queue_next_video': 'æ¬¡ã®æ›²ï¼š',
            'queue_playlist_pending': (id) => `âš ï¸ å¾…æ©Ÿä¸­ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆï¼ˆID: ${id}ï¼‰ã¯ç¾åœ¨ã®æ›²çµ‚äº†å¾Œã«é–‹å§‹ã•ã‚Œã¾ã™ã€‚`,
            'queue_empty_queue': 'å†ç”Ÿã‚­ãƒ¥ãƒ¼ãŒç©ºã§ã™ã€‚',
            'queue_playing_queue': 'ç¾åœ¨å†ç”Ÿä¸­ã®ã‚­ãƒ¥ãƒ¼æ›²ï¼š',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'é–‰ã˜ã‚‹',
            'queue_full_list': 'å®Œå…¨ãªãƒªã‚¹ãƒˆï¼š',
            'alert_invalid_playlist': 'ç„¡åŠ¹ãªãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã§ã™ã€‚',
            'alert_playlist_playing': 'ã“ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¯æ—¢ã«å†ç”Ÿä¸­ã§ã™ã€‚',
            'alert_playlist_queued': (id) => `âœ… ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ ID: ${id} ã¯ç¾åœ¨ã®æ›²çµ‚äº†å¾Œã«è‡ªå‹•çš„ã«é–‹å§‹ã•ã‚Œã¾ã™ã€‚`,
            'alert_playlist_loaded': (id) => `âœ… ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ ID: ${id} ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸã€‚`,
            'alert_song_added': (title) => `âœ… ${title} ã‚’å†ç”Ÿã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã—ã¾ã—ãŸã€‚`,
            'alert_no_video_found': 'ä¸€è‡´ã™ã‚‹å‹•ç”»ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚',
            'alert_found_and_added': (title) => `âœ… è¦‹ã¤ã‘ã¦è¿½åŠ ã—ã¾ã—ãŸï¼š${title}`,
            'alert_playing_now': 'å†ç”Ÿä¸­ï¼š',
            'alert_play_index_error': 'å†ç”Ÿã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¨ãƒ©ãƒ¼ã€‚',
            // Music button titles
            'music_prev_btn': 'å‰ã®æ›²',
            'music_next_btn': 'æ¬¡ã®æ›²',
            'music_play_btn': 'å†ç”Ÿ',
            'music_pause_btn': 'ä¸€æ™‚åœæ­¢',
            'music_mode_btn': 'ãƒ¢ãƒ¼ãƒ‰è¨­å®š',
            'music_queue_btn': 'ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆçŠ¶æ…‹ã‚’è¡¨ç¤º',
            'settings_btn_title': 'ç”»é¢åˆ†å‰²ã€è¨€èªã¨ãƒ©ãƒ™ãƒ«è¨­å®š',
            'request_btn_title': 'URL/IDã‚’å…¥åŠ›ã—ã¦æ›²ã¾ãŸã¯ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ',
            'request_prompt': 'URL/IDã‚’å…¥åŠ›ã—ã¦æ›²ã¾ãŸã¯ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆ\nï¼ˆä¾‹ï¼šå‹•ç”»ID: dQw4w9WgXcQã€ã¾ãŸã¯ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆURLã€ã¾ãŸã¯ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼‰',
            'maps_toggle_label': 'ãƒŸãƒ‹ãƒãƒƒãƒ—è¡¨ç¤ºï¼š',
            'maps_toggle_show': 'åœ°å›³è¡¨ç¤º',
            'maps_toggle_hide': 'åœ°å›³éè¡¨ç¤º',
            'city_btn_title': (city) => `${city}ã®ãƒ©ã‚¤ãƒ–ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ãˆ`,
      },
      'ko-KR': {
            'title': 'ëŒ€ë§Œ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼ ë‹¤ì¤‘ í™”ë©´ ëª¨ë‹ˆí„°',
            'cam_name': (index) => {
                const names = ['ì¢Œìƒ', 'ìš°ìƒ', 'ì¢Œí•˜', 'ìš°í•˜'];
                const names3x3 = ['ì¢Œìƒ', 'ì¤‘ìƒ', 'ìš°ìƒ', 'ì¢Œì¤‘', 'ì¤‘ì•™', 'ìš°ì¤‘', 'ì¢Œí•˜', 'ì¤‘í•˜', 'ìš°í•˜'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `í™”ë©´ ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `í™”ë©´ ${index + 1}`;
                } else {
                    return `í™”ë©´ ${index + 1}`;
                }
            },
            'fullscreen_btn': 'ì „ì²´ í™”ë©´',
            'settings_btn': 'âš™ï¸ ì„¤ì •',
            'mute_btn_unmuted': 'ìŒì†Œê±° í•´ì œ',
            'mute_btn_muted': 'ìŒì†Œê±°',
            'request_btn': 'ğŸ¶ ë…¸ë˜/ì¬ìƒ ëª©ë¡',
            'back_btn': 'ğŸ  ì§€ì—­ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°',
            'loading': 'ë¡œë”© ì¤‘...',
            'source_prefix': 'ì¶œì²˜:',
            'settings_title': 'âš™ï¸ í”„ë¡œê·¸ë¨ ì„¤ì •',
            'grid_size_label': 'í™”ë©´ ë¶„í•  ëª¨ë“œï¼š',
            'grid_1x1': '1x1 (ë‹¨ì¼ í™”ë©´)',
            'grid_2x2': '2x2 (4ë¶„í• )',
            'grid_3x3': '3x3 (9ë¶„í• )',
            'grid_hint': 'ë¶„í•  ëª¨ë“œë¥¼ ë³€ê²½í•˜ë©´ ëª¨ë“  í™”ë©´ì´ ì¬ì„¤ì •ë©ë‹ˆë‹¤.',
            'language_label': 'ì–¸ì–´ ì„ íƒï¼š',
            'lang_zh_tw': 'ë²ˆì²´ ì¤‘êµ­ì–´',
            'lang_en_us': 'English',
            'labels_toggle_label': 'í™”ë©´ ë ˆì´ë¸” í‘œì‹œï¼š',
            'labels_toggle_hide': 'ë ˆì´ë¸” ìˆ¨ê¸°ê¸°',
            'labels_toggle_show': 'ë ˆì´ë¸” í‘œì‹œ',
            'settings_close_btn': 'ì„¤ì • ë‹«ê¸°',
            'music_mode_title': 'ìŒì•… ì¬ìƒ ëª¨ë“œ',
            'music_mode_hint': 'ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì¬ìƒ ëª¨ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”ï¼š',
            'mode_list_loop': 'ğŸ”„ ëª©ë¡ ë°˜ë³µ',
            'mode_shuffle': 'ğŸ”€ ì…”í”Œ',
            'mode_stop_btn': 'â¹ï¸ ì¤‘ì§€ ë° ì¬ìƒ ì¢…ë£Œ',
            'queue_title': 'ğŸ¶ ì¬ìƒ ëª©ë¡ ìƒíƒœ',
            'queue_playing_playlist': 'í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ì¬ìƒ ëª©ë¡ IDï¼š',
            'queue_list_empty': 'ï¼ˆì¬ìƒ ëª©ë¡ì´ ë¡œë“œë˜ì§€ ì•Šì•˜ê±°ë‚˜ ë¹„ì–´ ìˆìŒï¼‰',
            'queue_total': (total, current, mode) => `ì´: ${total}ê³¡ | í˜„ì¬: ${current}ê³¡ | ëª¨ë“œ: ${mode}`,
            'queue_next_video': 'ë‹¤ìŒ ê³¡ï¼š',
            'queue_playlist_pending': (id) => `âš ï¸ ëŒ€ê¸° ì¤‘ì¸ ì¬ìƒ ëª©ë¡ï¼ˆID: ${id}ï¼‰ì€ í˜„ì¬ ê³¡ ì¢…ë£Œ í›„ ì‹œì‘ë©ë‹ˆë‹¤.`,
            'queue_empty_queue': 'ì¬ìƒ ëŒ€ê¸°ì—´ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.',
            'queue_playing_queue': 'í˜„ì¬ ì¬ìƒ ì¤‘ì¸ ëŒ€ê¸°ì—´ ê³¡ï¼š',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'ë‹«ê¸°',
            'queue_full_list': 'ì „ì²´ ëª©ë¡ï¼š',
            'alert_invalid_playlist': 'ìœ íš¨í•˜ì§€ ì•Šì€ ì¬ìƒ ëª©ë¡ì…ë‹ˆë‹¤.',
            'alert_playlist_playing': 'ì´ ì¬ìƒ ëª©ë¡ì€ ì´ë¯¸ ì¬ìƒ ì¤‘ì…ë‹ˆë‹¤.',
            'alert_playlist_queued': (id) => `âœ… ì¬ìƒ ëª©ë¡ ID: ${id}ëŠ” í˜„ì¬ ê³¡ ì¢…ë£Œ í›„ ìë™ìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤.`,
            'alert_playlist_loaded': (id) => `âœ… ì¬ìƒ ëª©ë¡ ID: ${id}ë¥¼ ë¡œë“œí–ˆìŠµë‹ˆë‹¤.`,
            'alert_song_added': (title) => `âœ… ${title}ì„(ë¥¼) ì¬ìƒ ëŒ€ê¸°ì—´ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.`,
            'alert_no_video_found': 'ì¼ì¹˜í•˜ëŠ” ë™ì˜ìƒì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.',
            'alert_found_and_added': (title) => `âœ… ì°¾ì•„ì„œ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤: ${title}`,
            'alert_playing_now': 'ì¬ìƒ ì¤‘ï¼š',
            'alert_play_index_error': 'ì¬ìƒ ì¸ë±ìŠ¤ ì˜¤ë¥˜.',
            // Music button titles
            'music_prev_btn': 'ì´ì „ ê³¡',
            'music_next_btn': 'ë‹¤ìŒ ê³¡',
            'music_play_btn': 'ì¬ìƒ',
            'music_pause_btn': 'ì¼ì‹œ ì •ì§€',
            'music_mode_btn': 'ëª¨ë“œ ì„¤ì •',
            'music_queue_btn': 'ì¬ìƒ ëª©ë¡ ìƒíƒœ ë³´ê¸°',
            'settings_btn_title': 'í™”ë©´ ë¶„í• , ì–¸ì–´ ë° ë ˆì´ë¸” ì„¤ì •',
            'request_btn_title': 'URL/IDë¥¼ ì…ë ¥í•˜ì—¬ ë…¸ë˜ ë˜ëŠ” ì¬ìƒ ëª©ë¡ ìš”ì²­',
            'request_prompt': 'URL/IDë¥¼ ì…ë ¥í•˜ì—¬ ë…¸ë˜ ë˜ëŠ” ì¬ìƒ ëª©ë¡ ìš”ì²­\n(ì˜ˆ: ë™ì˜ìƒ ID: dQw4w9WgXcQ, ë˜ëŠ” ì¬ìƒ ëª©ë¡ URL, ë˜ëŠ” í‚¤ì›Œë“œ)',
            'maps_toggle_label': 'ë¯¸ë‹ˆë§µ í‘œì‹œï¼š',
            'maps_toggle_show': 'ì§€ë„ í‘œì‹œ',
            'maps_toggle_hide': 'ì§€ë„ ìˆ¨ê¸°ê¸°',
            'city_btn_title': (city) => `${city}ì˜ ë¼ì´ë¸Œ ìŠ¤íŠ¸ë¦¼ ëª©ë¡ í‘œì‹œë¡œ ì „í™˜`,
      },
      'th-TH': {
            'title': 'à¸¡à¸­à¸™à¸´à¹€à¸•à¸­à¸£à¹Œà¸ªà¸•à¸£à¸µà¸¡à¸ªà¸”à¸«à¸¥à¸²à¸¢à¸¡à¸¸à¸¡à¸¡à¸­à¸‡à¸‚à¸­à¸‡à¹„à¸•à¹‰à¸«à¸§à¸±à¸™',
            'cam_name': (index) => {
                const names = ['à¸‹à¹‰à¸²à¸¢à¸šà¸™', 'à¸‚à¸§à¸²à¸šà¸™', 'à¸‹à¹‰à¸²à¸¢à¸¥à¹ˆà¸²à¸‡', 'à¸‚à¸§à¸²à¸¥à¹ˆà¸²à¸‡'];
                const names3x3 = ['à¸‹à¹‰à¸²à¸¢à¸šà¸™', 'à¸à¸¥à¸²à¸‡à¸šà¸™', 'à¸‚à¸§à¸²à¸šà¸™', 'à¸‹à¹‰à¸²à¸¢à¸à¸¥à¸²à¸‡', 'à¸à¸¥à¸²à¸‡', 'à¸‚à¸§à¸²à¸à¸¥à¸²à¸‡', 'à¸‹à¹‰à¸²à¸¢à¸¥à¹ˆà¸²à¸‡', 'à¸à¸¥à¸²à¸‡à¸¥à¹ˆà¸²à¸‡', 'à¸‚à¸§à¸²à¸¥à¹ˆà¸²à¸‡'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `à¸«à¸™à¹‰à¸²à¸ˆà¸­ ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `à¸«à¸™à¹‰à¸²à¸ˆà¸­ ${index + 1}`;
                } else {
                    return `à¸«à¸™à¹‰à¸²à¸ˆà¸­ ${index + 1}`;
                }
            },
            'fullscreen_btn': 'à¹€à¸•à¹‡à¸¡à¸ˆà¸­',
            'settings_btn': 'âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²',
            'mute_btn_unmuted': 'à¸¢à¸à¹€à¸¥à¸´à¸à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡',
            'mute_btn_muted': 'à¸›à¸´à¸”à¹€à¸ªà¸µà¸¢à¸‡',
            'request_btn': 'ğŸ¶ à¹€à¸à¸¥à¸‡/à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ',
            'back_btn': 'ğŸ  à¸à¸¥à¸±à¸šà¹„à¸›à¸¢à¸±à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸ à¸¹à¸¡à¸´à¸ à¸²à¸„',
            'loading': 'à¸à¸³à¸¥à¸±à¸‡à¹‚à¸«à¸¥à¸”...',
            'source_prefix': 'à¹à¸«à¸¥à¹ˆà¸‡à¸—à¸µà¹ˆà¸¡à¸²:',
            'settings_title': 'âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹‚à¸›à¸£à¹à¸à¸£à¸¡',
            'grid_size_label': 'à¹‚à¸«à¸¡à¸”à¹à¸šà¹ˆà¸‡à¸«à¸™à¹‰à¸²à¸ˆà¸­ï¼š',
            'grid_1x1': '1x1 (à¸«à¸™à¹‰à¸²à¸ˆà¸­à¹€à¸”à¸µà¸¢à¸§)',
            'grid_2x2': '2x2 (à¸ªà¸µà¹ˆà¸ªà¹ˆà¸§à¸™)',
            'grid_3x3': '3x3 (à¹€à¸à¹‰à¸²à¸ªà¹ˆà¸§à¸™)',
            'grid_hint': 'à¸à¸²à¸£à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸à¸£à¸´à¸”à¸ˆà¸°à¸£à¸µà¹€à¸‹à¹‡à¸•à¸«à¸™à¹‰à¸²à¸ˆà¸­à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”',
            'language_label': 'à¹€à¸¥à¸·à¸­à¸à¸ à¸²à¸©à¸²ï¼š',
            'lang_zh_tw': 'à¸ˆà¸µà¸™à¸•à¸±à¸§à¹€à¸•à¹‡à¸¡',
            'lang_en_us': 'English',
            'labels_toggle_label': 'à¹à¸ªà¸”à¸‡à¸›à¹‰à¸²à¸¢à¸«à¸™à¹‰à¸²à¸ˆà¸­ï¼š',
            'labels_toggle_hide': 'à¸‹à¹ˆà¸­à¸™à¸›à¹‰à¸²à¸¢',
            'labels_toggle_show': 'à¹à¸ªà¸”à¸‡à¸›à¹‰à¸²à¸¢',
            'settings_close_btn': 'à¸›à¸´à¸”à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²',
            'music_mode_title': 'à¹‚à¸«à¸¡à¸”à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¥à¸‡',
            'music_mode_hint': 'à¸„à¸¥à¸´à¸à¸›à¸¸à¹ˆà¸¡à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡à¹€à¸à¸·à¹ˆà¸­à¹€à¸¥à¸·à¸­à¸à¹‚à¸«à¸¡à¸”à¸à¸²à¸£à¹€à¸¥à¹ˆà¸™ï¼š',
            'mode_list_loop': 'ğŸ”„ à¸§à¸™à¸¥à¸¹à¸›à¸£à¸²à¸¢à¸à¸²à¸£',
            'mode_shuffle': 'ğŸ”€ à¸ªà¸¸à¹ˆà¸¡',
            'mode_stop_btn': 'â¹ï¸ à¸«à¸¢à¸¸à¸”à¹à¸¥à¸°à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸”à¸à¸²à¸£à¹€à¸¥à¹ˆà¸™',
            'queue_title': 'ğŸ¶ à¸ªà¸–à¸²à¸™à¸°à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ',
            'queue_playing_playlist': 'à¸à¸³à¸¥à¸±à¸‡à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ IDï¼š',
            'queue_list_empty': 'ï¼ˆà¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹‚à¸«à¸¥à¸”à¸«à¸£à¸·à¸­à¸§à¹ˆà¸²à¸‡à¹€à¸›à¸¥à¹ˆà¸²ï¼‰',
            'queue_total': (total, current, mode) => `à¸£à¸§à¸¡: ${total} à¹€à¸à¸¥à¸‡ | à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™: à¹€à¸à¸¥à¸‡à¸—à¸µà¹ˆ ${current} | à¹‚à¸«à¸¡à¸”: ${mode}`,
            'queue_next_video': 'à¹€à¸à¸¥à¸‡à¸–à¸±à¸”à¹„à¸›ï¼š',
            'queue_playlist_pending': (id) => `âš ï¸ à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œà¸—à¸µà¹ˆà¸£à¸­ï¼ˆID: ${id}ï¼‰à¸ˆà¸°à¹€à¸£à¸´à¹ˆà¸¡à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¹€à¸à¸¥à¸‡à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸ˆà¸š`,
            'queue_empty_queue': 'à¸„à¸´à¸§à¸à¸²à¸£à¹€à¸¥à¹ˆà¸™à¸§à¹ˆà¸²à¸‡à¹€à¸›à¸¥à¹ˆà¸²',
            'queue_playing_queue': 'à¸à¸³à¸¥à¸±à¸‡à¹€à¸¥à¹ˆà¸™à¹€à¸à¸¥à¸‡à¹ƒà¸™à¸„à¸´à¸§ï¼š',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'à¸›à¸´à¸”',
            'queue_full_list': 'à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”ï¼š',
            'alert_invalid_playlist': 'à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œà¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡',
            'alert_playlist_playing': 'à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œà¸™à¸µà¹‰à¸à¸³à¸¥à¸±à¸‡à¹€à¸¥à¹ˆà¸™à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§',
            'alert_playlist_queued': (id) => `âœ… à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ ID: ${id} à¸ˆà¸°à¹€à¸£à¸´à¹ˆà¸¡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸«à¸¥à¸±à¸‡à¸ˆà¸²à¸à¹€à¸à¸¥à¸‡à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸ˆà¸š`,
            'alert_playlist_loaded': (id) => `âœ… à¹‚à¸«à¸¥à¸”à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ ID: ${id} à¹à¸¥à¹‰à¸§`,
            'alert_song_added': (title) => `âœ… à¹€à¸à¸´à¹ˆà¸¡ ${title} à¸¥à¸‡à¹ƒà¸™à¸„à¸´à¸§à¸à¸²à¸£à¹€à¸¥à¹ˆà¸™à¹à¸¥à¹‰à¸§`,
            'alert_no_video_found': 'à¹„à¸¡à¹ˆà¸à¸šà¸§à¸´à¸”à¸µà¹‚à¸­à¸—à¸µà¹ˆà¸•à¸£à¸‡à¸à¸±à¸™',
            'alert_found_and_added': (title) => `âœ… à¸à¸šà¹à¸¥à¸°à¹€à¸à¸´à¹ˆà¸¡: ${title}`,
            'alert_playing_now': 'à¸à¸³à¸¥à¸±à¸‡à¹€à¸¥à¹ˆà¸™ï¼š',
            'alert_play_index_error': 'à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”à¸”à¸±à¸Šà¸™à¸µà¸à¸²à¸£à¹€à¸¥à¹ˆà¸™',
            // Music button titles
            'music_prev_btn': 'à¹€à¸à¸¥à¸‡à¸à¹ˆà¸­à¸™à¸«à¸™à¹‰à¸²',
            'music_next_btn': 'à¹€à¸à¸¥à¸‡à¸–à¸±à¸”à¹„à¸›',
            'music_play_btn': 'à¹€à¸¥à¹ˆà¸™',
            'music_pause_btn': 'à¸«à¸¢à¸¸à¸”à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§',
            'music_mode_btn': 'à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹‚à¸«à¸¡à¸”',
            'music_queue_btn': 'à¸”à¸¹à¸ªà¸–à¸²à¸™à¸°à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ',
            'settings_btn_title': 'à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸²à¸£à¹à¸šà¹ˆà¸‡à¸«à¸™à¹‰à¸²à¸ˆà¸­ à¸ à¸²à¸©à¸² à¹à¸¥à¸°à¸›à¹‰à¸²à¸¢',
            'request_btn_title': 'à¸›à¹‰à¸­à¸™ URL/ID à¹€à¸à¸·à¹ˆà¸­à¸‚à¸­à¹€à¸à¸¥à¸‡à¸«à¸£à¸·à¸­à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ',
            'request_prompt': 'à¸›à¹‰à¸­à¸™ URL/ID à¹€à¸à¸·à¹ˆà¸­à¸‚à¸­à¹€à¸à¸¥à¸‡à¸«à¸£à¸·à¸­à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ\n(à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡: à¸§à¸´à¸”à¸µà¹‚à¸­ ID: dQw4w9WgXcQ à¸«à¸£à¸·à¸­ URL à¹€à¸à¸¥à¸¢à¹Œà¸¥à¸´à¸ªà¸•à¹Œ à¸«à¸£à¸·à¸­à¸„à¸³à¸„à¹‰à¸™à¸«à¸²)',
            'maps_toggle_label': 'à¹à¸ªà¸”à¸‡à¹à¸œà¸™à¸—à¸µà¹ˆà¸‚à¸™à¸²à¸”à¹€à¸¥à¹‡à¸ï¼š',
            'maps_toggle_show': 'à¹à¸ªà¸”à¸‡à¹à¸œà¸™à¸—à¸µà¹ˆ',
            'maps_toggle_hide': 'à¸‹à¹ˆà¸­à¸™à¹à¸œà¸™à¸—à¸µà¹ˆ',
            'city_btn_title': (city) => `à¸ªà¸¥à¸±à¸šà¹€à¸à¸·à¹ˆà¸­à¹à¸ªà¸”à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸ªà¸•à¸£à¸µà¸¡à¸ªà¸”à¸‚à¸­à¸‡${city}`,
      },
      'vi-VN': {
            'title': 'MÃ n hÃ¬nh giÃ¡m sÃ¡t nhiá»u luá»“ng trá»±c tiáº¿p ÄÃ i Loan',
            'cam_name': (index) => {
                const names = ['TrÃªn trÃ¡i', 'TrÃªn pháº£i', 'DÆ°á»›i trÃ¡i', 'DÆ°á»›i pháº£i'];
                const names3x3 = ['TrÃªn trÃ¡i', 'TrÃªn giá»¯a', 'TrÃªn pháº£i', 'Giá»¯a trÃ¡i', 'Giá»¯a', 'Giá»¯a pháº£i', 'DÆ°á»›i trÃ¡i', 'DÆ°á»›i giá»¯a', 'DÆ°á»›i pháº£i'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `MÃ n hÃ¬nh ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `MÃ n hÃ¬nh ${index + 1}`;
                } else {
                    return `MÃ n hÃ¬nh ${index + 1}`;
                }
            },
            'fullscreen_btn': 'ToÃ n mÃ n hÃ¬nh',
            'settings_btn': 'âš™ï¸ CÃ i Ä‘áº·t',
            'mute_btn_unmuted': 'Bá» táº¯t tiáº¿ng',
            'mute_btn_muted': 'Táº¯t tiáº¿ng',
            'request_btn': 'ğŸ¶ BÃ i hÃ¡t/Danh sÃ¡ch',
            'back_btn': 'ğŸ  Quay láº¡i danh sÃ¡ch khu vá»±c',
            'loading': 'Äang táº£i...',
            'source_prefix': 'Nguá»“n:',
            'settings_title': 'âš™ï¸ CÃ i Ä‘áº·t chÆ°Æ¡ng trÃ¬nh',
            'grid_size_label': 'Cháº¿ Ä‘á»™ chia mÃ n hÃ¬nhï¼š',
            'grid_1x1': '1x1 (Má»™t mÃ n hÃ¬nh)',
            'grid_2x2': '2x2 (Bá»‘n pháº§n)',
            'grid_3x3': '3x3 (ChÃ­n pháº§n)',
            'grid_hint': 'Thay Ä‘á»•i lÆ°á»›i sáº½ Ä‘áº·t láº¡i táº¥t cáº£ cÃ¡c mÃ n hÃ¬nh.',
            'language_label': 'Chá»n ngÃ´n ngá»¯ï¼š',
            'lang_zh_tw': 'Tiáº¿ng Trung phá»“n thá»ƒ',
            'lang_en_us': 'English',
            'labels_toggle_label': 'Hiá»ƒn thá»‹ nhÃ£n mÃ n hÃ¬nhï¼š',
            'labels_toggle_hide': 'áº¨n nhÃ£n',
            'labels_toggle_show': 'Hiá»ƒn thá»‹ nhÃ£n',
            'settings_close_btn': 'ÄÃ³ng cÃ i Ä‘áº·t',
            'music_mode_title': 'Cháº¿ Ä‘á»™ phÃ¡t nháº¡c',
            'music_mode_hint': 'Nháº¥p vÃ o nÃºt bÃªn dÆ°á»›i Ä‘á»ƒ chá»n cháº¿ Ä‘á»™ phÃ¡tï¼š',
            'mode_list_loop': 'ğŸ”„ Láº·p danh sÃ¡ch',
            'mode_shuffle': 'ğŸ”€ Ngáº«u nhiÃªn',
            'mode_stop_btn': 'â¹ï¸ Dá»«ng vÃ  káº¿t thÃºc phÃ¡t',
            'queue_title': 'ğŸ¶ Tráº¡ng thÃ¡i danh sÃ¡ch phÃ¡t',
            'queue_playing_playlist': 'Äang phÃ¡t Danh sÃ¡ch IDï¼š',
            'queue_list_empty': 'ï¼ˆDanh sÃ¡ch chÆ°a Ä‘Æ°á»£c táº£i hoáº·c trá»‘ngï¼‰',
            'queue_total': (total, current, mode) => `Tá»•ng: ${total} bÃ i | Hiá»‡n táº¡i: bÃ i ${current} | Cháº¿ Ä‘á»™: ${mode}`,
            'queue_next_video': 'BÃ i tiáº¿p theoï¼š',
            'queue_playlist_pending': (id) => `âš ï¸ Danh sÃ¡ch Ä‘ang chá»ï¼ˆID: ${id}ï¼‰sáº½ báº¯t Ä‘áº§u sau khi bÃ i hiá»‡n táº¡i káº¿t thÃºc.`,
            'queue_empty_queue': 'HÃ ng Ä‘á»£i phÃ¡t trá»‘ng.',
            'queue_playing_queue': 'Äang phÃ¡t bÃ i trong hÃ ng Ä‘á»£iï¼š',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'ÄÃ³ng',
            'queue_full_list': 'Danh sÃ¡ch Ä‘áº§y Ä‘á»§ï¼š',
            'alert_invalid_playlist': 'Danh sÃ¡ch phÃ¡t khÃ´ng há»£p lá»‡.',
            'alert_playlist_playing': 'Danh sÃ¡ch phÃ¡t nÃ y Ä‘Ã£ Ä‘ang phÃ¡t.',
            'alert_playlist_queued': (id) => `âœ… Danh sÃ¡ch phÃ¡t ID: ${id} sáº½ tá»± Ä‘á»™ng báº¯t Ä‘áº§u sau khi bÃ i hiá»‡n táº¡i káº¿t thÃºc.`,
            'alert_playlist_loaded': (id) => `âœ… ÄÃ£ táº£i danh sÃ¡ch phÃ¡t ID: ${id}.`,
            'alert_song_added': (title) => `âœ… ÄÃ£ thÃªm ${title} vÃ o hÃ ng Ä‘á»£i phÃ¡t.`,
            'alert_no_video_found': 'KhÃ´ng tÃ¬m tháº¥y video phÃ¹ há»£p.',
            'alert_found_and_added': (title) => `âœ… ÄÃ£ tÃ¬m tháº¥y vÃ  thÃªm: ${title}`,
            'alert_playing_now': 'Äang phÃ¡tï¼š',
            'alert_play_index_error': 'Lá»—i chá»‰ má»¥c phÃ¡t.',
            // Music button titles
            'music_prev_btn': 'BÃ i trÆ°á»›c',
            'music_next_btn': 'BÃ i tiáº¿p theo',
            'music_play_btn': 'PhÃ¡t',
            'music_pause_btn': 'Táº¡m dá»«ng',
            'music_mode_btn': 'CÃ i Ä‘áº·t cháº¿ Ä‘á»™',
            'music_queue_btn': 'Xem tráº¡ng thÃ¡i danh sÃ¡ch phÃ¡t',
            'settings_btn_title': 'CÃ i Ä‘áº·t chia mÃ n hÃ¬nh, ngÃ´n ngá»¯ vÃ  nhÃ£n',
            'request_btn_title': 'Nháº­p URL/ID Ä‘á»ƒ yÃªu cáº§u bÃ i hÃ¡t hoáº·c danh sÃ¡ch phÃ¡t',
            'request_prompt': 'Nháº­p URL/ID Ä‘á»ƒ yÃªu cáº§u bÃ i hÃ¡t hoáº·c danh sÃ¡ch phÃ¡t\n(VÃ­ dá»¥: Video ID: dQw4w9WgXcQ, hoáº·c URL danh sÃ¡ch phÃ¡t, hoáº·c tá»« khÃ³a)',
            'maps_toggle_label': 'Hiá»ƒn thá»‹ báº£n Ä‘á»“ nhá»ï¼š',
            'maps_toggle_show': 'Hiá»ƒn thá»‹ báº£n Ä‘á»“',
            'maps_toggle_hide': 'áº¨n báº£n Ä‘á»“',
            'city_btn_title': (city) => `Chuyá»ƒn Ä‘á»ƒ hiá»ƒn thá»‹ danh sÃ¡ch phÃ¡t trá»±c tiáº¿p cá»§a ${city}`,
      },
      'it-IT': {
            'title': 'Monitor Multi-Vista Stream Live Taiwan',
            'cam_name': (index) => {
                const names = ['In alto a sinistra', 'In alto a destra', 'In basso a sinistra', 'In basso a destra'];
                const names3x3 = ['In alto a sinistra', 'In alto al centro', 'In alto a destra', 'A sinistra al centro', 'Centro', 'A destra al centro', 'In basso a sinistra', 'In basso al centro', 'In basso a destra'];
                const numCams = getGridDimension() * getGridDimension();
                if (numCams === 9) {
                    return names3x3[index] || `Schermo ${index + 1}`;
                } else if (numCams === 4) {
                    return names[index] || `Schermo ${index + 1}`;
                } else {
                    return `Schermo ${index + 1}`;
                }
            },
            'fullscreen_btn': 'Schermo intero',
            'settings_btn': 'âš™ï¸ Impostazioni',
            'mute_btn_unmuted': 'Riattiva audio',
            'mute_btn_muted': 'Disattiva audio',
            'request_btn': 'ğŸ¶ Canzone/Playlist',
            'back_btn': 'ğŸ  Torna alle regioni',
            'loading': 'Caricamento...',
            'source_prefix': 'Fonte:',
            'settings_title': 'âš™ï¸ Impostazioni programma',
            'grid_size_label': 'Layout griglia schermo:',
            'grid_1x1': '1x1 (Vista singola)',
            'grid_2x2': '2x2 (Vista quadrupla)',
            'grid_3x3': '3x3 (Vista nonupla)',
            'grid_hint': 'Cambiare la griglia reimposterÃ  tutte le viste.',
            'language_label': 'Selezione lingua:',
            'lang_zh_tw': 'Cinese tradizionale',
            'lang_en_us': 'English',
            'labels_toggle_label': 'Visualizzazione etichette schermo:',
            'labels_toggle_hide': 'Nascondi etichette',
            'labels_toggle_show': 'Mostra etichette',
            'settings_close_btn': 'Chiudi impostazioni',
            'music_mode_title': 'ModalitÃ  riproduzione musica',
            'music_mode_hint': 'Clicca un pulsante qui sotto per selezionare la modalitÃ  di riproduzione:',
            'mode_list_loop': 'ğŸ”„ Ciclo lista',
            'mode_shuffle': 'ğŸ”€ Casuale',
            'mode_stop_btn': 'â¹ï¸ Ferma e termina riproduzione',
            'queue_title': 'ğŸ¶ Stato playlist',
            'queue_playing_playlist': 'Riproduzione playlist ID:',
            'queue_list_empty': '(Playlist non caricata o vuota)',
            'queue_total': (total, current, mode) => `Totale: ${total} brani | Corrente: #${current} | ModalitÃ : ${mode}`,
            'queue_next_video': 'Prossimo video:',
            'queue_playlist_pending': (id) => `âš ï¸ Playlist in attesa (ID: ${id}) inizierÃ  dopo la fine della canzone corrente.`,
            'queue_empty_queue': 'La coda di riproduzione Ã¨ vuota.',
            'queue_playing_queue': 'Riproduzione canzone in coda:',
            'queue_mode_current': () => `â–¶ï¸`,
            'queue_mode_index': (index) => `${index + 1}`,
            'queue_close_btn': 'Chiudi',
            'queue_full_list': 'Lista completa:',
            'alert_invalid_playlist': 'Playlist non valida.',
            'alert_playlist_playing': 'Questa playlist Ã¨ giÃ  in riproduzione.',
            'alert_playlist_queued': (id) => `âœ… La playlist ID: ${id} inizierÃ  automaticamente dopo la fine della canzone corrente.`,
            'alert_playlist_loaded': (id) => `âœ… Playlist ID: ${id} caricata.`,
            'alert_song_added': (title) => `âœ… Aggiunto ${title} alla coda di riproduzione.`,
            'alert_no_video_found': 'Nessun video corrispondente trovato.',
            'alert_found_and_added': (title) => `âœ… Trovato e aggiunto: ${title}`,
            'alert_playing_now': 'In riproduzione:',
            'alert_play_index_error': 'Errore indice riproduzione.',
            // Music button titles
            'music_prev_btn': 'Precedente',
            'music_next_btn': 'Successivo',
            'music_play_btn': 'Riproduci',
            'music_pause_btn': 'Pausa',
            'music_mode_btn': 'Impostazioni modalitÃ ',
            'music_queue_btn': 'Visualizza stato playlist',
            'settings_btn_title': 'Impostazioni layout griglia, lingua ed etichette',
            'request_btn_title': 'Inserisci URL/ID per richiedere canzone o playlist',
            'request_prompt': 'Inserisci URL/ID per richiedere canzone o playlist\n(Esempio: Video ID: dQw4w9WgXcQ, o URL playlist, o parole chiave)',
            'maps_toggle_label': 'Visualizzazione mappa mini:',
            'maps_toggle_show': 'Mostra mappa',
            'maps_toggle_hide': 'Nascondi mappa',
            'city_btn_title': (city) => `Passa a mostrare gli stream live di ${city}`,
      }
    };

    function getTranslation(key, ...args) {
        const langData = LANGUAGES[currentLang] || LANGUAGES['zh-TW'];
        let text = langData[key] || LANGUAGES['zh-TW'][key] || key; 
        if (typeof text === 'function') {
            return text(...args);
        }
        return text;
    }

    function setLanguage(lang) {
        if (LANGUAGES[lang]) {
            currentLang = lang;
            localStorage.setItem('language', lang);
            updateUIForLanguage();
        }
    }

    function updateUIForLanguage() {
        document.getElementById('htmlLang').lang = currentLang;
        document.getElementById('pageTitle').innerText = getTranslation('title');

        // Control buttons
        const camButtonsContainer = document.getElementById('camSelectButtons');
        if (camButtonsContainer) { 
            updateCamSelectButtons(getGridDimension() * getGridDimension());
        }
        
        document.getElementById('fullscreenBtn').innerText = getTranslation('fullscreen_btn');
        document.getElementById('settingsBtn').innerText = getTranslation('settings_btn');
        document.getElementById('settingsBtn').title = getTranslation('settings_btn_title');
        document.getElementById('requestBtn').innerText = getTranslation('request_btn');
        document.getElementById('requestBtn').title = getTranslation('request_btn_title');
        // æ›´æ–°éŸ³æ¨‚æ§åˆ¶æŒ‰éˆ•æ¨™é¡Œ
        document.getElementById('prevSongBtn').title = getTranslation('music_prev_btn');
        document.getElementById('nextSongBtn').title = getTranslation('music_next_btn');
        document.getElementById('modeBtn').title = getTranslation('music_mode_btn');
        document.getElementById('playlistQueueBtn').title = getTranslation('music_queue_btn');
        // Modal Text
        document.getElementById('settingsTitle').innerText = getTranslation('settings_title');
        document.getElementById('gridSizeLabel').innerText = getTranslation('grid_size_label');
        document.getElementById('grid1x1Btn').innerText = getTranslation('grid_1x1');
        document.getElementById('grid2x2Btn').innerText = getTranslation('grid_2x2');
        document.getElementById('grid3x3Btn').innerText = getTranslation('grid_3x3');
        document.getElementById('gridSizeHint').innerText = getTranslation('grid_hint');
        document.getElementById('languageLabel').innerText = getTranslation('language_label');
        // æ›´æ–°èªè¨€ä¸‹æ‹‰é¸å–®çš„é¸ä¸­å€¼
        const languageSelect = document.getElementById('languageSelect');
        if (languageSelect) {
            languageSelect.value = currentLang;
        }
        document.getElementById('labelsToggleLabel').innerText = getTranslation('labels_toggle_label');
        document.getElementById('labelsToggleInModalBtn').innerText = isLabelsVisible ? getTranslation('labels_toggle_show') : getTranslation('labels_toggle_hide');
        document.getElementById('musicModeTitle').innerText = getTranslation('music_mode_title');
        document.getElementById('musicModeHint').innerText = getTranslation('music_mode_hint');
        document.getElementById('modeListLoop').innerText = getTranslation('mode_list_loop');
        document.getElementById('modeShuffle').innerText = getTranslation('mode_shuffle');
        document.getElementById('modeStopBtn').innerText = getTranslation('mode_stop_btn');
        document.getElementById('musicModeCloseBtn').innerText = getTranslation('settings_close_btn');
        document.getElementById('queueTitle').innerText = getTranslation('queue_title');
        document.getElementById('queueCloseBtn').innerText = getTranslation('queue_close_btn');
        // æ›´æ–°å…³é—­è®¾å®šæŒ‰é’®ç¿»è¯‘
        const closeSettingsBtn = document.querySelector('#mainSettingsModal .close-btn');
        if (closeSettingsBtn) {
            closeSettingsBtn.innerText = getTranslation('settings_close_btn');
        }
        // æ›´æ–°åœ°åœ–æ¨™ç±¤
        const mapsToggleLabel = document.getElementById('mapsToggleLabel');
        if (mapsToggleLabel) {
            mapsToggleLabel.innerText = getTranslation('maps_toggle_label');
        }
        const mapsToggleBtn = document.getElementById('mapsToggleBtn');
        if (mapsToggleBtn) {
            mapsToggleBtn.innerText = isMiniMapVisible ? getTranslation('maps_toggle_show') : getTranslation('maps_toggle_hide');
        }
        // Update stream labels and mute button status
        refreshMuteButtonLabel();
        for (let i = 0; i < MAX_PLAYERS; i++) {
            updateLabel(i);
        }
        
        // Update buttons in regionButtons (if visible)
        if (!currentCity) { // åªæœ‰åœ¨ä¸»åˆ—è¡¨æ™‚æ‰éœ€è¦é‡æ–°æ¸²æŸ“
            renderRegionButtons();
        } else {
             const backBtn = document.querySelector('#regionButtons .back-btn');
             if (backBtn) {
                 backBtn.textContent = getTranslation('back_btn');
             }
        }
        
        // æ›´æ–°èªè¨€ä¸‹æ‹‰é¸å–®çš„é¸ä¸­å€¼ï¼ˆå·²åœ¨ä¸Šé¢è™•ç†ï¼‰
    }
    

    function onYouTubeIframeAPIReady() {
      // ç¢ºä¿åœ¨åˆå§‹åŒ–æ’­æ”¾å™¨ä¹‹å‰ï¼Œgrid size å·²ç¶“è¢«è®€å–ä¸¦è¨­ç½®
      initializeGridSettings();
      // ç¢ºä¿ currentGridSize å’Œ body class è¨­ç½®æ­£ç¢º
      
      const numCams = getGridDimension() * getGridDimension();
      const defaultStreams = [
          "å°åŒ—-è²“ç©ºæŒ‡å—å®®", "æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´", "å°ä¸­-é«˜ç¾æ¿•åœ°", "é«˜é›„-å£½å±±è§€æ™¯å°", 
          "å®œè˜­-å¤–æ¾³æ²™ç˜", "å˜‰ç¾©-å¥®èµ·æ¹–", "å°æ±-é¯‰é­šå±±", "æ–°åŒ—-æ¼äººç¢¼é ­", "é‡‘é–€-éº’éºŸå±±æ£®æ—å…¬åœ’"
      ];
      for (let index = 0; index < numCams; index++) {
        const id = PLAYER_IDS[index];
        const defaultKey = defaultStreams[index];
        const initialVideoId = (defaultKey && ALL_STREAMS[defaultKey]) ? ALL_STREAMS[defaultKey].id : DEFAULT_VIDEO_ID;
        players[index] = new YT.Player(id, {
          videoId: initialVideoId,
          playerVars: {
            autoplay: 1,
            controls: 0,
            modestbranding: 1,
            rel: 0,
            showinfo: 0,
            fs: 0,
            disablekb: 1,
            loop: 1,
            mute: 1,
            playsinline: 1,
            start: 0,
            iv_load_policy: 3,
            cc_load_policy: 0,
            origin: window.location.origin
          },
          events: {
            onReady: onPlayerReady,
            onStateChange: (event) => handleStateChange(event, index)
          }
        });
        if (defaultKey && ALL_STREAMS[defaultKey]) {
          streamState[index] = { key: defaultKey, ...ALL_STREAMS[defaultKey] };
          updateLabel(index);
        }
      }
      
      // åˆå§‹åŒ–éŸ³æ¨‚æ’­æ”¾å™¨
      musicPlayer = new YT.Player('player_music', {
        videoId: '',
          playerVars: {
            autoplay: 0,
            controls: 0,
            modestbranding: 1,
            rel: 0,
            showinfo: 0,
            fs: 0,
            disablekb: 1,
            loop: 0,
            mute: 0,
            playsinline: 1,
            iv_load_policy: 3,
            cc_load_policy: 0,
            origin: window.location.origin
          },
        events: {
          onReady: onMusicPlayerReady,
          onStateChange: onMusicPlayerStateChange
   
        }
      });
      // å®Œæˆåˆå§‹åŒ–å¾Œæ›´æ–° UI
      initializeLabelSettings();
      initializeMiniMapSettings(); // åˆå§‹åŒ–åœ°åœ–é–‹é—œç‹€æ…‹
      initializeLyrics(); // åˆå§‹åŒ–æ­Œè©åŠŸèƒ½
      updateUIForLanguage();
      renderRegionButtons(); // ç¢ºä¿ç¸£å¸‚åˆ—è¡¨é¡¯ç¤º
      refreshMuteButtonLabel();
      // ç¢ºä¿æ’­æ”¾å™¨é™£åˆ—ä¸­çš„å…¶é¤˜éƒ¨åˆ†è¢«å¡«å……ç‚º null
      for (let i = numCams; i < MAX_PLAYERS; i++) {
        players[i] = null;
      }

      // è¨»å†Šå…¨è¢å¹•è®ŠåŒ–ç›£è½ï¼Œè§£æ±º ESC é€€å‡ºæ™‚ UI ä¸è¦‹çš„å•é¡Œ
      document.addEventListener("fullscreenchange", onFullscreenChange);
      document.addEventListener("webkitfullscreenchange", onFullscreenChange);
      document.addEventListener("mozfullscreenchange", onFullscreenChange);
      document.addEventListener("MSFullscreenChange", onFullscreenChange);
    }

    function onFullscreenChange() {
        if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && !document.msFullscreenElement) {
            document.body.classList.remove('fullscreen-active');
            document.getElementById('controls').style.display = 'flex';
        }
    }
    
    function initializeGridSettings() {
        // ç¢ºä¿ currentGridSize æ­£ç¢ºè®€å–
        currentGridSize = localStorage.getItem('gridSize') || '2x2';
        setGridSize(currentGridSize); // ç¢ºä¿ currentGridSize å’Œ body class è¨­ç½®æ­£ç¢º
        
        // é€™è£¡ä¸å†éœ€è¦é‡è¤‡æ›´æ–°æŒ‰éˆ• active ç‹€æ…‹ï¼Œå› ç‚º setGridSize å·²ç¶“è™•ç†ã€‚
    }

    function initializeLabelSettings() {
        const body = document.body;
        if (!isLabelsVisible) {
             body.classList.add('hide-labels');
        } else {
             body.classList.remove('hide-labels');
        }
    }

    function onPlayerReady(event) {
      // å¼·åŒ–ï¼šç¢ºä¿æ’­æ”¾å™¨è¼‰å…¥æˆåŠŸå¾Œï¼Œå¼·åˆ¶é–‹å§‹æ’­æ”¾ä¸¦éœéŸ³
      try {
        event.target.mute();
        event.target.setVolume(100);
        event.target.playVideo();
      } catch (e) {
          console.warn("Player ready failed to play or mute:", e);
      }
    }

    function onMusicPlayerReady() {
      isMusicReady = true;
      updateMediaSession();
    }
    
    /* ===== æ ¸å¿ƒä¿®æ­£ï¼šé»æ­Œé‚è¼¯ä¿®æ­£èˆ‡æ’­æ”¾å™¨ç‹€æ…‹è™•ç†å¼·åŒ– ===== */
    function onMusicPlayerStateChange(event) {
      if (!isPlaying) return;
      if (event.data == YT.PlayerState.PLAYING) {
        updatePlayPauseButton(true);
        // å¼€å§‹æ­Œè¯åŒæ­¥
        startLyricsSync();
        // è·å–å½“å‰æ­Œæ›²ä¿¡æ¯å¹¶è‡ªåŠ¨è·å–æ­Œè¯
        fetchCurrentSongLyrics();
      } else if (event.data == YT.PlayerState.PAUSED) {
        updatePlayPauseButton(false);
        // æš‚åœæ­Œè¯åŒæ­¥
        stopLyricsSync();
      } else if (event.data == YT.PlayerState.ENDED) {
        // åœæ­¢æ­Œè¯åŒæ­¥
        stopLyricsSync();
        updatePlayPauseButton(false);
        // æ ¸å¿ƒä¿®æ­£ 1: æ’­æ”¾å®Œç•¢å¾Œï¼Œæª¢æŸ¥æ˜¯å¦æœ‰å¾…æ’­æ¸…å–®
        if (pendingPlaylistId) {
            currentPlaylistId = pendingPlaylistId;
            pendingPlaylistId = null; // æ¸…é™¤å¾…æ’­æ¨™è¨˜
            
            // é–‹å§‹æ’­æ”¾æ¸…å–®
            musicQueue = [];
            currentMusicIndex = -1;
            musicPlayer.loadPlaylist({ list: currentPlaylistId, listType: 'playlist', index: 0, startSeconds: 0 });
            document.getElementById('musicControlsContainer').style.display = 'flex';
            isPlaying = true;
            updatePlayPauseButton(true);
            // èƒŒæ™¯æŠ“å–æ’­æ”¾æ¸…å–®çš„æ¯é¦– id + titleï¼Œå¡«å…… musicQueue
            loadPlaylistMetadata(currentPlaylistId);
            // ç­‰å¾…ä¸€ä¸‹å¾Œç²å–ç¬¬ä¸€é¦–æ­Œçš„æ­Œè©
            setTimeout(() => {
                fetchCurrentSongLyrics();
            }, 1000);
            return;
            // æ¸…å–®é–‹å§‹æ’­æ”¾ï¼ŒçµæŸå–®æ›²é‚è¼¯
        }
        
        // èˆŠæœ‰çš„æ¸…å–®/å–®æ›²æ’­æ”¾å®Œç•¢é‚è¼¯ (ç„¡å¾…æ’­æ¸…å–®æ™‚)
        if (currentPlaylistId) {
          const playlist = musicPlayer.getPlaylist();
          if (!playlist || playlist.length === 0) {
            stopMusic();
            return;
          }
          
          const idx = musicPlayer.getPlaylistIndex();
          if (playbackMode === 'shuffle') {
            let next;
            do { next = Math.floor(Math.random() * playlist.length); } while (playlist.length > 1 && next === idx);
            musicPlayer.playVideoAt(next);
          } else {
            const next = (idx + 1) % playlist.length;
            // å¦‚æœæ˜¯åˆ—è¡¨å¾ªç’°æ¨¡å¼ï¼Œä¸”åˆ°é”æœ€å¾Œä¸€é¦–ï¼Œæœƒå›åˆ°ç¬¬ä¸€é¦– (YouTube æ’­æ”¾æ¸…å–®å…§å»ºå¾ªç’°æ©Ÿåˆ¶å¯èƒ½ä¹Ÿæœƒè™•ç†)
            musicPlayer.playVideoAt(next);
          }
          // åˆ‡æ›æ­Œæ›²å¾Œç²å–æ–°æ­Œè©
          setTimeout(() => {
            fetchCurrentSongLyrics();
          }, 500);
        } else if (musicQueue.length > 0) {
          if (playbackMode === 'shuffle') {
            let nextIndex;
            do { nextIndex = Math.floor(Math.random() * musicQueue.length); } while (musicQueue.length > 1 && nextIndex === currentMusicIndex);
            currentMusicIndex = nextIndex;
          } else {
            currentMusicIndex = (currentMusicIndex + 1);
            if (playbackMode === 'listLoop') {
                currentMusicIndex = currentMusicIndex % musicQueue.length;
            }
          }
          
          if (currentMusicIndex < musicQueue.length) {
            loadAndPlayCurrentSong();
          } else {
            // æ’­æ”¾å®Œç•¢ä¸”éå¾ªç’°æ¨¡å¼ï¼Œåœæ­¢æ’­æ”¾
            stopMusic();
          }
        } else {
            stopMusic();
        }
      }
    }
    
    function stopMusic() {
        currentMusicIndex = -1;
        currentPlaylistId = null;
        pendingPlaylistId = null;
        isPlaying = false;
        currentSongTitle = '';
        stopLyricsSync();
        clearLyrics();
        try { musicPlayer.stopVideo();
        } catch(e) {}
        document.getElementById('musicControlsContainer').style.display = 'none';
        updatePlayPauseButton(false);
        updateMediaSession(null);
    }


    function handleStateChange(event, index) {
      const player = players[index];
      const state = streamState[index];
      
      if (!player || !state) return;

      if (event.data === YT.PlayerState.PLAYING) {
        // === ä¿®æ­£ï¼šç§»é™¤å¼·åˆ¶éœéŸ³é‚è¼¯ ===
        // åƒ…ç•¶è©²ç•«é¢æ˜¯ç›®å‰è¢«é¸å–çš„ç•«é¢æ™‚ï¼Œæ›´æ–°ä¸€ä¸‹æŒ‰éˆ•ç‹€æ…‹å³å¯ï¼Œä¸å¹²æ¶‰è²éŸ³
        if (index === selectedCamIndex) {
            refreshMuteButtonLabel();
        }
      } else if (event.data === YT.PlayerState.ENDED || event.data === YT.PlayerState.PAUSED || event.data === YT.PlayerState.BUFFERING) {
        // å¼·åŒ–é‡è¼‰é‚è¼¯ï¼šç•¶ç›´æ’­çµæŸ (ENDED)ã€æš«åœ (PAUSED)ã€æˆ–é•·æ™‚é–“ç·©è¡ (BUFFERING) æ™‚
        
        const now = Date.now();
        if (now - lastReloadAt[index] < RELOAD_COOLDOWN_MS) {
            if (event.data === YT.PlayerState.ENDED || event.data === YT.PlayerState.PAUSED) {
                 // å˜—è©¦ç°¡å–®æ’­æ”¾ã€‚
                 try { player.playVideo();
                 } catch (e) {}
            }
            return;
        }
        
        // åŸ·è¡Œå¼·åˆ¶é‡è¼‰
        isReloading[index] = true;
        lastReloadAt[index] = now;
        
        try {
            // ä½¿ç”¨ loadVideoById é€²è¡Œé‡è¼‰ï¼Œç¢ºä¿å¾é ­é–‹å§‹
            player.loadVideoById(state.id, 0);
            player.playVideo(); // ç«‹å³å˜—è©¦æ’­æ”¾
            
            console.log(`Cam ${index} state ${event.data} detected. Forced reload and play for ID: ${state.id}`);
            // é‡è¼‰æ™‚ç¶­æŒåŸæœ¬çš„éœéŸ³ç‹€æ…‹ (ä¸å¼·åˆ¶éœéŸ³)
            player.mute(); 

        } catch (e) {
            console.error(`Error forcing reload on Cam ${index}:`, e);
        }
        isReloading[index] = false;
      } else if (event.data === YT.PlayerState.CUED || event.data === YT.PlayerState.UNSTARTED) {
         // å½±ç‰‡è¢«æ’å…¥ä½‡åˆ—æˆ–æœªé–‹å§‹ï¼Œå¼·åˆ¶æ’­æ”¾
         try { player.playVideo();
         } catch(e) {}
      }
    }

    function escapeHtml(str) {
        if (!str) return '';
        return str.replace(/&/g, '&amp;')
                  .replace(/</g, '&lt;')
                  .replace(/>/g, '&gt;')
                  .replace(/"/g, '&quot;')
                  .replace(/'/g, '&#039;');
    }
    
    // é€é Google Data API å–å¾—å½±ç‰‡æ¨™é¡Œ
    async function fetchVideoTitle(videoId) {
        if (!videoId) return null;
        const url = `https://www.googleapis.com/youtube/v3/videos?id=${videoId}&part=snippet&key=${YT_DATA_API_KEY}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            if (data.items && data.items.length > 0) {
                return data.items[0].snippet.title;
            }
        } catch (e) {
            console.error("Error fetching video title:", e);
        }
        return null;
    }

    // é€é Google Data API é€²è¡Œé—œéµå­—æœå°‹
    async function searchByKeywords(query) {
        if (!query) return null;
        // é™åˆ¶ç‚º video, live, å°ç£åœ°å€ç›¸é—œæ€§
        const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${encodeURIComponent(query)}&type=video&videoSyndicated=true&videoEmbeddable=true&regionCode=TW&maxResults=1&key=${YT_DATA_API_KEY}`;
        try {
            const response = await fetch(url);
            const data = await response.json();
            if (data.items && data.items.length > 0) {
                const item = data.items[0];
                return {
                    id: item.id.videoId,
                    title: item.snippet.title
                };
            }
        } catch (e) {
            console.error("Error searching by keywords:", e);
        }
        return null;
    }
    
    function updateCamSelectButtons(numCams) {
        const camButtonsContainer = document.getElementById('camSelectButtons');
        // é‚è¼¯ 2 & 3 ä¿®æ­£: 1x1 ä¸é¡¯ç¤ºæŒ‰éˆ•ï¼Œå…¶ä»–æ¨¡å¼é¡¯ç¤ºä¸¦æ›´æ–°æŒ‰éˆ•åç¨±
        if (numCams === 1) {
             document.getElementById('pageBody').classList.add('hide-cam-select');
             camButtonsContainer.innerHTML = '';
        } else {
             document.getElementById('pageBody').classList.remove('hide-cam-select');
             camButtonsContainer.innerHTML = '';
             for (let i = 0; i < numCams; i++) {
                const btn = document.createElement('button');
                btn.id = `select-cam-${i}`;
                btn.className = (i === selectedCamIndex) ? 'active' : '';
                btn.setAttribute('onclick', `selectCam(${i})`);
                btn.innerText = getTranslation('cam_name', i);
                camButtonsContainer.appendChild(btn);
             }
        }
    }
    
    function selectCam(index) {
        const numCams = getGridDimension() * getGridDimension();
        if (index >= numCams) return;
        
        selectedCamIndex = index;
        
        // æ›´æ–°æŒ‰éˆ•æ¨£å¼ (å¦‚æœæŒ‰éˆ•é¡¯ç¤ºçš„è©±)
        const camButtonsContainer = document.getElementById('camSelectButtons');
        if (!document.getElementById('pageBody').classList.contains('hide-cam-select')) {
            for (let i = 0; i < numCams; i++) {
                const btn = document.getElementById(`select-cam-${i}`);
                if (btn) {
                    if (i === selectedCamIndex) {
                        btn.classList.add('active');
                    } else {
                        btn.classList.remove('active');
                    }
                }
            }
        }

        // === ä¿®æ­£ï¼šåˆ‡æ›é¸æ“‡æ™‚ï¼Œä¸å†å¼·åˆ¶éœéŸ³å…¶ä»–ç•«é¢ï¼Œä¹Ÿä¸è‡ªå‹•é–‹å•Ÿç•¶å‰ç•«é¢è²éŸ³ ===
        refreshMuteButtonLabel();
    }

    function toggleFullscreen() {
      const doc = document.documentElement;
      const controls = document.getElementById('controls');
      
      if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && !document.msFullscreenElement) {
        // é€²å…¥å…¨è¢å¹•
        if (doc.requestFullscreen) {
          doc.requestFullscreen();
        } else if (doc.mozRequestFullScreen) { // Firefox
          doc.mozRequestFullScreen();
        } else if (doc.webkitRequestFullscreen) { // Chrome, Safari and Opera
          doc.webkitRequestFullscreen();
        } else if (doc.msRequestFullscreen) { // IE/Edge
          doc.msRequestFullscreen();
        }
        document.body.classList.add('fullscreen-active');
        controls.style.display = 'none';
      } else {
        // é€€å‡ºå…¨è¢å¹•
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.mozCancelFullScreen) { // Firefox
          document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) { // Chrome, Safari and Opera
          document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) { // IE/Edge
          document.msExitFullscreen();
        }
        document.body.classList.remove('fullscreen-active');
        controls.style.display = 'flex';
      }
    }
    
    function getGridDimension() {
        return parseInt(currentGridSize.charAt(0));
    }

    function setGridSize(size) {
        if (!['1x1', '2x2', '3x3'].includes(size)) return;
        currentGridSize = size;
        localStorage.setItem('gridSize', size);
        const dimension = getGridDimension();
        const numCams = dimension * dimension;
        // 1. æ›´æ–° Stage Wrap çš„ CSS Class
        const stageWrap = document.getElementById('stageWrap');
        stageWrap.className = `stage-wrap grid-${size}`;

        // 2. é¡¯ç¤º/éš±è— Cell
        CELLS.forEach((cell, index) => {
            cell.style.display = index < numCams ? 'block' : 'none';
        });
        // 3. æ›´æ–°æ”å½±æ©Ÿé¸æ“‡æŒ‰éˆ•
        updateCamSelectButtons(numCams);
        // 4. æ›´æ–°è¨­å®šå½ˆçª—å…§çš„æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.grid-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        const activeGridBtn = document.getElementById(`grid${size.replace('x', '')}Btn`);
        if (activeGridBtn) {
            activeGridBtn.classList.add('active');
        }

        // 5. èª¿æ•´æ’­æ”¾å™¨ (ä¿ç•™ç¾æœ‰ç•«é¢é‚è¼¯)
        selectedCamIndex = 0;
        // åˆ‡æ›æ¨¡å¼æ™‚å…ˆå¼·åˆ¶å…¨åŸŸéœéŸ³ï¼Œé¿å…å¤šå€‹è²éŸ³æ··é›œï¼Œç”±ä½¿ç”¨è€…æ‰‹å‹•é–‹å•Ÿ
        isMuted = true;
        refreshMuteButtonLabel();
        const defaultStreams = [
            "å°åŒ—-è²“ç©ºæŒ‡å—å®®", "æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´", "å°ä¸­-é«˜ç¾æ¿•åœ°", "é«˜é›„-å£½å±±è§€æ™¯å°", 
            "å®œè˜­-å¤–æ¾³æ²™ç˜", "å˜‰ç¾©-å¥®èµ·æ¹–", "å°æ±-é¯‰é­šå±±", "æ–°åŒ—-æ¼äººç¢¼é ­", "é‡‘é–€-éº’éºŸå±±æ£®æ—å…¬åœ’"
        ];
        for (let i = 0; i < numCams; i++) {
            // === æ ¸å¿ƒä¿®æ­£ï¼šä¿ç•™ç¾æœ‰ç•«é¢ ===
            let keepState = streamState[i];
            let targetKey = keepState ? keepState.key : defaultStreams[i];
            let targetId = keepState ? keepState.id : (ALL_STREAMS[targetKey] ? ALL_STREAMS[targetKey].id : DEFAULT_VIDEO_ID);
            
            if (!keepState && ALL_STREAMS[targetKey]) {
                streamState[i] = { key: targetKey, ...ALL_STREAMS[targetKey] };
            }
            updateLabel(i);
            
            if (!players[i]) {
                // å¦‚æœæ’­æ”¾å™¨ä¸å­˜åœ¨ï¼Œå»ºç«‹æ–°çš„
                players[i] = new YT.Player(PLAYER_IDS[i], {
                    videoId: targetId,
                    playerVars: { autoplay: 1, controls: 0, modestbranding: 1, rel: 0, showinfo: 0, fs: 0, disablekb: 1, loop: 1, mute: 1, playsinline: 1, start: 0, iv_load_policy: 3, cc_load_policy: 0, origin: window.location.origin },
                    events: { onReady: onPlayerReady, onStateChange: (event) => handleStateChange(event, i) }
                });
            } else {
                // å¦‚æœæ’­æ”¾å™¨å­˜åœ¨
                try {
                    if (!keepState) {
                         players[i].loadVideoById(targetId, 0);
                    }
                    players[i].mute();
                } catch(e) { 
                    try { players[i].loadVideoById(targetId, 0);
                    } catch(err){}
                }
            }
        }
        
        // è™•ç†å¤šé¤˜çš„æ’­æ”¾å™¨
        for (let i = numCams; i < MAX_PLAYERS; i++) {
            if (players[i]) {
                try { players[i].mute();
                } catch(e) {} 
            }
        }
        
        updateCamSelectButtons(numCams);
    }
    
    // é–‹å•Ÿä¸»è¦è¨­å®šå½ˆçª—
    function openMainSettingsModal() {
        document.getElementById('mainSettingsModal').style.display = 'flex';
        document.getElementById('labelsToggleInModalBtn').innerText = document.body.classList.contains('hide-labels') 
            ? getTranslation('labels_toggle_show')
            : getTranslation('labels_toggle_hide');
    }
    
    // é—œé–‰ä¸»è¦è¨­å®šå½ˆçª—
    function closeMainSettingsModal() {
        document.getElementById('mainSettingsModal').style.display = 'none';
    }


    function toggleLabels() {
        const body = document.body;
        const labelsToggleBtn = document.getElementById('labelsToggleInModalBtn');

        if (body.classList.contains('hide-labels')) {
            body.classList.remove('hide-labels');
            isLabelsVisible = true;
            labelsToggleBtn.innerText = getTranslation('labels_toggle_hide');
            localStorage.setItem('hideLabels', 'false');
        } else {
            body.classList.add('hide-labels');
            isLabelsVisible = false;
            labelsToggleBtn.innerText = getTranslation('labels_toggle_show');
            localStorage.setItem('hideLabels', 'true');
        }
    }
    
    function refreshMuteButtonLabel() {
        const player = players[selectedCamIndex];
        let currentMuted = true; // é è¨­è¦–ç‚ºéœéŸ³

        // å˜—è©¦å‘ YouTube æ’­æ”¾å™¨è©¢å•ç›®å‰çš„éœéŸ³ç‹€æ…‹
        if (player && typeof player.isMuted === 'function') {
            try {
                currentMuted = player.isMuted();
            } catch(e) {}
        }

        // åŒæ­¥æ›´æ–° global è®Šæ•¸ (é›–ç„¶å¾ŒçºŒé‚è¼¯å·²ä¸å¤ªä¾è³´å®ƒï¼Œä½†ä¿æŒä¸€è‡´æ€§)
        isMuted = currentMuted; 

        const btn = document.getElementById('muteBtn');
        if (btn) {
            // ä¿®æ­£é‚è¼¯ï¼šå·²éœéŸ³æ™‚é¡¯ç¤ºã€Œè§£é™¤éœéŸ³ã€ï¼ŒæœªéœéŸ³æ™‚é¡¯ç¤ºã€ŒéœéŸ³ã€
            btn.innerText = currentMuted ? 
                getTranslation('mute_btn_unmuted') : 
                getTranslation('mute_btn_muted');
        }
    }
    
    function toggleMute() {
        const player = players[selectedCamIndex];
        if (!player) return;

        // ç«‹å³æ›´æ–°æŒ‰é’®çŠ¶æ€ï¼Œå‡å°‘å»¶è¿Ÿæ„Ÿ
        const btn = document.getElementById('muteBtn');
        let currentMuted = true;
        try {
            currentMuted = player.isMuted();
            if (currentMuted) {
                player.unMute(); // è§£é™¤éœéŸ³
                if (btn) btn.innerText = getTranslation('mute_btn_muted');
            } else {
                player.mute();   // éœéŸ³
                if (btn) btn.innerText = getTranslation('mute_btn_unmuted');
            }
        } catch(e) {
            console.warn("Toggle mute failed:", e);
        }
        
        // å¼‚æ­¥æ›´æ–°æŒ‰éˆ•æ–‡å­—ç‹€æ…‹ä»¥ç¡®ä¿å‡†ç¡®æ€§
        setTimeout(() => {
            refreshMuteButtonLabel();
        }, 100);
    }
    
    // çµ±ä¸€çš„æ™¯é»åç¨±ç¿»è­¯å‡½æ•¸
    function translateStreamName(label) {
        if (!label) return label;
        
        // å¦‚æœæ˜¯ä¸­æ–‡æˆ–ç°¡é«”ä¸­æ–‡ï¼Œç›´æ¥è¿”å›
        if (currentLang === 'zh-TW' || currentLang === 'zh-CN') {
            return label;
        }
        
        // å°æ–¼å…¶ä»–èªè¨€ï¼Œä½¿ç”¨è‹±æ–‡ç¿»è­¯ä½œç‚ºåŸºç¤
        let translated = label;
        const cityNames = CITY_NAMES[currentLang] || CITY_NAMES['en-US'];
        
        // å…ˆæª¢æŸ¥æ˜¯å¦æœ‰å®Œæ•´çš„è‹±æ–‡ç¿»è­¯
        if (currentLang === 'en-US' || currentLang === 'en-GB') {
            if (STREAM_NAME_EN[label]) {
                translated = STREAM_NAME_EN[label];
            } else {
                // æ›¿æ›åŸå¸‚åç¨±
                Object.keys(CITY_NAMES_EN).forEach(zh => {
                    if (translated.startsWith(zh)) {
                        translated = translated.replace(zh, cityNames[zh] || CITY_NAMES_EN[zh]);
                    }
                });
            }
        } else {
            // å°æ–¼å…¶ä»–èªè¨€ï¼Œå…ˆè½‰æ›ç‚ºè‹±æ–‡ï¼Œç„¶å¾Œå¯ä»¥æ ¹æ“šéœ€è¦é€²ä¸€æ­¥ç¿»è­¯
            // é€™è£¡å…ˆä½¿ç”¨è‹±æ–‡ç¿»è­¯ä½œç‚ºåŸºç¤
            let englishText = label;
            if (STREAM_NAME_EN[label]) {
                englishText = STREAM_NAME_EN[label];
            } else {
                Object.keys(CITY_NAMES_EN).forEach(zh => {
                    if (englishText.startsWith(zh)) {
                        englishText = englishText.replace(zh, CITY_NAMES_EN[zh]);
                    }
                });
            }
            // å°æ–¼éè‹±æ–‡èªè¨€ï¼Œæ›¿æ›åŸå¸‚åç¨±ç‚ºå°æ‡‰èªè¨€
            Object.keys(CITY_NAMES_EN).forEach(zh => {
                const enCity = CITY_NAMES_EN[zh];
                if (englishText.startsWith(enCity)) {
                    englishText = englishText.replace(enCity, cityNames[zh] || enCity);
                }
            });
            translated = englishText;
        }
        
        return translated;
    }
    
    // çµ±ä¸€çš„åŸå¸‚åç¨±ç¿»è­¯å‡½æ•¸
    function translateCityName(city) {
        const cityNames = CITY_NAMES[currentLang] || CITY_NAMES['zh-TW'];
        return cityNames[city] || city;
    }

    function updateLabel(index) {
        const labelElement = document.getElementById(`label${index}`);
        const sourceElement = labelElement ? labelElement.querySelector('.source-on-screen') : null;
        
        if (!labelElement) return;

        const state = streamState[index];
        if (state) {
            // ä½¿ç”¨çµ±ä¸€çš„ç¿»è­¯å‡½æ•¸
            let displayText = translateStreamName(state.label);

            labelElement.textContent = displayText || getTranslation('loading');
            if (sourceElement) {
                // ä¾†æºé »é“åä¸ç¿»è­¯
                sourceElement.textContent = `${getTranslation('source_prefix')} ${state.source || 'N/A'}`;
                labelElement.appendChild(sourceElement);
            }
        } else {
            labelElement.textContent = getTranslation('loading');
            if (sourceElement) {
                sourceElement.textContent = '';
                labelElement.appendChild(sourceElement);
            }
        }
        
        // æ›´æ–°åœ°åœ–ç´…é»
        updateMiniMapDot(index);
    }

    function setStream(streamKey) {
        const stream = ALL_STREAMS[streamKey];
        const index = selectedCamIndex;
        
        if (!stream || index >= MAX_PLAYERS) return;
        
        const player = players[index];
        if (!player) return;
        streamState[index] = { ...stream, key: streamKey };
        updateLabel(index);
        
        try {
            // å°æ–¼æ–°çš„ç›´æ’­ä¸²æµï¼Œä½¿ç”¨ loadVideoById
            player.loadVideoById(stream.id, 0);
            player.playVideo();
            // è¼‰å…¥æ–°å½±ç‰‡æ™‚ï¼Œé è¨­ä¿æŒåŸæœ¬çš„éœéŸ³è¨­å®šï¼ˆå¦‚æœæ˜¯ç›®å‰ç•«é¢ï¼Œæª¢æŸ¥ç‹€æ…‹ï¼‰
            if (index !== selectedCamIndex) {
                 player.mute();
            } else {
                 // é€™è£¡æˆ‘å€‘ä¸å¼·åˆ¶ unMuteï¼Œè€Œæ˜¯è®“ä»–è¼‰å…¥ï¼Œä½¿ç”¨è€…è‡ªå·±æ±ºå®šæ˜¯å¦æ‰“é–‹
            }
        } catch (e) {
            console.error(`Error loading video for index ${index}:`, e);
            streamState[index] = null;
            updateLabel(index);
        }
    }
    
    // ä¿®æ­£: ç¢ºä¿ç¸£å¸‚åˆ—è¡¨èƒ½å¤ æ­£ç¢ºæ¸²æŸ“
    function renderRegionButtons() {
      const container = document.getElementById('regionButtons');
      container.innerHTML = '';
      currentCity = null;
      
      const regions = Object.keys(REGION_GROUPS);
      regions.forEach(region => {
        const cities = REGION_GROUPS[region].filter(city => GROUPED_STREAMS[city] && GROUPED_STREAMS[city].length > 0);
        if (cities.length === 0) return;
        
        const regionLabel = document.createElement('span');
        regionLabel.className = 'region-label';
        // ç¿»è­¯å€åŸŸæ¨™ç±¤ (åŒ—éƒ¨ã€ä¸­éƒ¨...)
        let regionText = translateCityName(region);
        // æ ¹æ“šèªè¨€èª¿æ•´æ¨™é»ç¬¦è™Ÿ
        const colon = (currentLang === 'en-US' || currentLang === 'en-GB') ? ':' : 'ï¼š';
        regionLabel.textContent = regionText + colon;
        container.appendChild(regionLabel);

        cities.forEach(city => {
          const streams = GROUPED_STREAMS[city];
          if (streams.length > 0) {
            const cityBtn = document.createElement('button');
            cityBtn.className = 'city-btn';
            
            // ç¿»è­¯åŸå¸‚æŒ‰éˆ•
            let cityText = translateCityName(city);
            cityBtn.textContent = cityText;
            
            // ç¿»è­¯æŒ‰éˆ•æç¤ºæ–‡å­—
            cityBtn.title = getTranslation('city_btn_title', cityText);
            if (currentCity === city) {
               cityBtn.classList.add('active-city');
            }
            cityBtn.onclick = () => showCityStreams(city);
            container.appendChild(cityBtn);
          }
        });
      });
    }

    function showCityStreams(city) {
      const streams = GROUPED_STREAMS[city];
      if (!streams || streams.length === 0) return;
      currentCity = city;
      
      const container = document.getElementById('regionButtons');
      container.innerHTML = '';
      const backBtn = document.createElement('button');
      backBtn.className = 'back-btn';
      backBtn.textContent = getTranslation('back_btn'); 
      backBtn.title = getTranslation('back_btn');
      backBtn.onclick = renderRegionButtons;
      container.appendChild(backBtn);
      streams.forEach(stream => {
        const streamBtn = document.createElement('button');
        streamBtn.className = 'stream-btn';
        
        // ç¿»è­¯æ”å½±æ©Ÿåœ°é»æŒ‰éˆ•
        let btnText = translateStreamName(stream.label);
        
        streamBtn.textContent = btnText;
        // ä¾†æºé »é“åä¸ç¿»è­¯
        streamBtn.title = `${getTranslation('alert_playing_now')}${btnText} (${stream.source})`;
        streamBtn.onclick = () => setStream(stream.key);
        container.appendChild(streamBtn);
      });
    }

    function extractVideoId(urlOrId) {
        if (!urlOrId) return null;
        // æª¢æŸ¥æ˜¯å¦ç‚ºç´” ID
        if (urlOrId.length === 11 && !urlOrId.includes('/') && !urlOrId.includes('=')) {
            return urlOrId;
        }

        let videoId = null;
        try {
            const url = new URL(urlOrId.trim().startsWith('http') ? urlOrId.trim() : `http://${urlOrId.trim()}`);
            if (url.hostname.includes('youtube.com') || url.hostname.includes('youtu.be')) {
                if (url.pathname === '/watch') {
                    videoId = url.searchParams.get('v');
                } else if (url.pathname.length > 1) { 
                    videoId = url.pathname.substring(1).split('/')[0];
                }
            }
        } catch (e) {
            // å˜—è©¦è§£æå¤±æ•—ï¼Œå¯èƒ½æ˜¯ç„¡æ•ˆç¶²å€æˆ–ç´” ID 
        }

        // æœ€å¾Œæª¢æŸ¥ï¼Œç¢ºä¿ ID æ˜¯ 11 å€‹å­—ç¬¦
        if (videoId && videoId.length === 11) {
            return videoId;
        }
        return null;
    }

    async function fetchPlaylistItems(listId) {
        let items = [];
        let nextPageToken = null;
        
        do {
            const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${listId}&key=${YT_DATA_API_KEY}${nextPageToken ?
            `&pageToken=${nextPageToken}` : ''}`;
            const response = await fetch(url);
            const data = await response.json();
            if (data.items) {
                items = items.concat(data.items.map(item => ({
                    id: item.snippet.resourceId.videoId,
                    title: item.snippet.title
                })));
            }
            nextPageToken = data.nextPageToken;
        } while (nextPageToken);

        return items;
    }

    // è¼‰å…¥æ¸…å–®å…ƒæ•¸æ“šï¼Œæ›´æ–° musicQueue
    async function loadPlaylistMetadata(listId) {
        if (!listId) return;
        musicQueue = await fetchPlaylistItems(listId);
        
        // å¦‚æœæ¸…å–®å·²åœ¨æ’­æ”¾ï¼Œæ›´æ–° MediaSession
        if (currentPlaylistId === listId && musicQueue.length > 0) {
            const currentIdx = musicPlayer.getPlaylistIndex() || 0;
            const currentItem = musicQueue[currentIdx];
            if (currentItem) {
                updateMediaSession(currentItem.title);
            }
        }
    }


    function loadAndPlayCurrentSong() {
        if (currentMusicIndex < 0 || currentMusicIndex >= musicQueue.length) {
            console.error(getTranslation('alert_play_index_error'));
            stopMusic(); 
            return;
        }

        const currentSong = musicQueue[currentMusicIndex];
        currentPlaylistId = null; 
        pendingPlaylistId = null;
        currentSongTitle = currentSong.title || '';
        musicPlayer.loadVideoById(currentSong.id, 0);
        document.getElementById('musicControlsContainer').style.display = 'flex';
        isPlaying = true;
        updatePlayPauseButton(true);
        updateMediaSession(currentSong.title);
        
        // è‡ªåŠ¨è·å–æ­Œè¯
        fetchSongLyrics(currentSong.title);
    }
    
    /* ===== æ ¸å¿ƒä¿®æ­£ï¼šé»æ­Œé‚è¼¯ä¿®æ­£ `requestSong` å‡½å¼ ===== */
    async function requestSong() {
        const input = prompt(getTranslation('request_prompt'));
        if (!input) return;

        const isPlaylistRequest = input.includes('list=');
        let possibleId = extractVideoId(input);
        if (isPlaylistRequest) {
            let listId = null;
            try {
                const params = new URLSearchParams(input.split('?')[1] || '');
                listId = params.get('list') || possibleId; // æœ‰æ™‚ ID æœƒèª¤åˆ¤ç‚ºå½±ç‰‡ IDï¼Œä½†æ¸…å–®å„ªå…ˆ
            } catch (e) {
                listId = possibleId;
            }
            
            if (!listId) {
                alert(getTranslation('alert_invalid_playlist'));
                return;
            }

            if (currentPlaylistId === listId) {
                alert(getTranslation('alert_playlist_playing'));
                return;
            }
            
            // æª¢æŸ¥æ’­æ”¾å™¨æ˜¯å¦æ­£åœ¨å¿™ç¢Œ (æ­£åœ¨æ’­æ”¾å–®æ›²æˆ–æ¸…å–®)
            const isPlayerBusy = isPlaying && (musicPlayer.getPlayerState() === YT.PlayerState.PLAYING || musicPlayer.getPlayerState() === YT.PlayerState.BUFFERING || currentMusicIndex !== -1 || currentPlaylistId);
            if (isPlayerBusy) {
                // æ ¸å¿ƒä¿®æ­£ 2: å¦‚æœæ’­æ”¾å™¨æ­£åœ¨å¿™ç¢Œï¼Œå°‡æ–°æ¸…å–®è¨­ç‚ºå¾…æ’­
                pendingPlaylistId = listId;
                alert(getTranslation('alert_playlist_queued', listId));
                return;
            } 
            
            // æ’­æ”¾å™¨ä¸å¿™ç¢Œï¼Œç«‹å³é–‹å§‹æ’­æ”¾æ¸…å–®
            currentPlaylistId = listId;
            pendingPlaylistId = null;
            musicQueue = [];
            currentMusicIndex = -1;
            
            musicPlayer.loadPlaylist({ list: listId, listType: 'playlist', index: 0, startSeconds: 0 });
            document.getElementById('musicControlsContainer').style.display = 'flex';
            isPlaying = true;
            updatePlayPauseButton(true);
            
            loadPlaylistMetadata(listId);
            // æ’­æ”¾æ¸…å–®é–‹å§‹å¾Œï¼Œç­‰å¾…ä¸€ä¸‹å†ç²å–ç¬¬ä¸€é¦–æ­Œçš„æ­Œè©
            setTimeout(() => {
                fetchCurrentSongLyrics();
            }, 1000);
            alert(getTranslation('alert_playlist_loaded', listId));
            return;
        }

        // è™•ç†å–®æ›²é»æ­Œ (å½±ç‰‡ ID æˆ–é€£çµ)
        if (possibleId) {
            const id = possibleId;
            let title = await fetchVideoTitle(id);
            if (!title) title = id;
            
            musicQueue.push({ id, title });
            alert(getTranslation('alert_song_added', title));
            // å¦‚æœæ’­æ”¾å™¨é–’ç½®ï¼Œå‰‡ç«‹å³æ’­æ”¾ï¼›å¦å‰‡åƒ…åŠ å…¥ä½‡åˆ—ã€‚
            const isPlayerIdle = !isPlaying || musicPlayer.getPlayerState() !== YT.PlayerState.PLAYING;
            
            if (isPlayerIdle) {
                currentMusicIndex = currentMusicIndex === -1 ? 0 : musicQueue.length - 1;
                loadAndPlayCurrentSong();
            }

            document.getElementById('musicControlsContainer').style.display = 'flex';
            return;
        }

        // å¦å‰‡ç•¶ä½œé—œéµå­—æœå°‹
        const q = input.trim();
        if (!q) return;
        const result = await searchByKeywords(q);

        if (!result || !result.id) {
            alert(getTranslation('alert_no_video_found'));
            return;
        }

        const { id, title } = result;
        musicQueue.push({ id, title });
        alert(getTranslation('alert_found_and_added', title));

        // å¦‚æœæ’­æ”¾å™¨é–’ç½®ï¼Œå‰‡ç«‹å³æ’­æ”¾ï¼›å¦å‰‡åƒ…åŠ å…¥ä½‡åˆ—ã€‚
        const isPlayerIdle = !isPlaying || musicPlayer.getPlayerState() !== YT.PlayerState.PLAYING;
        if (isPlayerIdle) {
            currentMusicIndex = currentMusicIndex === -1 ? 0 : musicQueue.length - 1;
            loadAndPlayCurrentSong();
        }

        document.getElementById('musicControlsContainer').style.display = 'flex';
    }

    function updateMediaSession(title = 'éŸ³æ¨‚æ’­æ”¾å™¨') {
      if ('mediaSession' in navigator) {
          navigator.mediaSession.metadata = new MediaMetadata({
              title: title,
              artist: 'YouTube Music',
              album: currentPlaylistId ? `Playlist: ${currentPlaylistId}` : 'Queue',
          });
          navigator.mediaSession.setActionHandler('play', () => { playPauseSong(true); });
          navigator.mediaSession.setActionHandler('pause', () => { playPauseSong(false); });
          navigator.mediaSession.setActionHandler('previoustrack', skipToPreviousSong);
          navigator.mediaSession.setActionHandler('nexttrack', skipToNextSong);
      }
    }
    
    function updatePlayPauseButton(playing) {
        const btn = document.getElementById('playPauseBtn');
        if (btn) {
            btn.innerText = playing ? 'â¸ï¸' : 'â–¶ï¸';
            btn.title = playing ? getTranslation('music_pause_btn') : getTranslation('music_play_btn');
        }
    }

    function playPauseSong(forcePlay) {
        if (!isMusicReady) return;
        if (musicPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
            if (forcePlay === false) {
                 musicPlayer.pauseVideo();
            } else if (forcePlay === true) {
                 // Already playing
            } else {
                 musicPlayer.pauseVideo();
            }
        } else {
             if (musicQueue.length > 0 && currentMusicIndex === -1) {
                currentMusicIndex = 0;
                // å¦‚æœæ¸…å–®æœ‰æ­Œä½†ç´¢å¼•æ²’è¨­å®šï¼Œå¾é ­é–‹å§‹
             }
             if (currentMusicIndex !== -1 || currentPlaylistId) {
                musicPlayer.playVideo();
                isPlaying = true;
             } else {
                // å¦‚æœæ²’æœ‰æ­Œï¼Œå½ˆå‡ºé»æ­Œè¦–çª—
                requestSong();
            }
        }
    }

    function skipToNextSong() {
        if (!isMusicReady || !isPlaying) return;
        if (currentPlaylistId) {
            musicPlayer.nextVideo();
        } else if (musicQueue.length > 0) {
            let nextIndex = currentMusicIndex;
            if (playbackMode === 'shuffle') {
                do { nextIndex = Math.floor(Math.random() * musicQueue.length);
                } while (musicQueue.length > 1 && nextIndex === currentMusicIndex);
            } else {
                nextIndex = (currentMusicIndex + 1);
                if (playbackMode === 'listLoop') {
                    nextIndex = nextIndex % musicQueue.length;
                }
            }
            
            if (nextIndex < musicQueue.length) {
                currentMusicIndex = nextIndex;
                loadAndPlayCurrentSong();
            } else {
                stopMusic();
            }
        }
    }

    function skipToPreviousSong() {
        if (!isMusicReady || !isPlaying) return;
        if (currentPlaylistId) {
            musicPlayer.previousVideo();
        } else if (musicQueue.length > 0) {
            if (currentMusicIndex > 0) {
                currentMusicIndex--;
                loadAndPlayCurrentSong();
            } else {
                // å¦‚æœæ˜¯ç¬¬ä¸€é¦–ï¼Œå¯ä»¥è€ƒæ…®å›åˆ°æœ€å¾Œä¸€é¦–æˆ–åœæ­¢
                if (playbackMode === 'listLoop') {
                    currentMusicIndex = musicQueue.length - 1;
                    loadAndPlayCurrentSong();
                } else {
                    musicPlayer.seekTo(0);
                    // é‡æ–°æ’­æ”¾ç•¶å‰æ­Œæ›²
                }
            }
        }
    }

    function setPlaybackMode(mode) {
        playbackMode = mode;
        localStorage.setItem('playbackMode', mode);
        
        // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        document.getElementById('modeListLoop').classList.remove('active');
        document.getElementById('modeShuffle').classList.remove('active');
        document.getElementById(`mode${mode.charAt(0).toUpperCase() + mode.slice(1)}`).classList.add('active');
        // é—œé–‰ Modal
        closeMusicSettingsModal();
    }

    function openMusicSettingsModal() {
        // ç¢ºä¿æŒ‰éˆ•ç‹€æ…‹æ­£ç¢ºé¡¯ç¤º
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.getElementById(`mode${playbackMode.charAt(0).toUpperCase() + playbackMode.slice(1)}`).classList.add('active');
        
        document.getElementById('musicSettingsModal').style.display = 'flex';
    }
    
    function closeMusicSettingsModal() {
        document.getElementById('musicSettingsModal').style.display = 'none';
    }

    function stopAndCloseModal() {
        stopMusic();
        closeMusicSettingsModal();
    }

    function showMusicQueueStatusModal() {
        const queueContentDiv = document.getElementById('queueListContent');
        let content = '';
        
        const modeText = playbackMode === 'shuffle' ? getTranslation('mode_shuffle') : getTranslation('mode_list_loop');
        if (currentPlaylistId) {
            const playlist = (typeof musicPlayer.getPlaylist === 'function') ?
            musicPlayer.getPlaylist() : null;
            const idx = (typeof musicPlayer.getPlaylistIndex === 'function') ? musicPlayer.getPlaylistIndex() : -1;
            content = `<p style="color:#fff; font-size:14px; margin-top:0;"> 
                ${getTranslation('queue_playing_playlist')}<br> 
                <span style="color:#0078d7; word-break: break-all;">${currentPlaylistId}</span> 
            </p>`;
            if (!playlist || !Array.isArray(playlist) || playlist.length === 0) {
                content += `<p style="color:#aaa; font-size:12px;">${getTranslation('queue_list_empty')}</p>`;
            } else {
                content += `<p style="color:#fff; font-size:13px; margin:8px 0 6px;"> 
                    ${getTranslation('queue_total', musicQueue.length, idx + 1, modeText)}
                </p>`;
                if (idx < musicQueue.length - 1) {
                    content += `<p style="font-size:13px; color:#ccc;">${getTranslation('queue_next_video')} ${musicQueue[idx + 1] ?
                    escapeHtml(musicQueue[idx + 1].title) : 'N/A'}</p>`;
                }

                content += `<p style="color:#fff; font-weight:bold; margin-top:15px; margin-bottom:5px;">${getTranslation('queue_full_list')}</p>`;
                content += '<ul class="modal-list" style="list-style:none; padding:0; margin:0;">';
                musicQueue.forEach((item, index) => {
                    const isCurrent = index === idx;
                    content += `<li class="queue-item" style="background:${isCurrent ? 'rgba(0,120,215,0.12)' : 'transparent'};">
                        <button onclick="playPlaylistAtIndex(${index})" style="background:#222; border:1px solid #444; color:#fff; border-radius:6px; height:28px; padding:0 8px; cursor:pointer; flex-shrink:0;">
                            ${isCurrent ? getTranslation('queue_mode_current') : getTranslation('queue_mode_index', index)}
                        </button>
                        <div class="title">${(item && item.title) ? escapeHtml(item.title) : item.id}</div>
                        <div class="meta">ID:${item.id}</div>
                    </li>`;
                });
                content += '</ul>';
            }
        } else if (musicQueue.length > 0) {
            const isPlayingSingle = currentMusicIndex !== -1 && isPlaying;
            content += `<p style="color:#fff; font-size:14px; margin-top:0; text-align:center; border-bottom:1px solid #444; padding-bottom:10px;">
                ${getTranslation('queue_playing_queue')}
            </p>`;
            if (pendingPlaylistId) {
                content += `<p style="color:#d70000; font-size:13px; margin-top:10px; padding:8px; border:1px dashed #d70000; border-radius:4px; text-align:center;">
                    ${getTranslation('queue_playlist_pending', pendingPlaylistId)}
                </p>`;
            }
            
            content += `<p style="color:#fff; font-size:13px; margin:8px 0 6px;"> 
                ${getTranslation('queue_total', musicQueue.length, currentMusicIndex + 1, modeText)}
            </p>`;
            content += '<ul class="modal-list" style="list-style:none; padding:0; margin:0;">';
            musicQueue.forEach((item, index) => {
                const isCurrent = index === currentMusicIndex;
                content += `<li class="queue-item" style="background:${isCurrent ? 'rgba(0,120,215,0.12)' : 'transparent'};">
                    <button onclick="playQueueAtIndex(${index})" style="background:#222; border:1px solid #444; color:#fff; border-radius:6px; height:28px; padding:0 8px; cursor:pointer; flex-shrink:0;">
                        ${isCurrent ? getTranslation('queue_mode_current') : getTranslation('queue_mode_index', index)}
                    </button>
                    <div class="title">${(item && item.title) ? escapeHtml(item.title) : item.id}</div>
                    <div class="meta">ID:${item.id}</div>
                </li>`;
            });
            content += '</ul>';
        } else {
            if (pendingPlaylistId) {
                content += `<p style="color:#d70000; font-size:13px; margin-top:10px; padding:8px; border:1px dashed #d70000; border-radius:4px; text-align:center;">
                    ${getTranslation('queue_playlist_pending', pendingPlaylistId)}
                </p>`;
            }
            content += `<p style="color:#aaa; font-size:14px; text-align:center;">${getTranslation('queue_empty_queue')}</p>`;
        }
        
        queueContentDiv.innerHTML = content;
        document.getElementById('musicQueueModal').style.display = 'flex';
    }

    function closeMusicQueueModal() {
      document.getElementById('musicQueueModal').style.display = 'none';
    }

    function playPlaylistAtIndex(index) {
      if (!currentPlaylistId) return;
      try {
        musicPlayer.playVideoAt(index);
        // åˆ·æ–°æ’­æ”¾åˆ—è¡¨çŠ¶æ€æ˜¾ç¤º
        setTimeout(() => {
          showMusicQueueStatusModal();
        }, 500);
      } catch (e) {
        musicPlayer.playVideo();
      }
    }

    function playQueueAtIndex(index) {
      if (index < 0 || index >= musicQueue.length) return;
      currentMusicIndex = index;
      loadAndPlayCurrentSong();
      // åˆ·æ–°æ’­æ”¾åˆ—è¡¨çŠ¶æ€æ˜¾ç¤º
      setTimeout(() => {
        showMusicQueueStatusModal();
      }, 500);
    }

    /* ========================================= */
    /* æ–°å¢ï¼šåœ°åœ–åº§æ¨™èˆ‡æ§åˆ¶é‚è¼¯ */
    /* ========================================= */

    // è¨­å®šï¼šæ˜¯å¦é¡¯ç¤ºåœ°åœ– (è®€å– LocalStorage)
    let isMiniMapVisible = localStorage.getItem('showMiniMap') !== 'false'; // é è¨­ç‚º true (é¡¯ç¤º)

    // å°ç£åœ°åœ–åº§æ¨™å®šç¾© (ç™¾åˆ†æ¯” %ï¼šTop, Left)
    const REGION_COORDINATES = {
        'å°åŒ—': { top: 5, left: 78 },
        'æ–°åŒ—': { top: 8, left: 75 }, // æ¦‚ç•¥ä¸­å¿ƒ
        'åŸºéš†': { top: 3, left: 82 },
        'æ¡ƒåœ’': { top: 12, left: 68 },
        'æ–°ç«¹': { top: 18, left: 62 },
        'è‹—æ —': { top: 25, left: 55 },
        'å°ä¸­': { top: 35, left: 45 },
        'å½°åŒ–': { top: 40, left: 40 },
        'å—æŠ•': { top: 45, left: 55 },
        'é›²æ—': { top: 50, left: 35 },
        'å˜‰ç¾©': { top: 60, left: 35 },
        'å°å—': { top: 70, left: 30 },
        'é«˜é›„': { top: 78, left: 35 },
        'å±æ±': { top: 85, left: 45 },
        'å®œè˜­': { top: 20, left: 85 },
        'èŠ±è“®': { top: 45, left: 80 },
        'å°æ±': { top: 75, left: 60 },
        'é‡‘é–€': { top: 15, left: 10 }, 
        'é¦¬ç¥–': { top: 5, left: 15 },
        'æ¾æ¹–': { top: 60, left: 10 },
        'å…¶ä»–': { top: 50, left: 50 }
    };

    // æ‰€æœ‰æ™¯é»çš„ç²¾ç¢ºåº§æ¨™ï¼ˆåŸºæ–¼å°ç£åœ°åœ–å¯¦éš›ä½ç½®ï¼‰
    const SPOT_COORDINATES = {
        // å°åŒ—
        "å°åŒ—-è±¡å±±çœ‹101": { top: 6, left: 79 },
        "å°åŒ—-å¤§ç¨»åŸ•": { top: 7, left: 78 },
        "å°åŒ—-ç¢§å±±å·–": { top: 5, left: 79 },
        "å°åŒ—-å¾®é¢¨å¹³å°": { top: 6, left: 78 },
        "å°åŒ—-è²“ç©ºæŒ‡å—å®®": { top: 5, left: 78 },
        "å°åŒ—-æ“å¤©å²¡è‰åŸ": { top: 4, left: 78 },
        "å°åŒ—-é™½æ˜æ›¸å±‹": { top: 4, left: 78 },
        "å°åŒ—-é çœºä¸ƒæ˜Ÿå±±": { top: 4, left: 78 },
        "å°åŒ—-äºŒåªå­åœè»Šå ´": { top: 4, left: 78 },
        "å°åŒ—-å¤§å±¯è‡ªç„¶å…¬åœ’": { top: 4, left: 78 },
        "å°åŒ—-å°æ²¹å‘åœè»Šå ´": { top: 4, left: 78 },
        "å°åŒ—-å†·æ°´å‘åœè»Šå ´": { top: 4, left: 78 },
        // æ–°åŒ—
        "æ–°åŒ—-æ¼äººç¢¼é ­": { top: 8, left: 76 },
        "æ–°åŒ—-é¼»é ­æœå‹™å€": { top: 6, left: 80 },
        "æ–°åŒ—-ä¸­è§’ç£": { top: 7, left: 77 },
        "æ–°åŒ—-ååˆ†ç€‘å¸ƒå…¬åœ’": { top: 7, left: 77 },
        "æ–°åŒ—-ä¹ä»½": { top: 6, left: 79 },
        "æ–°åŒ—-å…§æ´åœ‹å®¶æ£®æ—éŠæ¨‚å€": { top: 9, left: 77 },
        "æ–°åŒ—-ä¸‰å³½è€è¡—åŒ—æ®µ": { top: 10, left: 74 },
        "æ–°åŒ—-ä¸‰å³½è€è¡—å—æ®µ": { top: 10, left: 74 },
        "æ–°åŒ—-çƒä¾†åŠæ©‹": { top: 9, left: 76 },
        "æ–°åŒ—-å“¡å±±å­": { top: 8, left: 75 },
        "æ–°åŒ—-æ–‡å±±è¾²å ´å¤§è‰çš®": { top: 9, left: 76 },
        // åŸºéš†
        "åŸºéš†-å¤–æœ¨å±±": { top: 3, left: 81 },
        // æ–°ç«¹
        "æ–°ç«¹-æˆåŠŸæ¹–": { top: 18, left: 62 },
        "æ–°ç«¹-å¤§è‰åª": { top: 18, left: 62 },
        // æ¡ƒåœ’
        "æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´": { top: 12, left: 68 },
        "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´å—è·‘é“": { top: 12, left: 68 },
        "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´åŒ—è·‘é“": { top: 12, left: 68 },
        "æ¡ƒåœ’-æ°¸å®‰æ¼æ¸¯": { top: 13, left: 67 },
        "æ¡ƒåœ’-æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ": { top: 15, left: 70 },
        "æ¡ƒåœ’-è™é ­å±±ç’°ä¿å…¬åœ’": { top: 12, left: 69 },
        "æ¡ƒåœ’-å°çƒä¾†å¤©ç©ºæ­¥é“": { top: 14, left: 70 },
        "æ¡ƒåœ’-è§’æ¿å±±æ€è¦ªäº­": { top: 14, left: 70 },
        "æ¡ƒåœ’-ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°": { top: 14, left: 70 },
        "æ¡ƒåœ’-å¤§æºªæ©‹": { top: 12, left: 69 },
        "æ¡ƒåœ’-è™é ­å±±å¥§çˆ¾æ£®æ—å­¸å ‚": { top: 12, left: 69 },
        "æ¡ƒåœ’-è§’æ¿å±±æ¢…åœ’": { top: 14, left: 70 },
        "æ¡ƒåœ’-è§’æ¿å±±ç”Ÿæ…‹æ± ": { top: 14, left: 70 },
        "æ¡ƒåœ’-å¤§æºªè€è¡—": { top: 12, left: 69 },
        "æ¡ƒåœ’-çŸ³é–€æ°´åº«": { top: 13, left: 70 },
        "æ¡ƒåœ’-æ…ˆæ¹–æ°´å²¸å»£å ´": { top: 13, left: 70 },
        "æ¡ƒåœ’-é˜¿å§†åªè–‘æ¯å³¶": { top: 13, left: 70 },
        "æ¡ƒåœ’-ä¸Šå·´é™µ": { top: 15, left: 70 },
        "æ¡ƒåœ’-æ¡ƒåœ’åœ‹éš›æ©Ÿå ´å‡±æ‚…é…’åº—": { top: 12, left: 68 },
        "æ¡ƒåœ’-å°çƒä¾†å¯°å®‡å¹³å°": { top: 14, left: 70 },
        "æ¡ƒåœ’-è¨±åæ¸¯æ¿•åœ°": { top: 13, left: 68 },
        "å…¶ä»–-è“®è¯å¯ºæ­£æ®¿1": { top: 12, left: 69 }, // è“®è¯å¯ºåœ¨æ¡ƒåœ’
        "å…¶ä»–-è“®è¯å¯ºæ­£æ®¿2": { top: 12, left: 69 }, // è“®è¯å¯ºåœ¨æ¡ƒåœ’
        // å®œè˜­
        "å®œè˜­-å¤–æ¾³æ²™ç˜": { top: 20, left: 85 },
        "å®œè˜­-ç¦éš†æµ·æ°´æµ´å ´": { top: 19, left: 84 },
        "å®œè˜­-çŸ³åŸæ¼æ¸¯": { top: 20, left: 85 },
        "å®œè˜­-ç„¡å°¾æ¸¯": { top: 21, left: 84 },
        "å®œè˜­-çŸ³åŸæ¼æ¸¯": { top: 20, left: 85 },
        "å®œè˜­-ç¤æºªå¯’æ²é…’åº—": { top: 20, left: 84 },
        // è‹—æ —
        "è‹—æ —-æ±¶æ°´éŠå®¢ä¸­å¿ƒ(é›ªéœ¸)": { top: 25, left: 55 },
        "è‹—æ —-è§€éœ§éŠæ†©å€(é›ªéœ¸)": { top: 24, left: 56 },
        "è‹—æ —-é›ªè¦‹éŠæ†©å€(é›ªéœ¸)": { top: 25, left: 55 },
        // å°ä¸­
        "å°ä¸­-é«˜ç¾æ¿•åœ°": { top: 35, left: 45 },
        "å°ä¸­-æœ›é«˜å¯®": { top: 35, left: 45 },
        // å½°åŒ–
        "å½°åŒ–-ç‹åŠŸæ¼æ¸¯": { top: 40, left: 40 },
        // å—æŠ•
        "å—æŠ•-åˆæ­¡å±±æ­¦å¶ºäº­": { top: 40, left: 60 },
        // å˜‰ç¾©
        "å˜‰ç¾©-å¥®èµ·æ¹–": { top: 58, left: 48 },
        "å˜‰ç¾©-äºŒå»¶å¹³æ­¥é“": { top: 58, left: 48 },
        "å˜‰ç¾©-å¤ªå¹³é›²æ¢¯": { top: 58, left: 48 },
        "å˜‰ç¾©-è§¸å£éŠå®¢ä¸­å¿ƒ": { top: 60, left: 35 },
        "å˜‰ç¾©-æ„›æƒ…å¤§è‰åŸ": { top: 58, left: 48 },
        "å˜‰ç¾©-ç”ŸåŠ›è¾²å ´": { top: 58, left: 48 },
        "å˜‰ç¾©-é‡Œä½³è³‡è¨Šç«™": { top: 58, left: 48 },
        // å°å—
        "å°å—-ä¸ƒè‚¡è³é³¥å°": { top: 70, left: 30 },
        "å°å—-åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€": { top: 70, left: 30 },
        "å°å—-æ›¾æ–‡æ°´åº«": { top: 68, left: 38 },
        "å°å—-ç«å±±ç¢§é›²å¯º": { top: 69, left: 32 },
        // é«˜é›„
        "é«˜é›„-æ¥ æ¢“è–èˆˆæ©‹": { top: 78, left: 35 },
        "é«˜é›„-èšµå¯®åœ‹å°": { top: 79, left: 34 },
        "é«˜é›„-æ——æ´¥æµ·æ°´æµ´å ´": { top: 78, left: 35 },
        "é«˜é›„-å£½å±±è§€æ™¯å°": { top: 78, left: 35 },
        "é«˜é›„-è“®æ± æ½­": { top: 78, left: 35 },
        "é«˜é›„-é«˜é›„ç‡ˆå¡”": { top: 78, left: 35 },
        "é«˜é›„-æ——æ´¥æ²™ç˜": { top: 78, left: 35 },
        // å±æ±
        "å±æ±-ç¾Œå…‰æ©‹": { top: 85, left: 45 },
        "å±æ±-å¢¾ä¸å—ç£": { top: 96, left: 55 },
        "å±æ±-èˆ¹å¸†çŸ³": { top: 97, left: 56 },
        "å±æ±-èˆ¹å¸†çŸ³æ²™ç˜": { top: 97, left: 56 },
        "å±æ±-é›€é¯›å…¬å¯“": { top: 96, left: 55 },
        "å±æ±-é ‚æµå€": { top: 96, left: 55 },
        "å±æ±-è»¸å­”å…¬åœ’": { top: 96, left: 55 },
        "å±æ±-æ–æ›³å¤§è‰åŸ": { top: 96, left: 55 },
        // èŠ±è“®
        "èŠ±è“®-é¦¬å¤ªéæºªå·¦å²¸": { top: 45, left: 80 },
        "èŠ±è“®-ä¸ƒæ˜Ÿæ½­": { top: 45, left: 80 },
        "èŠ±è“®-çŸ³æ¢¯åª": { top: 48, left: 82 },
        "èŠ±è“®-å¤§çŸ³é¼»å±±": { top: 48, left: 82 },
        "èŠ±è“®-é•·è™¹æ©‹": { top: 50, left: 83 },
        // å°æ±
        "å°æ±-é¯‰é­šå±±": { top: 75, left: 60 },
        "å°æ±-é‡‘å´™å¤§æ©‹": { top: 80, left: 62 },
        "å°æ±-é‡‘æ¨½è§€æµª": { top: 76, left: 61 },
        "å°æ±-å¯Œå±±": { top: 76, left: 61 },
        "å°æ±-æ‰åŸç£": { top: 76, left: 61 },
        "å°æ±-å¯Œå²¡æ¼æ¸¯": { top: 75, left: 60 },
        "å°æ±-è¯æºæ›™å…‰è§€æ™¯å°": { top: 79, left: 62 },
        "å°æ±-å—æ©«åŸ¡å£": { top: 72, left: 58 },
        "å°æ±-æ± ä¸Šå¤©å ‚è·¯": { top: 72, left: 58 },
        "å°æ±-å¤šè‰¯è»Šç«™": { top: 81, left: 63 },
        "å°æ±-é¹¿é‡é«˜å°": { top: 73, left: 59 },
        "å°æ±-æˆåŠŸä¸‰ä»™å°": { top: 74, left: 61 },
        "å°æ±-é‡‘æ¨½éŠæ†©å€": { top: 76, left: 61 },
        "å°æ±-éƒ½æ­·éŠå®¢ä¸­å¿ƒ": { top: 75, left: 61 },
        "å°æ±-åŠ è·¯è˜­éŠæ†©å€": { top: 75, left: 60 },
        "å°æ±-ç¶ å³¶å—å¯®": { top: 78, left: 65 },
        "å°æ±-ç¶ å³¶å¸†èˆ¹é¼»": { top: 78, left: 65 },
        "å°æ±-ç¶ å³¶æŸ´å£æµ®æ½›å€": { top: 78, left: 65 },
        "å°æ±-å¨œè·¯å½é…’åº—": { top: 75, left: 60 },
        // é‡‘é–€
        "é‡‘é–€-éº’éºŸå±±æ£®æ—å…¬åœ’": { top: 15, left: 10 },
        "é‡‘é–€-134é«˜åœ°": { top: 15, left: 10 },
        "é‡‘é–€-å»ºåŠŸå¶¼": { top: 15, left: 10 },
        // é¦¬ç¥–
        "é¦¬ç¥–-åŒ—ç«¿èˆªç©ºç«™ä¼‘æ¯å®¤": { top: 5, left: 15 },
        // å…¶ä»–ï¼ˆåœ°éœ‡ç›´æ’­ä¸ç”¨åº§æ¨™ï¼Œæ©Ÿå ´è³‡è¨Šç”¨æ©Ÿå ´åº§æ¨™ï¼‰
        "å…¶ä»–-æ¾å±±æ©Ÿå ´èˆªç­è³‡è¨Š": { top: 6, left: 78 },
        "å…¶ä»–-é«˜é›„æ©Ÿå ´èˆªç­è³‡è¨Š": { top: 78, left: 35 },
        "å…¶ä»–-æ¡ƒåœ’æ©Ÿå ´èˆªç­è³‡è¨Š": { top: 12, left: 68 },
        "å…¶ä»–-æ¡ƒåœ’æ©Ÿå ´ç•«é¢/è³‡è¨Š": { top: 12, left: 68 }
        // æ³¨æ„ï¼šåœ°éœ‡ç›£æ¸¬ç›´æ’­ä¸ä½¿ç”¨åº§æ¨™
    };

    // åˆå§‹åŒ–åœ°åœ–è¨­å®š
    function initializeMiniMapSettings() {
        const body = document.body;
        const btn = document.getElementById('mapsToggleBtn');
        
        if (!isMiniMapVisible) {
            body.classList.add('hide-mini-maps');
            if(btn) btn.innerText = getTranslation('maps_toggle_hide');
        } else {
            body.classList.remove('hide-mini-maps');
            if(btn) btn.innerText = getTranslation('maps_toggle_show');
        }
        
        // åˆå§‹è¼‰å…¥æ™‚æ›´æ–°æ‰€æœ‰æ ¼å­åœ°åœ–
        for(let i=0; i<MAX_PLAYERS; i++) {
            updateMiniMapDot(i);
        }
    }

    // åˆ‡æ›åœ°åœ–é–‹é—œ
    function toggleMiniMaps() {
        const body = document.body;
        const btn = document.getElementById('mapsToggleBtn');

        if (isMiniMapVisible) {
            // è®Šç‚ºéš±è—
            body.classList.add('hide-mini-maps');
            isMiniMapVisible = false;
            btn.innerText = getTranslation('maps_toggle_hide');
            localStorage.setItem('showMiniMap', 'false');
        } else {
            // è®Šç‚ºé¡¯ç¤º
            body.classList.remove('hide-mini-maps');
            isMiniMapVisible = true;
            btn.innerText = getTranslation('maps_toggle_show');
            localStorage.setItem('showMiniMap', 'true');
        }
    }

    // æ›´æ–°å–®ä¸€æ ¼å­çš„åœ°åœ–ç´…é»
    function updateMiniMapDot(index) {
        const state = streamState[index];
        const dot = document.getElementById(`mapDot${index}`);
        
        if (!dot) return;

        if (!state) {
            dot.style.display = 'none';
            return;
        }

        // åœ°éœ‡ç›£æ¸¬ç›´æ’­ä¸ä½¿ç”¨åº§æ¨™
        if (state.key && state.key.includes('åœ°éœ‡ç›£æ¸¬ç›´æ’­')) {
            dot.style.display = 'none';
            return;
        }

        dot.style.display = 'block';
        
        let coords = { top: 50, left: 50 }; // é è¨­å€¼

        // 1. å…ˆæŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šæ™¯é»ç²¾ç¢ºåº§æ¨™
        if (SPOT_COORDINATES[state.key]) {
            coords = SPOT_COORDINATES[state.key];
        } 
        // 2. å¦å‰‡æ ¹æ“šã€Œç¸£å¸‚åç¨±ã€æŸ¥é€šç”¨åº§æ¨™
        else {
            const cityName = state.key.split('-')[0]; // ä¾‹å¦‚ "å°åŒ—"
            if (REGION_COORDINATES[cityName]) {
                coords = REGION_COORDINATES[cityName];
            }
        }

        // 3. å¥—ç”¨åº§æ¨™
        dot.style.top = `${coords.top}%`;
        dot.style.left = `${coords.left}%`;
    }
    
    
  </script>
</body>
</html>
