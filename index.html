<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <title>å°ç£å³æ™‚ç›´æ’­å››åˆ†å‰²ç›£çœ‹ (æœ€çµ‚ API æœ€å°åŒ–åƒæ•¸ç‰ˆ)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* ========================================
     * åŸºç¤ CSS æ¨£å¼
     * ======================================== */
    html,body{
      height:100%; margin:0; padding:0; background:#000;
      font-family: system-ui, sans-serif; color:#fff; overflow:hidden;
    }
    .controls{
      position:fixed; bottom:0; left:0; width:100%; height:70px; 
      background:rgba(12,12,12,0.9); color:#fff; padding:5px 10px; 
      box-sizing:border-box; 
      display:flex; flex-direction:row; align-items: center; 
      gap:10px; 
      z-index:999;
      overflow-y: hidden;
    }

    /* æ»¾å‹•æ¢æ¨£å¼ */
    .controls::-webkit-scrollbar{ height: 4px; background-color: rgba(255, 255, 255, 0.1); }
    .controls::-webkit-scrollbar-thumb { background-color: #555; border-radius: 2px; }
    .row{ display:flex; flex-wrap:nowrap; gap:6px; align-items: center; flex-shrink: 0; }
    .divider { width: 1px; height: 80%; background: #333; flex-shrink: 0; margin: 0; }
    .controls #regionButtons{
        display:flex; flex-grow: 1; min-width: 0; gap:4px;
        overflow-x: auto; padding-bottom: 5px; height: 100%; align-items: center;
    }
    .controls button{
      background-color:#222; color:#fff; border:1px solid #444;
      padding:4px 8px; font-size:12px; cursor:pointer; border-radius:4px;
      height: 40px; flex-shrink: 0; white-space: nowrap; text-align: center;
    }
    .controls button.active{
      background-color:#0099ff; border-color:#0099ff;
    }
    .controls button.back-button { background-color: #555; }

    /* 2. å½±ç‰‡èˆå°æ¨£å¼ */
    .stage-wrap{
      position:fixed; top:0; left:0; width:100vw; height:calc(100vh - 70px);
      display:grid; grid-template-columns:1fr 1fr; grid-template-rows:1fr 1fr;
      gap:0; z-index:1;
    }
    .cell{
      position:relative; width:100%; height:100%; overflow:hidden;
    }
    
    /* YouTube è£åˆ‡ CSS */
    .player-container, .player-container iframe {
      position:absolute; inset:0; width:100%; height:100%; border:0; display:block;
      object-fit:cover; object-position:center; background:black;
      transform: scale(1.65) translateY(-6%); 
    }
    
    .cell iframe { pointer-events: auto !important; }
    .interaction-shield {
        position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        z-index: 5; background: transparent; cursor: default; 
    }
    .label{
      position:absolute; left:8px; right:8px; bottom:8px; display:flex;
      flex-direction: column; align-items:flex-start; padding: 3px 6px; 
      font-size:14px; color:#fff; background:rgba(0,0,0,0.6); border-radius:3px;
      pointer-events:none; z-index:10; 
    }
    .source-on-screen { font-size: 10px; color: #ccc; margin-top: 1px; line-height: 1.2; }

    /* å–®ç¨çš„è²éŸ³æ§åˆ¶æŒ‰éˆ•æ¨£å¼ (æµ®å‹•æ–¼ç•«é¢å³ä¸Šè§’) */
    .sound-control-per-cam {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 15;
      background: rgba(12, 12, 12, 0.6);
      color: white;
      border: 1px solid #444;
      padding: 5px 8px;
      cursor: pointer;
      border-radius: 4px;
      font-size: 14px;
      width: 40px; 
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* æ–°å¢ï¼šé€€å‡ºå…¨è¢å¹•æŒ‰éˆ•æ¨£å¼ (éš±è—ä¸”ä½æ–¼å³ä¸‹è§’) */
    #exitFullscreenButton {
        position: fixed;
        bottom: 10px;
        right: 10px;
        z-index: 1000; 
        background: rgba(12, 12, 12, 0.7);
        color: #fff;
        border: 1px solid #777;
        padding: 8px 15px;
        font-size: 14px;
        cursor: pointer;
        border-radius: 4px;
        display: none; /* é è¨­éš±è— */
    }
    
  </style>
</head>
<body>
  <div class="controls" id="controls">
    <div class="row cam-select">
      <button id="select-cam-0" class="active" onclick="selectCam(0)">å·¦ä¸Š</button>
      <button id="select-cam-1" onclick="selectCam(1)">å³ä¸Š</button>
      <button id="select-cam-2" onclick="selectCam(2)">å·¦ä¸‹</button>
      <button id="select-cam-3" onclick="selectCam(3)">å³ä¸‹</button>
    </div>
    <div class="divider"></div>
    <div class="row sound-control">
      <button id="control-sound-toggle" onclick="toggleSelectedCamSound()">ğŸ”‡ é–‹å•Ÿè²éŸ³</button>
    </div>
    <div class="divider"></div>
    <div class="row fullscreen-control">
        <button id="fullscreen-toggle" onclick="toggleFullscreen()">å…¨è¢å¹• ğŸ—–</button>
    </div>
    <div class="divider"></div>
    <div class="row" id="latencyInfo" style="color:#f90; font-size:12px; margin-left:5px; flex-shrink:0;">
        å»¶é²ï¼šè®€å–ä¸­...
    </div>
    <div class="divider"></div>
    <div class="row" id="regionButtons">
    </div>
  </div>

  <div class="stage-wrap" id="stageWrap">
    <div class="cell" data-index="0">
      <div id="player0" class="player-container"></div>
      <button class="sound-control-per-cam" id="sound0" onclick="togglePlayerSound(0)">ğŸ”‡</button> 
      <div class="interaction-shield"></div>
      <div class="label" id="label0">è¼‰å…¥ä¸­...</div>
    </div>
    <div class="cell" data-index="1">
      <div id="player1" class="player-container"></div>
      <button class="sound-control-per-cam" id="sound1" onclick="togglePlayerSound(1)">ğŸ”‡</button> 
      <div class="interaction-shield"></div>
      <div class="label" id="label1">è¼‰å…¥ä¸­...</div>
    </div>
    <div class="cell" data-index="2">
      <div id="player2" class="player-container"></div>
      <button class="sound-control-per-cam" id="sound2" onclick="togglePlayerSound(2)">ğŸ”‡</button> 
      <div class="interaction-shield"></div>
      <div class="label" id="label2">è¼‰å…¥ä¸­...</div>
    </div>
    <div class="cell" data-index="3">
      <div id="player3" class="player-container"></div>
      <button class="sound-control-per-cam" id="sound3" onclick="togglePlayerSound(3)">ğŸ”‡</button> 
      <div class="interaction-shield"></div>
      <div class="label" id="label3">è¼‰å…¥ä¸­...</div>
    </div>
  </div>

  <button id="exitFullscreenButton" onclick="toggleFullscreen()">ğŸ—— é€€å‡ºå…¨è¢å¹•</button>

  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    // ========================================
    // æ•¸æ“šå±¤ (å·²åŠ ä¸Šåœ°ç†å€å¡Šæ¨™ç¤º)
    // ========================================
    const ALL_STREAMS = {
        "åŒ—éƒ¨|å°åŒ—-è±¡å±±çœ‹101": {"id": "z_fY1pj1VBw", "label": "å°åŒ—è±¡å±±", "source": "Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
        "åŒ—éƒ¨|å°åŒ—-å¤§ç¨»åŸ•": {"id": "Ndo_8RuefH4", "label": "å¤§ç¨»åŸ•", "source": "Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
        "åŒ—éƒ¨|å°åŒ—-ç¢§å±±å·–": {"id": "uvwfYzwY8tg", "label": "ç¢§å±±å·–", "source": "Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
        "åŒ—éƒ¨|å°åŒ—-å¾®é¢¨å¹³å°": {"id": "34h_Cy_n0Ok", "label": "å¾®é¢¨å¹³å°", "source": "Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"}, 
        "åŒ—éƒ¨|å°åŒ—-è²“ç©ºæŒ‡å—å®®": {"id": "215ahZ_0rTg", "label": "è²“ç©ºæŒ‡å—å®®", "source": "Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
        "åŒ—éƒ¨|å°åŒ—-å†·æ°´å‘åœè»Šå ´": {"id": "GB64WeZZQPQ", "label": "å†·æ°´å‘åœè»Šå ´", "source": "é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
        "åŒ—éƒ¨|å°åŒ—-é çœºä¸ƒæ˜Ÿå±±": {"id": "PvJr2efA6n0", "label": "é çœºä¸ƒæ˜Ÿå±±", "source": "é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
        "åŒ—éƒ¨|å°åŒ—-å°æ²¹å‘åœè»Šå ´": {"id": "kKD-ZBLs8-4", "label": "å°æ²¹å‘åœè»Šå ´", "source": "é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
        "åŒ—éƒ¨|å°åŒ—-é™½æ˜æ›¸å±‹": {"id": "RttyIGHbN_w", "label": "é™½æ˜æ›¸å±‹", "source": "é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
        "åŒ—éƒ¨|å°åŒ—-å¤§å±¯è‡ªç„¶å…¬åœ’": {"id": "6ghffcNt3Nw", "label": "å¤§å±¯è‡ªç„¶å…¬åœ’", "source": "é™½æ˜å±±åœ‹å®¶å…¬åœ’"},
        "åŒ—éƒ¨|æ–°åŒ—-æ¼äººç¢¼é ­": {"id": "xwAWSh35uuw", "label": "æ–°åŒ—æ·¡æ°´", "source": "æ–°åŒ—æ—…å®¢ New Taipei Tour"},
        "åŒ—éƒ¨|æ–°åŒ—-çƒ˜çˆåœ°": {"id": "xxMRjVwCQ3o", "label": "æ–°åŒ—çƒ˜çˆåœ°", "source": "æ–°åŒ—æ—…å®¢ New Taipei Tour"}, 
        "åŒ—éƒ¨|æ–°åŒ—-ååˆ†ç€‘å¸ƒ": {"id": "HirBQsQEUeA", "label": "ååˆ†ç€‘å¸ƒ", "source": "æ–°åŒ—æ—…å®¢ New Taipei Tour"}, 
        "åŒ—éƒ¨|æ–°åŒ—-ä¹ä»½": {"id": "XSD5ptYisw8", "label": "æ–°åŒ—ä¹ä»½", "source": "æ–°åŒ—æ—…å®¢ New Taipei Tour"},
        "åŒ—éƒ¨|æ–°åŒ—-é¼»é ­æœå‹™å€": {"id": "4Bm3IKcGkQY", "label": "æ–°åŒ—é¼»é ­", "source": "necoast nsa"},
        "åŒ—éƒ¨|åŸºéš†-å¤–æœ¨å±±": {"id": "LInNQYAbAwQ", "label": "å¤–æœ¨å±±", "source": "GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´": {"id": "91PfFoqvuUk", "label": "æ¡ƒåœ’æ©Ÿå ´", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´å—è·‘é“": {"id": "y3_x8el5ZJY", "label": "TPE å—è·‘é“", "source": "Taoyuan Airport"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´åŒ—è·‘é“": {"id": "wWEnxWA7nnY", "label": "TPE åŒ—è·‘é“", "source": "Taoyuan Airport"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-æ°¸å®‰æ¼æ¸¯": {"id": "tD_a03trUvE", "label": "æ°¸å®‰æ¼æ¸¯", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ": {"id": "YkIUZjVlhv4", "label": "æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-è™é ­å±±ç’°ä¿å…¬åœ’": {"id": "tu_gsIkNt-w", "label": "è™é ­å±±ç’°ä¿å…¬åœ’", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-å°çƒä¾†å¤©ç©ºæ­¥é“": {"id": "neaiCec1kec", "label": "å°çƒä¾†å¤©ç©ºæ­¥é“", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-è§’æ¿å±±æ€è¦ªäº­": {"id": "3Za9y4z_Lzc", "label": "è§’æ¿å±±æ€è¦ªäº­", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°": {"id": "5YDXZ1aiR5Y", "label": "ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-å¤§æºªæ©‹": {"id": "oFJ6gCaBb_Q", "label": "å¤§æºªæ©‹", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-è™é ­å±±å¥§çˆ¾æ£®æ—å­¸å ‚": {"id": "yQSmajHyMhU", "label": "è™é ­å±±å¥§çˆ¾æ£®æ—å­¸å ‚", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-è§’æ¿å±±æ¢…åœ’": {"id": "-xT1bZhWLuU", "label": "è§’æ¿å±±æ¢…åœ’", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-è§’æ¿å±±ç”Ÿæ…‹æ± ": {"id": "XEbo8NzMTbQ", "label": "è§’æ¿å±±ç”Ÿæ…‹æ± ", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-å¤§æºªè€è¡—": {"id": "XUWjAsajKXg", "label": "å¤§æºªè€è¡—", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-çŸ³é–€æ°´åº«": {"id": "GUCaVR88ZFU", "label": "çŸ³é–€æ°´åº«", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-æ…ˆæ¹–æ°´å²¸å»£å ´": {"id": "pSQ0e-ZTZ5g", "label": "æ…ˆæ¹–æ°´å²¸å»£å ´", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-é˜¿å§†åªè–‘æ¯å³¶": {"id": "EUOp2LchPQM", "label": "é˜¿å§†åªè–‘æ¯å³¶", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-ä¸Šå·´é™µ": {"id": "nV-DKquUjFs", "label": "ä¸Šå·´é™µ", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-æ¡ƒåœ’åœ‹éš›æ©Ÿå ´å‡±æ‚…é…’åº—": {"id": "68GFgzQxrXs", "label": "æ©Ÿå ´å‡±æ‚…", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"},
        "åŒ—éƒ¨|æ¡ƒåœ’-å°çƒä¾†å¯°å®‡å¹³å°": {"id": "PJWye36lEj4", "label": "å¯°å®‡å¹³å°", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "åŒ—éƒ¨|æ¡ƒåœ’-è¨±åæ¸¯æ¿•åœ°": {"id": "44JArbF682k", "label": "è¨±åæ¸¯æ¿•åœ°", "source": "éŠæ¡ƒåœ’ Taoyuan Travel"}, 
        "æ±éƒ¨|å®œè˜­-å¤–æ¾³æ²™ç˜": {"id": "UgoT-QTbYvo", "label": "å®œè˜­å¤–æ¾³", "source": "necoast nsa"},
        "æ±éƒ¨|å®œè˜­-ç¦éš†æµ·æ°´æµ´å ´": {"id": "AxG-Jssz8fg", "label": "å®œè˜­ç¦éš†", "source": "necoast nsa"},
        "æ±éƒ¨|å®œè˜­-èˆŠéš§é“å—å£": {"id": "f38lFhncLVA", "label": "å®œè˜­çŸ³åŸ", "source": "necoast nsa"},
        "æ±éƒ¨|å®œè˜­-ç¤æºªå¯’æ²é…’åº—": {"id": "cPh2vzrtG_w", "label": "ç¤æºªå¯’æ²é…’åº—", "source": "ç¤æºªå¯’æ²é…’åº—MU JIAO XI HOTEL"},
        "æ±éƒ¨|å®œè˜­-ç„¡å°¾æ¸¯": {"id": "gPeJuFuNcRc", "label": "ç„¡å°¾æ¸¯", "source": "GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
        "æ±éƒ¨|å®œè˜­-çŸ³åŸæ¼æ¸¯": {"id": "ozZVLl0h--A", "label": "çŸ³åŸæ¼æ¸¯", "source": "GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"}, 
        "æ±éƒ¨|å°æ±-é¯‰é­šå±±": {"id": "BUJJaW0vkJs", "label": "å°æ±é¯‰é­šå±±", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-é‡‘å´™å¤§æ©‹": {"id": "9QqBz3kNHis", "label": "å°æ±é‡‘å´™å¤§æ©‹", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-é‡‘æ¨½è§€æµª": {"id": "q3KJt-SZc2s", "label": "å°æ±é‡‘æ¨½è§€æµª", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-å¯Œå±±": {"id": "Rsq95SQ26bY", "label": "å°æ±å¯Œå±±", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-æ‰åŸç£": {"id": "VqS_Y8ZCj6M", "label": "å°æ±æ‰åŸç£", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-å¯Œå²¡æ¼æ¸¯": {"id": "D945F_dauls", "label": "å°æ±å¯Œå²¡æ¼æ¸¯", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-è¯æºæ›™å…‰è§€æ™¯å°": {"id": "TY4qQElcUrA", "label": "å°æ±è¯æºæ›™å…‰è§€æ™¯å°", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-å—æ©«åŸ¡å£": {"id": "LSkq-wHMxQY", "label": "å°æ±å—æ©«åŸ¡å£", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-æ± ä¸Šå¤©å ‚è·¯": {"id": "6kUEK3LVrro", "label": "å°æ±æ± ä¸Šå¤©å ‚è·¯", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-å¤šè‰¯è»Šç«™": {"id": "UCG1aXVO8H8", "label": "å°æ±å¤šè‰¯", "source": "Amazing Taitung å°æ±å°±é†¬ç©"}, 
        "æ±éƒ¨|å°æ±-é¹¿é‡é«˜å°": {"id": "rvc1klNIgQc", "label": "é¹¿é‡é«˜å°", "source": "èŠ±æ±ç¸±è°·åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|èŠ±è“®-çŸ³æ¢¯åª": {"id": "mXnigLvIL0Q", "label": "èŠ±è“®çŸ³æ¢¯åª", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
        "æ±éƒ¨|èŠ±è“®-èµ¤ç§‘å±±": {"id": "5GTFLN9gZrc", "label": "èµ¤ç§‘å±±", "source": "èŠ±æ±ç¸±è°·åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|èŠ±è“®-é•·è™¹æ©‹": {"id": "JnD8Rk3o0BM", "label": "é•·è™¹æ©‹", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
        "æ±éƒ¨|èŠ±è“®-é¦¬å¤ªéæºªå·¦å²¸æ°´å°º2": {"id": "Ic6hqus0tjA", "label": "é¦¬å¤ªéæºªæ°´å°º2", "source": "æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"}, 
        "æ±éƒ¨|èŠ±è“®-ä¸ƒæ˜Ÿæ½­å®‰æª¢æ‰€": {"id": "j3l32VFi5M8", "label": "ä¸ƒæ˜Ÿæ½­å®‰æª¢æ‰€", "source": "æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"},
        "æ±éƒ¨|èŠ±è“®-å…­åçŸ³å±±": {"id": "DliL9uMtPrI", "label": "å…­åçŸ³å±±", "source": "èŠ±æ±ç¸±è°·åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|å°æ±-æˆåŠŸä¸‰ä»™å°": {"id": "dQ7Sd6PGLdA", "label": "ä¸‰ä»™å°", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
        "æ±éƒ¨|å°æ±-é‡‘æ¨½éŠæ†©å€": {"id": "ZdqHgQwvZOw", "label": "é‡‘æ¨½éŠæ†©å€", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|å°æ±-ç¶ å³¶å—å¯®": {"id": "wTHhv7M0vCI", "label": "ç¶ å³¶å—å¯®", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
        "æ±éƒ¨|å°æ±-éƒ½æ­·éŠå®¢ä¸­å¿ƒ": {"id": "JhQuR77AR7U", "label": "éƒ½æ­·éŠå®¢ä¸­å¿ƒ", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
        "æ±éƒ¨|å°æ±-åŠ è·¯è˜­éŠæ†©å€": {"id": "AKl3F6cAY2Q", "label": "åŠ è·¯è˜­éŠæ†©å€", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|èŠ±è“®-å¤§çŸ³é¼»å±±": {"id": "JkoXcXI04Qk", "label": "å¤§çŸ³é¼»å±±", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|å°æ±-ç¶ å³¶å¸†èˆ¹é¼»": {"id": "pLdBc8PvZko", "label": "ç¶ å³¶å¸†èˆ¹é¼»", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "æ±éƒ¨|å°æ±-ç¶ å³¶æŸ´å£æµ®æ½›å€": {"id": "a8nJQr5rBGs", "label": "ç¶ å³¶æŸ´å£æµ®æ½›å€", "source": "æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "ä¸­éƒ¨|å°ä¸­-é«˜ç¾æ¿•åœ°": {"id": "fjhg3gAn54Y", "label": "é«˜ç¾æ¿•åœ°", "source": "è‡ºä¸­è§€å…‰æ—…éŠç¶²"},
        "ä¸­éƒ¨|å—æŠ•-æ¸…å¢ƒè¾²å ´": {"id": "vM84mY2R-7o", "label": "æ¸…å¢ƒè¾²å ´", "source": "æ¸…å¢ƒè¾²å ´"},
        "ä¸­éƒ¨|å—æŠ•-æ—¥æœˆæ½­å‘å±±": {"id": "Hw0gEwE-Gqg", "label": "æ—¥æœˆæ½­å‘å±±", "source": "äº¤é€šéƒ¨è§€å…‰ç½²æ—¥æœˆæ½­åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
        "ä¸­éƒ¨|å—æŠ•-æ—¥æœˆæ½­æ°´ç¤¾": {"id": "JgQ8Y8_j-Hk", "label": "æ—¥æœˆæ½­æ°´ç¤¾", "source": "äº¤é€šéƒ¨è§€å…‰ç½²æ—¥æœˆæ½­åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"}, 
        "å—éƒ¨|å˜‰ç¾©-é˜¿é‡Œå±±": {"id": "Yc0_Ea_6zVw", "label": "é˜¿é‡Œå±±", "source": "Alishan National Forest Recreation Area"},
        "å—éƒ¨|é«˜é›„-å£½å±±æƒ…äººè§€æ™¯å°": {"id": "i7zL46S6w4g", "label": "å£½å±±è§€æ™¯å°", "source": "é«˜é›„æ—…éŠç¶²"}, 
        "å—éƒ¨|é«˜é›„-å…¸å¯¶æºª_æ¥ æ¢“è–èˆˆæ©‹": {"id": "1vVCtk5OXVk", "label": "å…¸å¯¶æºª_æ¥ æ¢“è–èˆˆæ©‹", "source": "æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"}, 
        "å—éƒ¨|é«˜é›„-æµ·å²¸_èšµå¯®åœ‹å°": {"id": "sKrqs-5Auqo", "label": "æµ·å²¸_èšµå¯®åœ‹å°", "source": "æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"}, 
        "å—éƒ¨|é«˜é›„-é«˜é›„ç‡ˆå¡”": {"id": "HqrPgNErSOA", "label": "é«˜é›„ç‡ˆå¡”", "source": "Ship"},
        "å—éƒ¨|é«˜é›„-æ——æ´¥æ²™ç˜": {"id": "lh7OdmxRvTg", "label": "æ——æ´¥æ²™ç˜", "source": "ship"},
        "å—éƒ¨|å±æ±-é—œå±±æ—¥è½": {"id": "fO-rF2bU4vY", "label": "å±æ±é—œå±±", "source": "å¢¾ä¸åœ‹å®¶å…¬åœ’"},
        "å—éƒ¨|å±æ±-éµé‘¾é¼»ç‡ˆå¡”": {"id": "uV8018h2n4o", "label": "éµé‘¾é¼»", "source": "å¢¾ä¸åœ‹å®¶å…¬åœ’"},
        "å—éƒ¨|å±æ±-èˆ¹å¸†çŸ³": {"id": "3Wb_Lgw7Ltc", "label": "èˆ¹å¸†çŸ³", "source": "å¢¾ä¸åœ‹å®¶å…¬åœ’"},
        "å—éƒ¨|å±æ±-æ—é‚Šæºª_ç¾Œåœ’æ’æ°´": {"id": "13C8jdbqQcI", "label": "æ—é‚Šæºª(ç¾Œå…‰æ©‹)", "source": "æ°´åˆ©ç½²æ°´åˆ©é˜²ç½çµ„"}, 
        "é›¢å³¶|é‡‘é–€-æ°´é ­ç¢¼é ­": {"id": "t9y49XpQyLg", "label": "é‡‘é–€æ°´é ­", "source": "é‡‘é–€åœ‹å®¶å…¬åœ’"},
        "é›¢å³¶|é¦¬ç¥–-åŒ—ç«¿èˆªç©ºç«™å¤–å€™æ©Ÿå®¤": {"id": "EaUVZ49xKQ4", "label": "åŒ—ç«¿èˆªç©ºç«™", "source": "MFKåŒ—ç«¿èˆªç©ºç«™"}, 
        "ç‰¹æ®Š|å°ç£-ä¸­å¤®å±±è„ˆ": {"id": "1s-2J2_5r7Y", "label": "ä¸­å¤®å±±è„ˆ", "source": "å°ç£é«˜å±±å³æ™‚å½±åƒ"}
    };

    // ========================================
    // JavaScript é‚è¼¯å±¤
    // ========================================
    const regionOrder = ["åŒ—éƒ¨", "ä¸­éƒ¨", "å—éƒ¨", "æ±éƒ¨", "é›¢å³¶", "ç‰¹æ®Š"];
    const players = [null, null, null, null];
    let selectedCam = 0;
    let currentRegion = regionOrder[0];
    let currentStreamKeys = [];
    let isAppFullscreen = false; // æ–°å¢ï¼šè¿½è¹¤å…¨è¢å¹•ç‹€æ…‹

    function getStreamsByRegion(region) {
        const prefix = region + "|";
        return Object.keys(ALL_STREAMS)
            .filter(key => key.startsWith(prefix))
            .map(key => ({ 
                key: key, 
                ...ALL_STREAMS[key] 
            }));
    }

    function generateRegionButtons() {
        const container = document.getElementById('regionButtons');
        container.innerHTML = ''; // æ¸…ç©ºç¾æœ‰æŒ‰éˆ•

        regionOrder.forEach(region => {
            // æª¢æŸ¥è©²å€å¡Šæ˜¯å¦æœ‰è³‡æ–™
            if (Object.keys(ALL_STREAMS).some(key => key.startsWith(region + "|"))) {
                 const button = document.createElement('button');
                 button.textContent = region;
                 button.onclick = () => showStreamsForRegion(region);
                 if (region === currentRegion) {
                    button.classList.add('active');
                 }
                 container.appendChild(button);
            }
        });
        
        // ç¢ºä¿åˆå§‹æ™‚ç¬¬ä¸€å€‹å€å¡ŠæŒ‰éˆ•æ˜¯é¸ä¸­çš„
        if (!document.querySelector(`#regionButtons button.active`)) {
            const firstButton = document.querySelector(`#regionButtons button`);
            if (firstButton) {
                firstButton.classList.add('active');
            }
        }
    }

    function showStreamsForRegion(region) {
        currentRegion = region;
        
        // 1. æ›´æ–°åœ°å€æŒ‰éˆ•çš„ active ç‹€æ…‹
        document.querySelectorAll('#regionButtons button').forEach(btn => {
            btn.classList.remove('active');
            if (btn.textContent === region) {
                btn.classList.add('active');
            }
        });

        // 2. æ¸…ç©ºä¸¦é‡å»ºç›´æ’­æµæŒ‰éˆ•
        const container = document.getElementById('streamButtons');
        if (!container) return; 

        container.innerHTML = '';
        const streams = getStreamsByRegion(region);
        currentStreamKeys = streams.map(s => s.key);
        
        streams.forEach((stream, index) => {
            const button = document.createElement('button');
            button.textContent = stream.label;
            button.onclick = () => selectStream(stream.key);
            container.appendChild(button);
        });
        
        // 3. ç¢ºä¿ 'è¿”å›å€å¡Š' æŒ‰éˆ•å­˜åœ¨
        let backButton = document.getElementById('backButton');
        if (!backButton) {
            backButton = document.createElement('button');
            backButton.id = 'backButton';
            backButton.textContent = 'è¿”å›å€å¡Š';
            backButton.classList.add('back-button');
            backButton.onclick = showRegionSelection;
            document.querySelector('.controls .row:first-child').appendChild(backButton);
        }

        // 4. é¡¯ç¤ºç›´æ’­æµæŒ‰éˆ•ï¼Œéš±è—å€å¡ŠæŒ‰éˆ•
        document.getElementById('streamButtonsContainer').style.display = 'flex';
        document.getElementById('regionButtons').style.display = 'none';
    }

    // é€™å€‹å‡½å¼ç¾åœ¨ç”¨æ–¼é¸å–®ç³»çµ±çš„åˆå§‹è¨­å®š
    function showRegionSelection() {
        document.getElementById('regionButtons').style.display = 'flex';
        const streamContainer = document.getElementById('streamButtonsContainer');
        if (streamContainer) {
            streamContainer.style.display = 'none';
        }
        const backButton = document.getElementById('backButton');
        if (backButton) {
             backButton.remove();
        }
    }

    function selectStream(streamKey) {
        const stream = ALL_STREAMS[streamKey];
        if (!stream) return;

        // 1. å–å¾—ç•¶å‰é¸ä¸­çš„æ”å½±æ©Ÿç´¢å¼•
        const camIndex = selectedCam; 

        // 2. æ›´æ–°æŒ‰éˆ•ç‹€æ…‹ (è®“é¸ä¸­çš„ç›´æ’­æµæŒ‰éˆ•é«˜äº®)
        document.querySelectorAll('#streamButtons button').forEach(btn => {
            btn.classList.remove('active');
            if (btn.textContent === stream.label) {
                btn.classList.add('active');
            }
        });

        // 3. è¼‰å…¥ç›´æ’­æµ
        loadStream(camIndex, stream.id, stream.label, stream.source);
        
        // 4. è‡ªå‹•åˆ‡æ›åˆ°ä¸‹ä¸€å€‹é¡é ­ï¼Œä½†ä¸è¦è®“å®ƒè¶…é 3 (å³ä¸‹)
        if (selectedCam < 3) {
            selectCam(selectedCam + 1);
        } else {
            // å¦‚æœå·²ç¶“æ˜¯æœ€å¾Œä¸€å€‹é¡é ­ï¼Œä¿æŒé¸ä¸­ç‹€æ…‹ï¼Œä¸¦ç¢ºä¿æ§åˆ¶åˆ—è²éŸ³æŒ‰éˆ•æ›´æ–°
            updateControlSoundButton();
        }
    }

    function selectCam(camIndex) {
        selectedCam = camIndex;

        // 1. æ›´æ–°é¡é ­é¸æ“‡æŒ‰éˆ• active ç‹€æ…‹
        document.querySelectorAll('.cam-select button').forEach((btn, index) => {
            btn.classList.remove('active');
            if (index === camIndex) {
                btn.classList.add('active');
            }
        });
        
        // 2. æ›´æ–°æ§åˆ¶åˆ—è²éŸ³æŒ‰éˆ•ç‹€æ…‹
        updateControlSoundButton();
    }
    
    // æ–°å¢ï¼šæ›´æ–°æ§åˆ¶åˆ—è²éŸ³æŒ‰éˆ•çš„ç‹€æ…‹
    function updateControlSoundButton() {
        const player = players[selectedCam];
        const controlButton = document.getElementById('control-sound-toggle');
        
        if (controlButton && player && typeof player.isMuted === 'function') {
            // ç”±æ–¼ YouTube Player çš„ isMuted() æ˜¯ä¸€å€‹æ–¹æ³•
            if (player.isMuted()) {
                controlButton.innerHTML = 'ğŸ”‡ é–‹å•Ÿè²éŸ³';
            } else {
                controlButton.innerHTML = 'ğŸ”Š é—œé–‰è²éŸ³';
            }
        } else if (controlButton) {
            // å¦‚æœæ’­æ”¾å™¨å°šæœªæº–å‚™å¥½ï¼Œé¡¯ç¤ºé è¨­éœéŸ³ç‹€æ…‹
            controlButton.innerHTML = 'ğŸ”‡ é–‹å•Ÿè²éŸ³'; 
        }
    }

    // æ–°å¢ï¼šæ§åˆ¶åˆ—è²éŸ³æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶ (æ§åˆ¶ç•¶å‰é¸ä¸­çš„ç•«é¢)
    function toggleSelectedCamSound() {
        const player = players[selectedCam];
        const floatingButton = document.getElementById(`sound${selectedCam}`);

        if (player && typeof player.isMuted === 'function') {
            if (player.isMuted()) {
                player.unMute();
                floatingButton.innerText = 'ğŸ”Š'; // æ›´æ–°ç•«é¢ä¸Šçš„åœ–ç¤º
            } else {
                player.mute();
                floatingButton.innerText = 'ğŸ”‡'; // æ›´æ–°ç•«é¢ä¸Šçš„åœ–ç¤º
            }
            updateControlSoundButton(); // æ›´æ–°æ§åˆ¶åˆ—çš„æŒ‰éˆ•ç‹€æ…‹
        }
    }

    // æ–°å¢ï¼šå–®ä¸€ç•«é¢ä¸Šçš„è²éŸ³åœ–ç¤ºé»æ“Šäº‹ä»¶ (æ§åˆ¶å–®ä¸€ç•«é¢)
    function togglePlayerSound(camIndex) {
        const player = players[camIndex];
        const soundButton = document.getElementById(`sound${camIndex}`);

        if (player && typeof player.isMuted === 'function') {
            if (player.isMuted()) {
                player.unMute();
                soundButton.innerText = 'ğŸ”Š';
            } else {
                player.mute();
                soundButton.innerText = 'ğŸ”‡';
            }
            
            // å¦‚æœè¢«é»æ“Šçš„ç•«é¢æ˜¯ç•¶å‰é¸ä¸­çš„ç•«é¢ï¼Œå‰‡åŒæ­¥æ›´æ–°æ§åˆ¶åˆ—çš„æŒ‰éˆ•
            if (camIndex === selectedCam) {
                updateControlSoundButton();
            }
        }
    }
    
    // æ–°å¢ï¼šå…¨è¢å¹•æ§åˆ¶
    function toggleFullscreen() {
        const stage = document.getElementById('stageWrap');
        const controls = document.getElementById('controls');
        const exitButton = document.getElementById('exitFullscreenButton');

        if (!isAppFullscreen) {
            // ENTER FULLSCREEN MODE
            controls.style.display = 'none';
            exitButton.style.display = 'block';

            // è«‹æ±‚ç€è¦½å™¨å…¨è¢å¹•
            if (document.documentElement.requestFullscreen) {
                document.documentElement.requestFullscreen();
            } else if (document.documentElement.mozRequestFullScreen) { /* Firefox */
                document.documentElement.mozRequestFullScreen();
            } else if (document.documentElement.webkitRequestFullscreen) { /* Chrome, Safari and Opera */
                document.documentElement.webkitRequestFullscreen();
            } else if (document.documentElement.msRequestFullscreen) { /* IE/Edge */
                document.documentElement.msRequestFullscreen();
            }

            // èª¿æ•´èˆå°é«˜åº¦ä»¥ä½”æ»¿æ•´å€‹è¢å¹•
            stage.style.height = '100vh'; 
            isAppFullscreen = true;

        } else {
            // EXIT FULLSCREEN MODE
            
            // é€€å‡ºç€è¦½å™¨å…¨è¢å¹•
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.mozCancelFullScreen) { /* Firefox */
                document.mozCancelFullScreen();
            } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { /* IE/Edge */
                document.msExitFullscreen();
            }

            // æ¢å¾©æ­£å¸¸æ¨¡å¼
            controls.style.display = 'flex';
            exitButton.style.display = 'none';
            stage.style.height = 'calc(100vh - 70px)';
            isAppFullscreen = false;
        }
    }

    // ç›£è½ç€è¦½å™¨å…¨è¢å¹•ç‹€æ…‹è®ŠåŒ– (ä¾‹å¦‚ç”¨æˆ¶æŒ‰ ESC éµ)
    document.addEventListener('fullscreenchange', (event) => {
        // å¦‚æœä¸æ˜¯åœ¨å…¨è¢å¹•æ¨¡å¼ï¼Œä¸”æˆ‘å€‘çš„æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹ä»ç‚ºå…¨è¢å¹•ï¼Œå‰‡éœ€æ‰‹å‹•æ¢å¾©
        if (!document.fullscreenElement) {
            if (isAppFullscreen) {
                const controls = document.getElementById('controls');
                const stage = document.getElementById('stageWrap');
                const exitButton = document.getElementById('exitFullscreenButton');

                controls.style.display = 'flex';
                exitButton.style.display = 'none';
                stage.style.height = 'calc(100vh - 70px)';
                isAppFullscreen = false;
            }
        }
    });

    // ... (onYouTubeIframeAPIReady å’Œ loadStream å‡½å¼ä¿æŒä¸è®Šï¼Œåªèª¿æ•´äº†åƒæ•¸å‚³é)
    // ç‚ºäº†ä¿æŒç¨‹å¼ç¢¼ç°¡æ½”ï¼Œé€™è£¡åªé¡¯ç¤ºè®Šå‹•éƒ¨åˆ†ï¼Œå…¶é¤˜å·²åŒ…å«åœ¨ä¸Šæ–¹å®Œæ•´ä»£ç¢¼ä¸­ã€‚
    
    // (onPlayerReady å‡½å¼åœ¨ä¸Šæ–¹å·²åŒ…å«åœ¨ loadStream çš„ events å…§ï¼Œé€™è£¡å°‡å…¶ç¨ç«‹å‡ºä¾†ä»¥ä¾¿æ–¼ç®¡ç†)
    function onPlayerReady(event, camIndex, labelText, sourceText) {
        event.target.mute(); // é è¨­éœéŸ³
        updateLabel(camIndex, labelText, sourceText);
        
        const soundButton = document.getElementById(`sound${camIndex}`);
        if (soundButton) {
             soundButton.innerText = 'ğŸ”‡'; // è¨­ç½®ç•«é¢ä¸Šçš„åœ–ç¤º
        }
        
        // å¦‚æœé€™æ˜¯ cam 0 (åˆå§‹é¸ä¸­çš„)ï¼Œæ›´æ–°æ§åˆ¶åˆ—æŒ‰éˆ•ç‹€æ…‹
        if (camIndex === selectedCam) {
            updateControlSoundButton();
        }
    }

    function loadStream(camIndex, videoId, labelText, sourceText) {
        const cell = document.querySelector(`.cell[data-index="${camIndex}"]`);
        const shield = cell.querySelector('.interaction-shield');
        
        // ç¢ºä¿ iframe å¯ä»¥è¢«é»æ“Šï¼Œç§»é™¤é˜²è­·ç½©
        shield.style.display = 'none'; 
        
        if (players[camIndex]) {
            players[camIndex].destroy();
        }
        
        players[camIndex] = new YT.Player(`player${camIndex}`, {
            videoId: videoId,
            playerVars: {
                autoplay: 1,
                controls: 0,
                rel: 0,
                fs: 0,
                loop: 1,
                mute: 1, // é è¨­éœéŸ³
                playlist: videoId,
                modestbranding: 1
            },
            events: {
                'onReady': (event) => onPlayerReady(event, camIndex, labelText, sourceText),
                'onError': (event) => {
                    // ç™¼ç”ŸéŒ¯èª¤æ™‚é¡¯ç¤ºé˜²è­·ç½©
                    shield.style.display = 'block'; 
                    updateLabel(camIndex, `è¼‰å…¥éŒ¯èª¤: ${videoId}`, 'è«‹æª¢æŸ¥ç›´æ’­ç‹€æ…‹');
                }
            }
        });
        updateLabel(camIndex, labelText, sourceText);
    }
    
    function updateLabel(camIndex, labelText, sourceText) {
        const labelDiv = document.getElementById(`label${camIndex}`);
        labelDiv.innerHTML = `${labelText} <br><span class="source-on-screen">ä¾†æº: ${sourceText}</span>`;
    }

    function onYouTubeIframeAPIReady() {
        // 1. è¨­ç½®é¸å–®
        const controls = document.getElementById('controls');
        
        // å‰µå»º streamButtons å®¹å™¨
        const streamButtonsContainer = document.createElement('div');
        streamButtonsContainer.id = 'streamButtonsContainer';
        streamButtonsContainer.classList.add('row');
        streamButtonsContainer.style.display = 'none'; 
        
        const streamButtons = document.createElement('div');
        streamButtons.id = 'streamButtons';
        streamButtons.classList.add('row');
        streamButtonsContainer.appendChild(streamButtons);
        
        const lastRow = controls.querySelector('.row:last-of-type');
        controls.insertBefore(streamButtonsContainer, lastRow);
        
        generateRegionButtons();
        
        // 2. è¼‰å…¥é è¨­ä¸²æµ (ç¬¬ä¸€å€‹åœ°å€çš„ç¬¬ä¸€å€‹ä¸²æµ)
        currentRegion = regionOrder.find(region => 
            Object.keys(ALL_STREAMS).some(key => key.startsWith(region + "|"))
        ) || regionOrder[0]; 
        
        const firstStreamKey = Object.keys(ALL_STREAMS).find(key => key.startsWith(currentRegion + "|"));
        
        if (firstStreamKey) {
            const stream = ALL_STREAMS[firstStreamKey];
            loadStream(0, stream.id, stream.label, stream.source);
        } else {
             updateLabel(0, "ç„¡å¯ç”¨ä¸²æµ", "è«‹æª¢æŸ¥ ALL_STREAMS è¨­å®š");
        }
        
        // åˆå§‹åŒ–ç¬¬ä¸€å€‹é¡é ­çš„è²éŸ³æŒ‰éˆ•ç‹€æ…‹
        updateControlSoundButton();
    }
  </script>
</body>
</html>
