<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <title>å°ç£å³æ™‚ç›´æ’­å››åˆ†å‰²ç›£çœ‹ï¼ˆæ¥µç°¡éŸ³æ¨‚æ§åˆ¶æœ€çµ‚ç‰ˆï¼‰</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* ---------------------------------------------------------------------- */
    /* CSS æ¨£å¼ (æ²¿ç”¨è‡ªç”¨æˆ¶ä¸Šå‚³æª”æ¡ˆ) */
    /* ---------------------------------------------------------------------- */
    html,body{
      height:100%; margin:0; padding:0; background:#000;
      font-family: system-ui, sans-serif; color:#fff; overflow:hidden;
    }

    /* åº•éƒ¨æ§åˆ¶åˆ— */
    .controls{
      position:fixed; bottom:0; left:0; width:100%; height:78px;
      background:rgba(12,12,12,0.95); color:#fff; padding:8px 12px;
      box-sizing:border-box; display:flex; flex-direction:row; align-items:center;
      gap:10px; z-index:3000; overflow:hidden;
    }
    .controls button{
      background-color:#222; color:#fff; border:1px solid #444;
      padding:8px 12px; font-size:13px; cursor:pointer; border-radius:6px;
      height:40px; flex-shrink:0; white-space:nowrap; text-align:center;
    }
    .controls button.active{ background-color:#0078d7; border-color:#0078d7; }
    .divider{ width:1px; height:60%; background:#333; flex-shrink:0; margin:0; }

    /* ç¸£å¸‚ / æ™¯é»å®¹å™¨ï¼ˆå¯å·¦å³æ»¾å‹•ï¼‰ */
    #regionButtons{
      display:flex; flex-grow:1; min-width:0; gap:6px;
      overflow-x:auto; padding-bottom:6px; height:100%; align-items:center;
    }
    #regionButtons::-webkit-scrollbar{ height:6px; background-color:rgba(255,255,255,0.06); }
    #regionButtons::-webkit-scrollbar-thumb{ background-color:#444; border-radius:3px; }
    #regionButtons .region-label{ color:#fff; margin:0 8px 0 4px; font-weight:600; flex-shrink:0; user-select:none; }
    #regionButtons .city-btn{
      background-color:#111; color:#fff; border:1px solid #555;
      padding:6px 10px; margin:0 4px; border-radius:6px; cursor:pointer;
      height:36px; flex-shrink:0; font-size:13px;
    }
    #regionButtons .city-btn:hover{ background-color:#1a1a1a; border-color:#666; }

    /* å½±ç‰‡èˆå°å››æ ¼ */
    .stage-wrap{
      position:fixed; top:0; left:0; width:100vw; height:calc(100vh - 78px);
      display:grid; grid-template-columns:1fr 1fr; grid-template-rows:1fr 1fr;
      gap:0; z-index:1;
    }
    .cell{ position:relative; width:100%; height:100%; overflow:hidden; background:#000; }
    .player-container, .player-container iframe{
      position:absolute; inset:0; width:100%; height:100%; border:0; display:block;
      object-fit:cover; object-position:center; background:black;
      transform: scale(1.65) translateY(-6%);
    }
    .interaction-shield{ position:absolute; inset:0; z-index:5; background:transparent; cursor:default; }
    .label{
      position:absolute; left:8px; right:8px; bottom:8px; display:flex;
      flex-direction:column; align-items:flex-start; padding:6px 8px;
      font-size:14px; color:#fff; background:rgba(0,0,0,0.6); border-radius:6px;
      pointer-events:none; z-index:10;
    }
    .source-on-screen{ font-size:11px; color:#ccc; margin-top:4px; line-height:1.1; }

    /* é¡¯ç¤ºæ§åˆ¶ */
    .hide-labels .label{ display:none; }
    .fullscreen-active .controls{ display:none; }
    .fullscreen-active .stage-wrap{ height:100vh; }

    @media (max-width:640px){
      .controls{ padding:6px 8px; height:80px; }
      .controls button{ padding:6px 8px; font-size:12px; height:36px; }
      #regionButtons .city-btn{ padding:6px 8px; font-size:12px; height:34px; }
    }
    
    /* ---------------------------------------------------------------------- */
    /* æ–°å¢ï¼šéŸ³æ¨‚æ§åˆ¶å€å¡Šæ¨£å¼ */
    /* ---------------------------------------------------------------------- */
    .music-controls-container {
        display: none; /* é è¨­éš±è—ï¼Œæœ‰æ­Œæ›²æ™‚æ‰é¡¯ç¤º */
        align-items: center;
        gap: 4px; 
        flex-shrink: 0;
    }
    .music-controls {
        display: flex;
        gap: 4px;
        flex-shrink: 0;
    }
    .music-controls button {
        /* ä½¿ç”¨ emoji/symbol æ™‚ï¼Œå¯ä»¥èª¿æ•´ padding è®“åœ–ç¤ºç½®ä¸­ */
        padding: 8px 10px; 
        font-size: 14px;
        height: 40px;
    }
    /* æ¨¡å¼è¨­å®šå½ˆå‡ºçª—æŒ‰éˆ•æ¨£å¼ */
    #musicSettingsModal button {
        background-color: #333;
        color: #fff;
        border: none;
        padding: 10px 15px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        flex-grow: 1;
    }
    #musicSettingsModal button:hover {
        background-color: #555;
    }
  </style>
</head>
<body>
  <div class="controls" id="controls">
    <button id="select-cam-0" class="active" onclick="selectCam(0)">å·¦ä¸Š</button>
    <button id="select-cam-1" onclick="selectCam(1)">å³ä¸Š</button>
    <button id="select-cam-2" onclick="selectCam(2)">å·¦ä¸‹</button>
    <button id="select-cam-3" onclick="selectCam(3)">å³ä¸‹</button>

    <div class="divider"></div>

    <div id="regionButtons" aria-label="ç¸£å¸‚èˆ‡æ™¯é»é¸å–®" role="toolbar"></div>

    <div class="divider"></div>
    <button id="fullscreenBtn" onclick="toggleFullscreen()">å…¨è¢å¹•</button>

    <div class="divider"></div>
    <button id="labelsToggleBtn" onclick="toggleLabels()">æ¨™ç±¤éš±è—</button>

    <div class="divider"></div>
    <button id="muteBtn" onclick="toggleMute()">å–æ¶ˆéœéŸ³</button>
    
    <div class="divider"></div>
    <button id="requestBtn" onclick="requestSong()" title="é»æ­Œè‡³æ’­æ”¾åˆ—è¡¨">é»æ­Œ</button>
    
    <div id="musicControlsContainer" class="music-controls-container">
        <div class="music-controls">
            <button id="prevSongBtn" onclick="skipToPreviousSong()" title="ä¸Šä¸€é¦–">â®ï¸</button>
            <button id="playPauseBtn" onclick="playPauseSong()" title="æ’­æ”¾/æš«åœ">â–¶ï¸</button>
            <button id="nextSongBtn" onclick="skipToNextSong()" title="ä¸‹ä¸€é¦–">â­ï¸</button>
            <button id="modeBtn" onclick="openMusicSettingsModal()" title="æ¨¡å¼è¨­å®š">ğŸ”„</button>
        </div>
    </div>
    
  </div>

  <div class="stage-wrap" id="stageWrap">
    <div class="cell" data-index="0">
      <div id="player0" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label0">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="1">
      <div id="player1" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label1">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="2">
      <div id="player2" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label2">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
    <div class="cell" data-index="3">
      <div id="player3" class="player-container"></div>
      <div class="interaction-shield"></div>
      <div class="label" id="label3">è¼‰å…¥ä¸­...<span class="source-on-screen"></span></div>
    </div>
  </div>
  
  <div id="player_music_container" style="position:fixed; top:-100px; left:-100px; width:1px; height:1px; overflow:hidden;">
    <div id="player_music"></div>
  </div>

  <div id="musicSettingsModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:#222; padding:20px; border-radius:10px; box-shadow:0 0 20px rgba(0,0,0,0.5); width:300px; max-width:90%; text-align:center;">
      <h3 style="margin-top:0; color:#fff;">éŸ³æ¨‚æ’­æ”¾æ¨¡å¼</h3>
      <p style="font-size:12px; color:#aaa;">é»æ“Šä¸‹æ–¹æŒ‰éˆ•é¸æ“‡æ’­æ”¾æ¨¡å¼ï¼š</p>
      <div style="display:flex; justify-content:space-around; gap:10px; margin-top:15px;">
        <button onclick="setPlaybackMode('listLoop')">
            ğŸ”„ åˆ—è¡¨å¾ªç’°
        </button>
        <button onclick="setPlaybackMode('shuffle')">
            ğŸ”€ éš¨æ©Ÿæ’­æ”¾
        </button>
        <button onclick="setPlaybackMode('repeatOne')">
            ğŸ” å–®æ›²å¾ªç’°
        </button>
      </div>
      
      <button onclick="stopAndCloseModal()" style="margin-top:15px; background:#8b0000; width:100%; border:none;">
          â¹ï¸ åœæ­¢ä¸¦çµæŸæ’­æ”¾
      </button>

      <button onclick="closeMusicSettingsModal()" style="margin-top:10px; background:#444; width:100%;">é—œé–‰</button>
    </div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    // ===== ç›´æ’­ä¾†æº (ä¿æŒä¸è®Š) =====
    const ALL_STREAMS = {
      "å°åŒ—-è±¡å±±çœ‹101": {"id":"z_fY1pj1VBw","label":"å°åŒ—è±¡å±±","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-å¤§ç¨»åŸ•": {"id":"Ndo_8RuefH4","label":"å¤§ç¨»åŸ•","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-ç¢§å±±å·–": {"id":"uvwfYzwY8tg","label":"ç¢§å±±å·–","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-å¾®é¢¨å¹³å°": {"id":"34h_Cy_n0Ok","label":"å¾®é¢¨å¹³å°","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "å°åŒ—-è²“ç©ºæŒ‡å—å®®": {"id":"215ahZ_0rTg","label":"è²“ç©ºæŒ‡å—å®®","source":"Taipei Travel Live Cam å°åŒ—è§€å…‰å³æ™‚å½±åƒ"},
      "æ–°åŒ—-æ¼äººç¢¼é ­": {"id":"xwAWSh35uuw","label":"æ–°åŒ—æ·¡æ°´","source":"æ–°åŒ—æ—…å®¢ New Taipei Tour"},
      "æ–°åŒ—-é¼»é ­æœå‹™å€": {"id":"4Bm3IKcGkQY","label":"æ–°åŒ—é¼»é ­","source":"necoast nsa"},
      "åŸºéš†-å¤–æœ¨å±±": {"id":"LInNQYAbAwQ","label":"å¤–æœ¨å±±","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´": {"id":"91PfFoqvuUk","label":"æ¡ƒåœ’æ©Ÿå ´","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´å—è·‘é“": {"id":"y3_x8el5ZJY","label":"TPE å—è·‘é“","source":"Taoyuan Airport"},
      "æ¡ƒåœ’-æ¡ƒåœ’æ©Ÿå ´åŒ—è·‘é“": {"id":"wWEnxWA7nnY","label":"TPE åŒ—è·‘é“","source":"Taoyuan Airport"},
      "æ¡ƒåœ’-æ°¸å®‰æ¼æ¸¯": {"id":"tD_a03trUvE","label":"æ°¸å®‰æ¼æ¸¯","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ": {"id":"YkIUZjVlhv4","label":"æ‹‰æ‹‰å±±éŠå®¢ä¸­å¿ƒ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è™é ­å±±ç’°ä¿å…¬åœ’": {"id":"tu_gsIkNt-w","label":"è™é ­å±±ç’°ä¿å…¬åœ’","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å°çƒä¾†å¤©ç©ºæ­¥é“": {"id":"neaiCec1kec","label":"å°çƒä¾†å¤©ç©ºæ­¥é“","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±æ€è¦ªäº­": {"id":"3Za9y4z_Lzc","label":"è§’æ¿å±±æ€è¦ªäº­","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°": {"id":"5YDXZ1aiR5Y","label":"ä¸‰é¾œæˆ²æ°´è§€æ™¯å¹³å°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å¤§æºªæ©‹": {"id":"oFJ6gCaBb_Q","label":"å¤§æºªæ©‹","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è™é ­å±±å¥§çˆ¾æ£®æ—å­¸å ‚": {"id":"yQSmajHyMhU","label":"å¥§çˆ¾æ£®æ—å­¸å ‚","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±æ¢…åœ’": {"id":"-xT1bZhWLuU","label":"è§’æ¿å±±æ¢…åœ’","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è§’æ¿å±±ç”Ÿæ…‹æ± ": {"id":"XEbo8NzMTbQ","label":"è§’æ¿å±±ç”Ÿæ…‹æ± ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å¤§æºªè€è¡—": {"id":"XUWjAsajKXg","label":"å¤§æºªè€è¡—","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-çŸ³é–€æ°´åº«": {"id":"GUCaVR88ZFU","label":"çŸ³é–€æ°´åº«","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ…ˆæ¹–æ°´å²¸å»£å ´": {"id":"pSQ0e-ZTZ5g","label":"æ…ˆæ¹–æ°´å²¸å»£å ´","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-é˜¿å§†åªè–‘æ¯å³¶": {"id":"EUOp2LchPQM","label":"è–‘æ¯å³¶","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-ä¸Šå·´é™µ": {"id":"nV-DKquUjFs","label":"ä¸Šå·´é™µ","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-æ¡ƒåœ’åœ‹éš›æ©Ÿå ´å‡±æ‚…é…’åº—": {"id":"68GFgzQxrXs","label":"æ©Ÿå ´å‡±æ‚…","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-å°çƒä¾†å¯°å®‡å¹³å°": {"id":"PJWye36lEj4","label":"å¯°å®‡å¹³å°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "æ¡ƒåœ’-è¨±åæ¸¯æ¿•åœ°": {"id":"44JArbF682k","label":"è¨±åæ¸¯æ¿•åœ°","source":"éŠæ¡ƒåœ’ Taoyuan Travel"},
      "å®œè˜­-å¤–æ¾³æ²™ç˜": {"id":"UgoT-QTbYvo","label":"å®œè˜­å¤–æ¾³","source":"necoast nsa"},
      "å®œè˜­-ç¦éš†æµ·æ°´æµ´å ´": {"id":"AxG-Jssz8fg","label":"å®œè˜­ç¦éš†","source":"necoast nsa"},
      "å®œè˜­-èˆŠéš§é“å—å£": {"id":"f38lFhncLVA","label":"å®œè˜­çŸ³åŸ","source":"necoast nsa"},
      "å®œè˜­-ç„¡å°¾æ¸¯": {"id":"gPeJuFuNcRc","label":"ç„¡å°¾æ¸¯","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "å®œè˜­-çŸ³åŸæ¼æ¸¯": {"id":"ozZVLl0h--A","label":"çŸ³åŸæ¼æ¸¯","source":"GoOceanæµ·æ´‹éŠæ†©é¢¨éšªè³‡è¨Š"},
      "å°æ±-é¯‰é­šå±±": {"id":"BUJJaW0vkJs","label":"å°æ±é¯‰é­šå±±","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-é‡‘å´™å¤§æ©‹": {"id":"9QqBz3kNHis","label":"å°æ±é‡‘å´™å¤§æ©‹","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-é‡‘æ¨½è§€æµª": {"id":"q3KJt-SZc2s","label":"å°æ±é‡‘æ¨½è§€æµª","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å¯Œå±±": {"id":"Rsq95SQ26bY","label":"å°æ±å¯Œå±±","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-æ‰åŸç£": {"id":"VqS_Y8ZCj6M","label":"å°æ±æ‰åŸç£","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å¯Œå²¡æ¼æ¸¯": {"id":"D945F_dauls","label":"å°æ±å¯Œå²¡æ¼æ¸¯","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-è¯æºæ›™å…‰è§€æ™¯å°": {"id":"TY4qQElcUrA","label":"å°æ±è¯æºæ›™å…‰è§€æ™¯å°","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å—æ©«åŸ¡å£": {"id":"LSkq-wHMxQY","label":"å°æ±å—æ©«åŸ¡å£","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-æ± ä¸Šå¤©å ‚è·¯": {"id":"6kUEK3LVrro","label":"å°æ±æ± ä¸Šå¤©å ‚è·¯","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-å¤šè‰¯è»Šç«™": {"id":"UCG1aXVO8H8","label":"å°æ±å¤šè‰¯","source":"Amazing Taitung å°æ±å°±é†¬ç©"},
      "å°æ±-é¹¿é‡é«˜å°": {"id":"rvc1klNIgQc","label":"é¹¿é‡é«˜å°","source":"ervnsa"},
      "èŠ±è“®-çŸ³æ¢¯åª": {"id":"mXnigLvIL0Q","label":"èŠ±è“®çŸ³æ¢¯åª","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-æˆåŠŸä¸‰ä»™å°": {"id":"dQ7Sd6PGLdA","label":"ä¸‰ä»™å°","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-é‡‘æ¨½éŠæ†©å€": {"id":"ZdqHgQwvZOw","label":"é‡‘æ¨½éŠæ†©å€","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶å—å¯®": {"id":"wTHhv7M0vCI","label":"ç¶ å³¶å—å¯®","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-éƒ½æ­·éŠå®¢ä¸­å¿ƒ": {"id":"JhQuR77AR7U","label":"éƒ½æ­·éŠå®¢ä¸­å¿ƒ","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-åŠ è·¯è˜­éŠæ†©å€": {"id":"AKl3F6cAY2Q","label":"åŠ è·¯è˜­éŠæ†©å€","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "èŠ±è“®-å¤§çŸ³é¼»å±±": {"id":"JkoXcXI04Qk","label":"å¤§çŸ³é¼»å±±","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "èŠ±è“®-é•·è™¹æ©‹": {"id":"JnD8Rk3o0BM","label":"é•·è™¹æ©‹","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶å¸†èˆ¹é¼»": {"id":"pLdBc8PvZko","label":"ç¶ å³¶å¸†èˆ¹é¼»","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°æ±-ç¶ å³¶æŸ´å£æµ®æ½›å€": {"id":"a8nJQr5rBGs","label":"ç¶ å³¶æŸ´å£æµ®æ½›å€","source":"æ±éƒ¨æµ·å²¸åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°ä¸­-é«˜ç¾æ¿•åœ°": {"id":"fjhg3gAnMFg","label":"å°ä¸­é«˜ç¾","source":"å¤§ç©å°ä¸­-è‡ºä¸­è§€å…‰æ—…éŠå±€"},
      "å°ä¸­-æœ›é«˜å¯®": {"id":"lhXXhDyjFtI","label":"æœ›é«˜å¯®","source":"å¤§ç©å°ä¸­-è‡ºä¸­è§€å…‰æ—…éŠå±€"},
      "å˜‰ç¾©-å¥®èµ·æ¹–": {"id":"B6eki-0-w0g","label":"å˜‰ç¾©å¥®èµ·æ¹–","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-äºŒå»¶å¹³æ­¥é“": {"id":"j2L_559nCjc","label":"äºŒå»¶å¹³æ­¥é“","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-å¤ªå¹³é›²æ¢¯": {"id":"dY2cRNr5Buw","label":"å¤ªå¹³é›²æ¢¯","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-è§¸å£éŠå®¢ä¸­å¿ƒ": {"id":"8KnqJBf_dow","label":"è§¸å£éŠå®¢ä¸­å¿ƒ","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-æ„›æƒ…å¤§è‰åŸ": {"id":"hMYs60qtkK8","label":"æ„›æƒ…å¤§è‰åŸ","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-ç”ŸåŠ›è¾²å ´": {"id":"agEzlv9n9Eg","label":"ç”ŸåŠ›è¾²å ´","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å˜‰ç¾©-é‡Œä½³è³‡è¨Šç«™": {"id":"zDt8FBPozZQ","label":"é‡Œä½³è³‡è¨Šç«™","source":"é˜¿é‡Œå±±åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å½°åŒ–-ç‹åŠŸæ¼æ¸¯": {"id":"hUG2XK08W5Q","label":"å½°åŒ–ç‹åŠŸ","source":"æ„›ç©å½°åŒ– Changhua Travels"},
      "é«˜é›„-æ——æ´¥æµ·æ°´æµ´å ´": {"id":"ka7FV0sCvxQ","label":"é«˜é›„æ——æ´¥","source":"é«˜é›„æ—…éŠç¶²"},
      "å±æ±-å¢¾ä¸å—ç£": {"id":"jUnFuJSj0OU","label":"å¢¾ä¸å—ç£","source":"æˆ‘æ„›å¢¾ä¸æ—…éŠç¥¨åˆ¸ä¸­å¿ƒ"},
      "å°å—-ä¸ƒè‚¡è³é³¥å°": {"id":"5KJe2gCTngA","label":"å°å—ä¸ƒè‚¡","source":"å°æ±Ÿåœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å°å—-åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€": {"id":"FES0gWTFUHQ","label":"åŒ—æ±•å°¾æ°´é³¥ä¿è­·å€","source":"å°æ±Ÿåœ‹å®¶å…¬åœ’ç®¡ç†è™•"},
      "å°å—-æ›¾æ–‡æ°´åº«": {"id":"EH4V8IwFIp4","label":"æ›¾æ–‡æ°´åº«","source":"è¥¿æ‹‰é›…åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "å°å—-ç«å±±ç¢§é›²å¯º": {"id":"zkX6X9p-6iA","label":"ç«å±±ç¢§é›²å¯º","source":"è¥¿æ‹‰é›…åœ‹å®¶é¢¨æ™¯å€ç®¡ç†è™•"},
      "é«˜é›„-å£½å±±è§€æ™¯å°": {"id":"C03Itx8iSC0","label":"å£½å±±è§€æ™¯","source":"é«˜é›„æ—…éŠç¶²"},
      "é‡‘é–€-éº’éºŸå±±æ£®æ—å…¬åœ’": {"id":"M4EJtf_iP8s","label":"é‡‘é–€éº’éºŸå±±å…¬åœ’","source":"æ¨‚éŠé‡‘é–€"},
      "é‡‘é–€-134é«˜åœ°": {"id":"-srNHTE-Nf0","label":"é‡‘é–€134é«˜åœ°","source":"æ¨‚éŠé‡‘é–€"},
      "é‡‘é–€-å»ºåŠŸå¶¼": {"id":"uh_yNAE01w8","label":"é‡‘é–€å»ºåŠŸå¶¼","source":"æ¨‚éŠé‡‘é–€"}
    };

    const REGION_GROUPS = {
      "åŒ—éƒ¨": ["å°åŒ—å¸‚","æ–°åŒ—å¸‚","åŸºéš†å¸‚","æ¡ƒåœ’å¸‚","å®œè˜­ç¸£","æ–°ç«¹å¸‚","æ–°ç«¹ç¸£"],
      "ä¸­éƒ¨": ["å°ä¸­å¸‚","å—æŠ•ç¸£","å½°åŒ–ç¸£","è‹—æ —ç¸£","é›²æ—ç¸£","å˜‰ç¾©å¸‚","å˜‰ç¾©ç¸£"],
      "å—éƒ¨": ["å°å—å¸‚","é«˜é›„å¸‚","å±æ±ç¸£"],
      "æ±éƒ¨": ["èŠ±è“®ç¸£","å°æ±ç¸£"],
      "å¤–å³¶": ["é‡‘é–€ç¸£","æ¾æ¹–ç¸£","é€£æ±Ÿç¸£"]
    };

    const CITY_ALIAS_TO_BASE = {
      "å°åŒ—å¸‚":"å°åŒ—","æ–°åŒ—å¸‚":"æ–°åŒ—","åŸºéš†å¸‚":"åŸºéš†","æ¡ƒåœ’å¸‚":"æ¡ƒåœ’","å®œè˜­ç¸£":"å®œè˜­",
      "æ–°ç«¹å¸‚":"æ–°ç«¹å¸‚","æ–°ç«¹ç¸£":"æ–°ç«¹ç¸£","å°ä¸­å¸‚":"å°ä¸­","å—æŠ•ç¸£":"å—æŠ•","å½°åŒ–ç¸£":"å½°åŒ–",
      "è‹—æ —ç¸£":"è‹—æ —","é›²æ—ç¸£":"é›²æ—","å˜‰ç¾©å¸‚":"å˜‰ç¾©","å˜‰ç¾©ç¸£":"å˜‰ç¾©",
      "å°å—å¸‚":"å°å—","é«˜é›„å¸‚":"é«˜é›„","å±æ±ç¸£":"å±æ±","èŠ±è“®ç¸£":"èŠ±è“®","å°æ±ç¸£":"å°æ±",
      "é‡‘é–€ç¸£":"é‡‘é–€","æ¾æ¹–ç¸£":"æ¾æ¹–","é€£æ±Ÿç¸£":"é¦¬ç¥–"
    };

    // åˆå§‹å››æ ¼
    let INITIAL_CAMS_KEYS = ["å°åŒ—-è±¡å±±çœ‹101","æ¡ƒåœ’-åœ‹éš›æ©Ÿå ´","æ–°åŒ—-æ¼äººç¢¼é ­","å°æ±-å¤šè‰¯è»Šç«™"];

    // ä¾ç¸£å¸‚åˆ†çµ„
    const GROUPED_STREAMS = {};
    for (const key in ALL_STREAMS){
      const baseCity = key.split('-')[0] || 'å…¶ä»–';
      if (!GROUPED_STREAMS[baseCity]) GROUPED_STREAMS[baseCity] = [];
      GROUPED_STREAMS[baseCity].push({
        key, id: ALL_STREAMS[key].id, label: ALL_STREAMS[key].label, source: ALL_STREAMS[key].source
      });
    }
    for (const region in REGION_GROUPS){
      REGION_GROUPS[region].forEach(displayCity=>{
        const baseCity = CITY_ALIAS_TO_BASE[displayCity] || displayCity;
        if (!GROUPED_STREAMS[baseCity]) GROUPED_STREAMS[baseCity] = [];
      });
    }

    // å››æ ¼æ’­æ”¾å™¨èˆ‡å…¨å±€ç‹€æ…‹
    let players = []; 
    let isApiReady = false; 
    let globalMuted = true;
    const streamIds = {}; for (const key in ALL_STREAMS) streamIds[key] = ALL_STREAMS[key].id;
    const labels = [document.getElementById('label0'),document.getElementById('label1'),document.getElementById('label2'),document.getElementById('label3')];
    const camSelectButtons = [document.getElementById('select-cam-0'),document.getElementById('select-cam-1'),document.getElementById('select-cam-2'),document.getElementById('select-cam-3')];
    let currentCamKeys = [...INITIAL_CAMS_KEYS]; 
    let currentIndex = 0;

    // ----------------------------------------------------------------------
    // æ–°å¢ï¼šéŸ³æ¨‚æ’­æ”¾å™¨å°ˆå±¬ç‹€æ…‹
    // ----------------------------------------------------------------------
    let musicPlayer = null; 
    let musicQueue = []; // å„²å­˜ { id: 'youtube_id', title: 'Song Title' }
    let currentSongIndex = -1; // -1 è¡¨ç¤ºæ²’æœ‰æ­Œæ›²åœ¨æ’­æ”¾
    let playbackMode = 'listLoop'; // 'listLoop', 'shuffle', 'repeatOne'

    // YouTube IFrame API åˆå§‹åŒ–
    window.onYouTubeIframeAPIReady = function(){
      isApiReady = true;
      for (let i=0;i<4;i++){
        const streamKey = INITIAL_CAMS_KEYS[i] || Object.keys(ALL_STREAMS)[i];
        const validKey = ALL_STREAMS[streamKey] ? streamKey : (Object.keys(ALL_STREAMS)[i] || Object.keys(ALL_STREAMS)[0]);
        createPlayer(i, validKey);
      }
      applyGlobalMute();
      updateMuteButtonLabel();
      toggleMusicControlsVisibility(); // ç¢ºä¿ä¸€é–‹å§‹éŸ³æ¨‚æ§åˆ¶æ˜¯éš±è—çš„
    }

    // ç›´æ’­æ’­æ”¾å™¨ç›¸é—œå‡½å¼ (æ²¿ç”¨)
    function createPlayer(index, streamKey){
      const videoId = streamIds[streamKey]; if (!videoId) return;
      if (players[index] && players[index].destroy) players[index].destroy();
      currentCamKeys[index]=streamKey;

      players[index]=new YT.Player('player'+index,{
        videoId,
        playerVars:{ autoplay:1, mute:1, controls:0, rel:0, modestbranding:1, fs:0, iv_load_policy:3 },
        events:{ onReady:onPlayerReady, onError:onPlayerError, onStateChange:onPlayerStateChange }
      });

      const lbl = ALL_STREAMS[streamKey].label || streamKey;
      const src = ALL_STREAMS[streamKey].source || '';
      labels[index].innerHTML = `${lbl}<span class="source-on-screen">ä¾†æº: ${src}</span>`;
    }

    function onPlayerReady(e){ try{ e.target.playVideo(); }catch(_){}
      try{ globalMuted ? e.target.mute() : e.target.unMute(); }catch(_){}
    }
    function onPlayerError(e){
      const idx = players.findIndex(p=>p===e.target);
      const failingKey = currentCamKeys[idx]; const code = e.data;
      labels[idx].innerHTML = `${ALL_STREAMS[failingKey]?.label || failingKey} [éŒ¯èª¤ ${code}]<span class="source-on-screen">å˜—è©¦è‡ªå‹•åˆ‡æ›ä¸­...</span>`;
      if ([5,100,101,150].includes(code)){
        const keys = Object.keys(ALL_STREAMS);
        const next = keys[(keys.indexOf(failingKey)+1)%keys.length];
        if (next) createPlayer(idx,next);
      }
    }
    function refreshPlayer(p){ if (!p) return; try{ const id = p.getVideoData().video_id; if (id) p.loadVideoById({videoId:id,startSeconds:0}); }catch(_){}
    }
    function onPlayerStateChange(e){
      if (e.data===YT.PlayerState.ENDED) refreshPlayer(e.target);
      if (e.data===YT.PlayerState.PAUSED || e.data===YT.PlayerState.BUFFERING){ try{ e.target.playVideo(); }catch(_){} }
    }

    function selectCam(index){
      currentIndex=index;
      camSelectButtons.forEach(b=>b.classList.remove('active'));
      camSelectButtons[index].classList.add('active');
      updateMuteButtonLabel();
    }

    function setStream(streamKey){
      const id = streamIds[streamKey]; if (!id) return alert("ä¾†æºä¸å­˜åœ¨ï¼š" + streamKey);
      if (!isApiReady || !players[currentIndex]) return;
      players[currentIndex].loadVideoById({ videoId:id, startSeconds:0 });
      currentCamKeys[currentIndex]=streamKey;
      const lbl = ALL_STREAMS[streamKey].label || streamKey; const src = ALL_STREAMS[streamKey].source || '';
      labels[currentIndex].innerHTML = `${lbl}<span class="source-on-screen">ä¾†æº: ${src}</span>`;
      try{ globalMuted ? players[currentIndex].mute() : players[currentIndex].unMute(); }catch(_){}
    }
    
    // ----------------------------------------------------------------------
    // æ–°å¢ï¼šéŸ³æ¨‚æ’­æ”¾å™¨æ§åˆ¶é‚è¼¯
    // ----------------------------------------------------------------------

    function createMusicPlayerInstance(videoId, startSeconds=0) {
        if (musicPlayer && musicPlayer.destroy) {
            musicPlayer.destroy();
            musicPlayer = null;
        }
        
        musicPlayer = new YT.Player('player_music', {
            videoId: videoId,
            playerVars: { autoplay: 1, mute: 0, controls: 0, rel: 0, modestbranding: 1, fs: 0, iv_load_policy: 3, start: startSeconds },
            events: {
                onReady: (e) => {
                    e.target.playVideo();
                    e.target.unMute();
                    updateMusicControlsUI();
                    toggleMusicControlsVisibility(); 
                },
                onError: (e) => {
                    console.error(`æ­Œæ›²é»æ’­å¤±æ•— (éŒ¯èª¤ç¢¼: ${e.data})ã€‚å°‡è·³éæ­¤æ­Œæ›²ã€‚`);
                    musicPlayer = null;
                    playNextSong(true); 
                },
                onStateChange: (e) => {
                    if (e.data === YT.PlayerState.ENDED) {
                        playNextSong(true); 
                    } else if (e.data === YT.PlayerState.PAUSED || e.data === YT.PlayerState.PLAYING) {
                        updateMusicControlsUI();
                    }
                }
            }
        });
    }

    function playSongFromQueue(index) {
        if (musicQueue.length === 0 || index < 0 || index >= musicQueue.length) {
            stopSong();
            return;
        }
        currentSongIndex = index;
        const song = musicQueue[currentSongIndex];
        createMusicPlayerInstance(song.id);
    }

    function playNextSong(autoPlay = false) {
        if (musicQueue.length === 0) {
            stopSong();
            return;
        }

        let nextIndex = currentSongIndex;

        if (playbackMode === 'repeatOne' && autoPlay) {
            playSongFromQueue(currentSongIndex); 
            return;
        } else if (playbackMode === 'shuffle' && autoPlay) {
            nextIndex = Math.floor(Math.random() * musicQueue.length);
        } else {
            nextIndex = (currentSongIndex + 1);
            
            if (nextIndex >= musicQueue.length) {
                 if (playbackMode === 'listLoop' && musicQueue.length > 0) {
                    nextIndex = 0; 
                 } else {
                    stopSong(); // åˆ—è¡¨çµæŸï¼Œåœæ­¢æ’­æ”¾
                    return;
                 }
            }
        }
        
        playSongFromQueue(nextIndex);
    }

    function skipToPreviousSong() {
        if (musicQueue.length === 0 || currentSongIndex === -1) return;
        
        if (musicPlayer && musicPlayer.getCurrentTime() > 3) {
            musicPlayer.seekTo(0, true);
            return;
        }

        let prevIndex = currentSongIndex - 1;
        if (prevIndex < 0) {
            prevIndex = musicQueue.length - 1; 
        }
        
        playSongFromQueue(prevIndex);
    }
    
    function skipToNextSong() {
        playNextSong(false); // æ‰‹å‹•è·³é
    }

    function playPauseSong() {
        if (!musicPlayer) return;
        const state = musicPlayer.getPlayerState();
        if (state === YT.PlayerState.PLAYING) {
            musicPlayer.pauseVideo();
        } else if (state === YT.PlayerState.PAUSED || state === YT.PlayerState.BUFFERING) {
            musicPlayer.playVideo();
        }
        updateMusicControlsUI();
    }

    function stopSong() {
        if (musicPlayer && musicPlayer.destroy) {
            musicPlayer.destroy();
        }
        musicPlayer = null;
        currentSongIndex = -1;
        musicQueue = []; // æ¸…ç©ºåˆ—è¡¨
        updateMusicControlsUI();
        toggleMusicControlsVisibility(); // éš±è—æ§åˆ¶
    }
    
    // ----------------------------------------------------------------------
    // æ–°å¢ï¼šæ¨¡å¼è¨­å®šèˆ‡ UI é¡¯ç¤º
    // ----------------------------------------------------------------------

    function getYouTubeID(urlOrID) {
        if (!urlOrID) return null;
        urlOrID = urlOrID.trim();
        const match = urlOrID.match(/(?:youtu\.be\/|v=|embed\/|watch\?v=)([^&?]*)/);
        if (match && match[1]) {
            return match[1];
        }
        if (urlOrID.length === 11 && !urlOrID.includes('/')) {
            return urlOrID;
        }
        return null;
    }

    // æ§åˆ¶éŸ³æ¨‚æ§åˆ¶å€å¡Šçš„é¡¯ç¤º/éš±è—
    function toggleMusicControlsVisibility() {
        const container = document.getElementById('musicControlsContainer');
        if (musicQueue.length > 0) {
            container.style.display = 'flex';
        } else {
            container.style.display = 'none';
        }
    }

    // åƒ…æ›´æ–°åœ–ç¤º
    function updateMusicControlsUI() {
        const playPauseBtn = document.getElementById('playPauseBtn');
        const modeBtn = document.getElementById('modeBtn');
        
        if (currentSongIndex !== -1 && musicQueue.length > 0) {
            // æ›´æ–°æ’­æ”¾/æš«åœæŒ‰éˆ•åœ–ç¤º
            if (musicPlayer && musicPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
                playPauseBtn.innerHTML = 'â¸ï¸';
            } else {
                playPauseBtn.innerHTML = 'â–¶ï¸';
            }
        } else {
            playPauseBtn.innerHTML = 'â–¶ï¸';
        }

        // æ›´æ–°æ¨¡å¼æŒ‰éˆ•åœ–ç¤ºèˆ‡æç¤ºæ–‡å­—
        switch (playbackMode) {
            case 'listLoop':
                modeBtn.innerHTML = 'ğŸ”„';
                modeBtn.title = 'æ¨¡å¼è¨­å®šï¼šåˆ—è¡¨å¾ªç’°';
                break;
            case 'shuffle':
                modeBtn.innerHTML = 'ğŸ”€';
                modeBtn.title = 'æ¨¡å¼è¨­å®šï¼šéš¨æ©Ÿæ’­æ”¾';
                break;
            case 'repeatOne':
                modeBtn.innerHTML = 'ğŸ”';
                modeBtn.title = 'æ¨¡å¼è¨­å®šï¼šå–®æ›²å¾ªç’°';
                break;
        }
    }

    // å½ˆå‡ºè¦–çª—ç›¸é—œå‡½å¼
    function openMusicSettingsModal() {
        document.getElementById('musicSettingsModal').style.display = 'flex';
    }

    function closeMusicSettingsModal() {
        document.getElementById('musicSettingsModal').style.display = 'none';
    }

    function setPlaybackMode(newMode) {
        playbackMode = newMode;
        closeMusicSettingsModal();
        updateMusicControlsUI();
    }
    
    // ä¾è¦æ±‚æ–°å¢ï¼šåœæ­¢æ­Œæ›²ä¸¦é—œé–‰å½ˆçª—
    function stopAndCloseModal() {
        stopSong();
        closeMusicSettingsModal();
    }

    // é»æ­Œå‡½å¼ï¼šåŠ å…¥ä½‡åˆ—ä¸¦æ’­æ”¾
    function requestSong(){
        if (!isApiReady) {
            alert("æ’­æ”¾å™¨ API å°šæœªæº–å‚™å¥½ï¼Œè«‹ç¨å€™ã€‚");
            return;
        }
        
        const input = prompt("è«‹è¼¸å…¥ YouTube å½±ç‰‡ç¶²å€æˆ– IDï¼š(æ­Œæ›²å°‡åŠ å…¥æ’­æ”¾åˆ—è¡¨)", "");

        if (input === null || input.trim() === "") {
            return; 
        }
        
        const videoId = getYouTubeID(input);

        if (!videoId) {
            alert("ç„¡æ•ˆçš„ YouTube ç¶²å€æˆ– IDã€‚è«‹ç¢ºä¿æ ¼å¼æ­£ç¢ºã€‚");
            return;
        }
        
        // å½±ç‰‡æ¨™é¡Œä¸å†é¡¯ç¤ºï¼Œåªéœ€è¨˜éŒ„ ID
        const newSong = { id: videoId, title: "ç”¨æˆ¶é»æ’­æ­Œæ›²" }; 
        musicQueue.push(newSong);

        // å¦‚æœç›®å‰æ²’æœ‰æ­Œæ›²æ’­æ”¾ï¼Œå‰‡ç«‹å³æ’­æ”¾æ–°åŠ å…¥çš„æ­Œæ›²
        if (currentSongIndex === -1 || !musicPlayer) {
            playSongFromQueue(musicQueue.length - 1);
        } else {
            // å¦å‰‡ï¼Œåªéœ€æ›´æ–° UI é¡¯ç¤º (åœ–ç¤º)
            updateMusicControlsUI(); 
            toggleMusicControlsVisibility(); // ç¢ºä¿åŠ å…¥ä½‡åˆ—æ™‚é¡¯ç¤ºæ§åˆ¶
        }
    }

    // æ ¸å¿ƒæ§åˆ¶åŠŸèƒ½ (æ²¿ç”¨)
    function toggleLabels(){
      document.body.classList.toggle('hide-labels');
      document.getElementById('labelsToggleBtn').innerText =
        document.body.classList.contains('hide-labels') ? "æ¨™ç±¤é¡¯ç¤º" : "æ¨™ç±¤éš±è—";
    }

    function toggleFullscreen(){
      const btn = document.getElementById('fullscreenBtn');
      if (!document.fullscreenElement){
        document.documentElement.requestFullscreen().then(()=>{
          document.body.classList.add('fullscreen-active');
          btn.innerText = "é€€å‡ºå…¨è¢å¹•";
        }).catch(err=>alert("ç„¡æ³•é€²å…¥å…¨è¢å¹•: " + err.message));
      } else {
        document.exitFullscreen();
      }
    }
    document.addEventListener('fullscreenchange', ()=>{
      const btn = document.getElementById('fullscreenBtn');
      if (!document.fullscreenElement){
        document.body.classList.remove('fullscreen-active');
        btn.innerText = "å…¨è¢å¹•";
      }
    });

    function toggleMute(){ if (!isApiReady) return; globalMuted=!globalMuted; applyGlobalMute(); updateMuteButtonLabel(); }
    function applyGlobalMute(){ players.forEach(p=>{ if (!p) return; try{ globalMuted ? p.mute() : p.unMute(); }catch(_){} }); }
    function updateMuteButtonLabel(){ document.getElementById('muteBtn').innerText = globalMuted ? "å–æ¶ˆéœéŸ³" : "éœéŸ³"; }

    // åˆå§‹åŒ– UI åˆ—è¡¨ (æ²¿ç”¨)
    document.addEventListener('DOMContentLoaded', ()=> renderRegionButtons());
    function renderRegionButtons(){
      const c = document.getElementById('regionButtons'); c.innerHTML='';
      for (const region in REGION_GROUPS){
        const regionLabel = document.createElement('span');
        regionLabel.className = 'region-label';
        regionLabel.textContent = region + 'ï¼š';
        c.appendChild(regionLabel);
        REGION_GROUPS[region].forEach(displayCity=>{
          const btn = document.createElement('button');
          btn.className = 'city-btn';
          btn.innerText = displayCity;
          btn.setAttribute('onclick', `renderLocationButtons('${displayCity}')`);
          c.appendChild(btn);
        });
      }
      c.scrollLeft = 0;
    }

    function renderLocationButtons(displayCity){
      const baseCity = CITY_ALIAS_TO_BASE[displayCity] || displayCity;
      const c = document.getElementById('regionButtons'); c.innerHTML='';
      const back = document.createElement('button');
      back.innerText='â† è¿”å›'; back.className='city-btn'; back.setAttribute('onclick','renderRegionButtons()'); c.appendChild(back);

      const list = GROUPED_STREAMS[baseCity] || [];
      if (list.length===0){
        const empty = document.createElement('span');
        empty.innerText='ï¼ˆç›®å‰æ²’æœ‰æ™¯é»ï¼‰';
        empty.style.color='#bbb'; empty.style.marginLeft='10px';
        c.appendChild(empty);
      }else{
        list.forEach(stream=>{
          const b = document.createElement('button'); b.className='city-btn';
          b.innerText=stream.label; b.setAttribute('onclick',`setStream('${stream.key}')`);
          c.appendChild(b);
        });
      }
      c.scrollLeft = 0;
    }

    // é è¨­é¸æ“‡ç¬¬ä¸€æ ¼
    selectCam(0);
  </script>
</body>
</html>
